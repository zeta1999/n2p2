<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>n2p2 - A neural network potential package: nnp::Mode Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">n2p2 - A neural network potential package
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a00832.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="a00829.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nnp::Mode Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Base class for all NNP applications.  
 <a href="a00832.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="a00083_source.html">Mode.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for nnp::Mode:</div>
<div class="dyncontent">
<div class="center"><img src="a00831.png" border="0" usemap="#nnp_1_1Mode_inherit__map" alt="Inheritance graph"/></div>
<map name="nnp_1_1Mode_inherit__map" id="nnp_1_1Mode_inherit__map">
<area shape="rect" id="node2" href="a00932.html" title="Collect and process large data sets. " alt="" coords="5,80,111,107"/>
<area shape="rect" id="node3" href="a00928.html" title="nnp::InterfaceLammps" alt="" coords="135,80,303,107"/>
<area shape="rect" id="node4" href="a00848.html" title="nnp::Prediction" alt="" coords="328,80,447,107"/>
<area shape="rect" id="node5" href="a00856.html" title="nnp::SetupAnalysis" alt="" coords="471,80,618,107"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for nnp::Mode:</div>
<div class="dyncontent">
<div class="center"><img src="a00830.png" border="0" usemap="#nnp_1_1Mode_coll__map" alt="Collaboration graph"/></div>
<map name="nnp_1_1Mode_coll__map" id="nnp_1_1Mode_coll__map">
<area shape="rect" id="node10" href="a00828.html" title="Logging class for library output. " alt="" coords="278,439,355,465"/>
<area shape="rect" id="node8" href="a00824.html" title="Contains element map. " alt="" coords="249,540,384,567"/>
<area shape="rect" id="node11" href="a00852.html" title="Reads and analyzes settings file and stores parameters. " alt="" coords="263,641,370,668"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a098246baedeee64fa0ed3b53547cf55f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a098246baedeee64fa0ed3b53547cf55f">Mode</a> ()</td></tr>
<tr class="separator:a098246baedeee64fa0ed3b53547cf55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a68b9d8750ddc0b440b1828ecf9f17"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a19a68b9d8750ddc0b440b1828ecf9f17">initialize</a> ()</td></tr>
<tr class="memdesc:a19a68b9d8750ddc0b440b1828ecf9f17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write welcome message with version information.  <a href="#a19a68b9d8750ddc0b440b1828ecf9f17">More...</a><br /></td></tr>
<tr class="separator:a19a68b9d8750ddc0b440b1828ecf9f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8ca16789e7794309cf9931e58eb882b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ae8ca16789e7794309cf9931e58eb882b">loadSettingsFile</a> (std::string const &amp;fileName=&quot;input.nn&quot;)</td></tr>
<tr class="memdesc:ae8ca16789e7794309cf9931e58eb882b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open settings file and load all keywords into memory.  <a href="#ae8ca16789e7794309cf9931e58eb882b">More...</a><br /></td></tr>
<tr class="separator:ae8ca16789e7794309cf9931e58eb882b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adffbed0cbae8bc9c4f4c4556ff113b5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric</a> ()</td></tr>
<tr class="memdesc:adffbed0cbae8bc9c4f4c4556ff113b5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Combine multiple setup routines and provide a basic NNP setup.  <a href="#adffbed0cbae8bc9c4f4c4556ff113b5f">More...</a><br /></td></tr>
<tr class="separator:adffbed0cbae8bc9c4f4c4556ff113b5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa837413e8d998f165f0b8527de636cb5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization</a> ()</td></tr>
<tr class="memdesc:aa837413e8d998f165f0b8527de636cb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up normalization.  <a href="#aa837413e8d998f165f0b8527de636cb5">More...</a><br /></td></tr>
<tr class="separator:aa837413e8d998f165f0b8527de636cb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a259303c95ae2f64f2b192de1b2df51f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap</a> ()</td></tr>
<tr class="memdesc:a259303c95ae2f64f2b192de1b2df51f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up the element map.  <a href="#a259303c95ae2f64f2b192de1b2df51f5">More...</a><br /></td></tr>
<tr class="separator:a259303c95ae2f64f2b192de1b2df51f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4e43a8f905900eb4ea153d529053ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements</a> ()</td></tr>
<tr class="memdesc:afc4e43a8f905900eb4ea153d529053ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up all <a class="el" href="a00820.html" title="Contains element-specific data. ">Element</a> instances.  <a href="#afc4e43a8f905900eb4ea153d529053ec">More...</a><br /></td></tr>
<tr class="separator:afc4e43a8f905900eb4ea153d529053ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae72c03926dc7ea9b8f43770fb5861ccf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff</a> ()</td></tr>
<tr class="memdesc:ae72c03926dc7ea9b8f43770fb5861ccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up cutoff function for all symmetry functions.  <a href="#ae72c03926dc7ea9b8f43770fb5861ccf">More...</a><br /></td></tr>
<tr class="separator:ae72c03926dc7ea9b8f43770fb5861ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0080b25ea49cdd6ce085162751a379b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions</a> ()</td></tr>
<tr class="memdesc:ad0080b25ea49cdd6ce085162751a379b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up all symmetry functions.  <a href="#ad0080b25ea49cdd6ce085162751a379b">More...</a><br /></td></tr>
<tr class="separator:ad0080b25ea49cdd6ce085162751a379b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a672cac54995b226d8e69bb8be2669d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a9a672cac54995b226d8e69bb8be2669d">setupSymmetryFunctionScalingNone</a> ()</td></tr>
<tr class="memdesc:a9a672cac54995b226d8e69bb8be2669d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up "empy" symmetry function scaling.  <a href="#a9a672cac54995b226d8e69bb8be2669d">More...</a><br /></td></tr>
<tr class="separator:a9a672cac54995b226d8e69bb8be2669d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa26222b7b9dc3fd141f6e775690b5d2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling</a> (std::string const &amp;fileName=&quot;scaling.data&quot;)</td></tr>
<tr class="memdesc:aa26222b7b9dc3fd141f6e775690b5d2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function scaling from file.  <a href="#aa26222b7b9dc3fd141f6e775690b5d2b">More...</a><br /></td></tr>
<tr class="separator:aa26222b7b9dc3fd141f6e775690b5d2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0184f87845a572cf4c3db0958a97d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups</a> ()</td></tr>
<tr class="memdesc:a6f0184f87845a572cf4c3db0958a97d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function groups.  <a href="#a6f0184f87845a572cf4c3db0958a97d9">More...</a><br /></td></tr>
<tr class="separator:a6f0184f87845a572cf4c3db0958a97d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1d1548ef2d6a9bbfdc519b76b904700"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory</a> (bool verbose=false)</td></tr>
<tr class="memdesc:af1d1548ef2d6a9bbfdc519b76b904700"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract required memory dimensions for symmetry function derivatives.  <a href="#af1d1548ef2d6a9bbfdc519b76b904700">More...</a><br /></td></tr>
<tr class="separator:af1d1548ef2d6a9bbfdc519b76b904700"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b348e9b5e2ef89cb30c760bdb55153"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ae4b348e9b5e2ef89cb30c760bdb55153">setupSymmetryFunctionStatistics</a> (bool collectStatistics, bool collectExtrapolationWarnings, bool writeExtrapolationWarnings, bool stopOnExtrapolationWarnings)</td></tr>
<tr class="memdesc:ae4b348e9b5e2ef89cb30c760bdb55153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up symmetry function statistics collection.  <a href="#ae4b348e9b5e2ef89cb30c760bdb55153">More...</a><br /></td></tr>
<tr class="separator:ae4b348e9b5e2ef89cb30c760bdb55153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3488a7fb2b0ccf17a9b2af514590f57c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork</a> ()</td></tr>
<tr class="memdesc:a3488a7fb2b0ccf17a9b2af514590f57c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up neural networks for all elements.  <a href="#a3488a7fb2b0ccf17a9b2af514590f57c">More...</a><br /></td></tr>
<tr class="separator:a3488a7fb2b0ccf17a9b2af514590f57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a091fea0011ed8260c93db7c38c3d1e82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a091fea0011ed8260c93db7c38c3d1e82">setupNeuralNetworkWeights</a> (std::string const &amp;fileNameFormat=&quot;weights.%03zu.data&quot;)</td></tr>
<tr class="memdesc:a091fea0011ed8260c93db7c38c3d1e82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up neural network weights from files.  <a href="#a091fea0011ed8260c93db7c38c3d1e82">More...</a><br /></td></tr>
<tr class="separator:a091fea0011ed8260c93db7c38c3d1e82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add11e3c30eb86aba38d8239d1e5d8736"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure, bool const derivatives)</td></tr>
<tr class="memdesc:add11e3c30eb86aba38d8239d1e5d8736"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate all symmetry functions for all atoms in given structure.  <a href="#add11e3c30eb86aba38d8239d1e5d8736">More...</a><br /></td></tr>
<tr class="separator:add11e3c30eb86aba38d8239d1e5d8736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aec6fb4708b93b93a9cfa0e8045f955"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure, bool const derivatives)</td></tr>
<tr class="memdesc:a8aec6fb4708b93b93a9cfa0e8045f955"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate all symmetry function groups for all atoms in given structure.  <a href="#a8aec6fb4708b93b93a9cfa0e8045f955">More...</a><br /></td></tr>
<tr class="separator:a8aec6fb4708b93b93a9cfa0e8045f955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93dc4a306a3caf233268dad71efd565f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a93dc4a306a3caf233268dad71efd565f">calculateAtomicNeuralNetworks</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure, bool const derivatives) const</td></tr>
<tr class="memdesc:a93dc4a306a3caf233268dad71efd565f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate atomic neural networks for all atoms in given structure.  <a href="#a93dc4a306a3caf233268dad71efd565f">More...</a><br /></td></tr>
<tr class="separator:a93dc4a306a3caf233268dad71efd565f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88fb8800851f3d440fcf393cbc073308"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a88fb8800851f3d440fcf393cbc073308">calculateEnergy</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:a88fb8800851f3d440fcf393cbc073308"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate potential energy for a given structure.  <a href="#a88fb8800851f3d440fcf393cbc073308">More...</a><br /></td></tr>
<tr class="separator:a88fb8800851f3d440fcf393cbc073308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2fddd6f29bb63ef67b9619544d81ab1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:ae2fddd6f29bb63ef67b9619544d81ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate forces for all atoms in given structure.  <a href="#ae2fddd6f29bb63ef67b9619544d81ab1">More...</a><br /></td></tr>
<tr class="separator:ae2fddd6f29bb63ef67b9619544d81ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ba3ecbce972ff28d7a17bdade38674"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a17ba3ecbce972ff28d7a17bdade38674">addEnergyOffset</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure, bool ref=true)</td></tr>
<tr class="memdesc:a17ba3ecbce972ff28d7a17bdade38674"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add atomic energy offsets to reference energy.  <a href="#a17ba3ecbce972ff28d7a17bdade38674">More...</a><br /></td></tr>
<tr class="separator:a17ba3ecbce972ff28d7a17bdade38674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ddf0701dbcd60868955ca556892bc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aa8ddf0701dbcd60868955ca556892bc5">removeEnergyOffset</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure, bool ref=true)</td></tr>
<tr class="memdesc:aa8ddf0701dbcd60868955ca556892bc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove atomic energy offsets from reference energy.  <a href="#aa8ddf0701dbcd60868955ca556892bc5">More...</a><br /></td></tr>
<tr class="separator:aa8ddf0701dbcd60868955ca556892bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af05a24414c9b595a8ccb95b05b5030de"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#af05a24414c9b595a8ccb95b05b5030de">getEnergyOffset</a> (<a class="el" href="a00864.html">Structure</a> const &amp;structure) const</td></tr>
<tr class="memdesc:af05a24414c9b595a8ccb95b05b5030de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get atomic energy offset for given structure.  <a href="#af05a24414c9b595a8ccb95b05b5030de">More...</a><br /></td></tr>
<tr class="separator:af05a24414c9b595a8ccb95b05b5030de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab86800b032be86f1321d3f6683c75b01"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ab86800b032be86f1321d3f6683c75b01">getEnergyWithOffset</a> (<a class="el" href="a00864.html">Structure</a> const &amp;structure, bool ref=true) const</td></tr>
<tr class="memdesc:ab86800b032be86f1321d3f6683c75b01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add atomic energy offsets and return energy.  <a href="#ab86800b032be86f1321d3f6683c75b01">More...</a><br /></td></tr>
<tr class="separator:ab86800b032be86f1321d3f6683c75b01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad914604c902d947d44c32b4f760e1da3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ad914604c902d947d44c32b4f760e1da3">normalizedEnergy</a> (double energy) const</td></tr>
<tr class="memdesc:ad914604c902d947d44c32b4f760e1da3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply normalization to given energy.  <a href="#ad914604c902d947d44c32b4f760e1da3">More...</a><br /></td></tr>
<tr class="separator:ad914604c902d947d44c32b4f760e1da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5d51e9328414aea8106d85bde5a1729"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#af5d51e9328414aea8106d85bde5a1729">normalizedEnergy</a> (<a class="el" href="a00864.html">Structure</a> const &amp;structure, bool ref=true) const</td></tr>
<tr class="memdesc:af5d51e9328414aea8106d85bde5a1729"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply normalization to given energy of structure.  <a href="#af5d51e9328414aea8106d85bde5a1729">More...</a><br /></td></tr>
<tr class="separator:af5d51e9328414aea8106d85bde5a1729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42377e19341fd2666856b9177b6588dd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a42377e19341fd2666856b9177b6588dd">normalizedForce</a> (double force) const</td></tr>
<tr class="memdesc:a42377e19341fd2666856b9177b6588dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply normalization to given force.  <a href="#a42377e19341fd2666856b9177b6588dd">More...</a><br /></td></tr>
<tr class="separator:a42377e19341fd2666856b9177b6588dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fcf4fe91e191c78e4bc2a999225b8b1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a9fcf4fe91e191c78e4bc2a999225b8b1">physicalEnergy</a> (double energy) const</td></tr>
<tr class="memdesc:a9fcf4fe91e191c78e4bc2a999225b8b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo normalization for a given energy.  <a href="#a9fcf4fe91e191c78e4bc2a999225b8b1">More...</a><br /></td></tr>
<tr class="separator:a9fcf4fe91e191c78e4bc2a999225b8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d558483ab82d340ee587febcfddd8f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a02d558483ab82d340ee587febcfddd8f">physicalEnergy</a> (<a class="el" href="a00864.html">Structure</a> const &amp;structure, bool ref=true) const</td></tr>
<tr class="memdesc:a02d558483ab82d340ee587febcfddd8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo normalization for a given energy of structure.  <a href="#a02d558483ab82d340ee587febcfddd8f">More...</a><br /></td></tr>
<tr class="separator:a02d558483ab82d340ee587febcfddd8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cfdc02d7860f91735b789ee11532982"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a9cfdc02d7860f91735b789ee11532982">physicalForce</a> (double force) const</td></tr>
<tr class="memdesc:a9cfdc02d7860f91735b789ee11532982"><td class="mdescLeft">&#160;</td><td class="mdescRight">Undo normalization for a given force.  <a href="#a9cfdc02d7860f91735b789ee11532982">More...</a><br /></td></tr>
<tr class="separator:a9cfdc02d7860f91735b789ee11532982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8353f189a07813687e6cda9dff5ef55a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a8353f189a07813687e6cda9dff5ef55a">convertToNormalizedUnits</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:a8353f189a07813687e6cda9dff5ef55a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert one structure to normalized units.  <a href="#a8353f189a07813687e6cda9dff5ef55a">More...</a><br /></td></tr>
<tr class="separator:a8353f189a07813687e6cda9dff5ef55a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbe07bd6a67b5df0b6dd5f5ce00fb1f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">convertToPhysicalUnits</a> (<a class="el" href="a00864.html">Structure</a> &amp;structure) const</td></tr>
<tr class="memdesc:abbe07bd6a67b5df0b6dd5f5ce00fb1f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert one structure to physical units.  <a href="#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">More...</a><br /></td></tr>
<tr class="separator:abbe07bd6a67b5df0b6dd5f5ce00fb1f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73bc18bc5e85e53303fea2132c4e78c"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aa73bc18bc5e85e53303fea2132c4e78c">getNumExtrapolationWarnings</a> () const</td></tr>
<tr class="memdesc:aa73bc18bc5e85e53303fea2132c4e78c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count total number of extrapolation warnings encountered for all elements and symmetry functions.  <a href="#aa73bc18bc5e85e53303fea2132c4e78c">More...</a><br /></td></tr>
<tr class="separator:aa73bc18bc5e85e53303fea2132c4e78c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab71571b8b4742c474c645fa50ffa667e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ab71571b8b4742c474c645fa50ffa667e">resetExtrapolationWarnings</a> ()</td></tr>
<tr class="memdesc:ab71571b8b4742c474c645fa50ffa667e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Erase all extrapolation warnings and reset counters.  <a href="#ab71571b8b4742c474c645fa50ffa667e">More...</a><br /></td></tr>
<tr class="separator:ab71571b8b4742c474c645fa50ffa667e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6e30b5a1e840dc2a98516a0f276a3c4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ab6e30b5a1e840dc2a98516a0f276a3c4">getMeanEnergy</a> () const</td></tr>
<tr class="memdesc:ab6e30b5a1e840dc2a98516a0f276a3c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">Mode::meanEnergy</a>.  <a href="#ab6e30b5a1e840dc2a98516a0f276a3c4">More...</a><br /></td></tr>
<tr class="separator:ab6e30b5a1e840dc2a98516a0f276a3c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8da7486dc693fafe772c12a440a623d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a8da7486dc693fafe772c12a440a623d8">getConvEnergy</a> () const</td></tr>
<tr class="memdesc:a8da7486dc693fafe772c12a440a623d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">Mode::convEnergy</a>.  <a href="#a8da7486dc693fafe772c12a440a623d8">More...</a><br /></td></tr>
<tr class="separator:a8da7486dc693fafe772c12a440a623d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a373073bd1acb1c9ac293369bb892bdc4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a373073bd1acb1c9ac293369bb892bdc4">getConvLength</a> () const</td></tr>
<tr class="memdesc:a373073bd1acb1c9ac293369bb892bdc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">Mode::convLength</a>.  <a href="#a373073bd1acb1c9ac293369bb892bdc4">More...</a><br /></td></tr>
<tr class="separator:a373073bd1acb1c9ac293369bb892bdc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73f1fcdcbb76828f6aca2d322bfeb2a9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a73f1fcdcbb76828f6aca2d322bfeb2a9">getMaxCutoffRadius</a> () const</td></tr>
<tr class="memdesc:a73f1fcdcbb76828f6aca2d322bfeb2a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">Mode::maxCutoffRadius</a>.  <a href="#a73f1fcdcbb76828f6aca2d322bfeb2a9">More...</a><br /></td></tr>
<tr class="separator:a73f1fcdcbb76828f6aca2d322bfeb2a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dbf87eaa9cc33fa740e03608acdf156"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a2dbf87eaa9cc33fa740e03608acdf156">getNumElements</a> () const</td></tr>
<tr class="memdesc:a2dbf87eaa9cc33fa740e03608acdf156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Getter for <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">Mode::numElements</a>.  <a href="#a2dbf87eaa9cc33fa740e03608acdf156">More...</a><br /></td></tr>
<tr class="separator:a2dbf87eaa9cc33fa740e03608acdf156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4fc3399c130a3778a20a625fa2ee34c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aa4fc3399c130a3778a20a625fa2ee34c">getNumSymmetryFunctions</a> () const</td></tr>
<tr class="memdesc:aa4fc3399c130a3778a20a625fa2ee34c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of symmetry functions per element.  <a href="#aa4fc3399c130a3778a20a625fa2ee34c">More...</a><br /></td></tr>
<tr class="separator:aa4fc3399c130a3778a20a625fa2ee34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c500a49ebbd16752c9dbe988f56f451"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a7c500a49ebbd16752c9dbe988f56f451">useNormalization</a> () const</td></tr>
<tr class="memdesc:a7c500a49ebbd16752c9dbe988f56f451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if normalization is enabled.  <a href="#a7c500a49ebbd16752c9dbe988f56f451">More...</a><br /></td></tr>
<tr class="separator:a7c500a49ebbd16752c9dbe988f56f451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9606884fa146912a6b4ab6d26df9275"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aa9606884fa146912a6b4ab6d26df9275">settingsKeywordExists</a> (std::string const &amp;keyword) const</td></tr>
<tr class="memdesc:aa9606884fa146912a6b4ab6d26df9275"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if keyword was found in settings file.  <a href="#aa9606884fa146912a6b4ab6d26df9275">More...</a><br /></td></tr>
<tr class="separator:aa9606884fa146912a6b4ab6d26df9275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b7eeb5daa541cc8e3ab36a9bcf69ab8"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a9b7eeb5daa541cc8e3ab36a9bcf69ab8">settingsGetValue</a> (std::string const &amp;keyword) const</td></tr>
<tr class="memdesc:a9b7eeb5daa541cc8e3ab36a9bcf69ab8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get value for given keyword in <a class="el" href="a00852.html" title="Reads and analyzes settings file and stores parameters. ">Settings</a> instance.  <a href="#a9b7eeb5daa541cc8e3ab36a9bcf69ab8">More...</a><br /></td></tr>
<tr class="separator:a9b7eeb5daa541cc8e3ab36a9bcf69ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b8ceb8be242844ec8b72987e0bf0c3e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a5b8ceb8be242844ec8b72987e0bf0c3e">pruneSymmetryFunctionsRange</a> (double threshold)</td></tr>
<tr class="memdesc:a5b8ceb8be242844ec8b72987e0bf0c3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prune symmetry functions according to their range and write settings file.  <a href="#a5b8ceb8be242844ec8b72987e0bf0c3e">More...</a><br /></td></tr>
<tr class="separator:a5b8ceb8be242844ec8b72987e0bf0c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae922768942eef6c6e9000700595bc00d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ae922768942eef6c6e9000700595bc00d">pruneSymmetryFunctionsSensitivity</a> (double threshold, std::vector&lt; std::vector&lt; double &gt; &gt; sensitivity)</td></tr>
<tr class="memdesc:ae922768942eef6c6e9000700595bc00d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prune symmetry functions with sensitivity analysis data.  <a href="#ae922768942eef6c6e9000700595bc00d">More...</a><br /></td></tr>
<tr class="separator:ae922768942eef6c6e9000700595bc00d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ac0b02c0a91917b17cd6e2fb96afb18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a6ac0b02c0a91917b17cd6e2fb96afb18">writePrunedSettingsFile</a> (std::vector&lt; std::size_t &gt; prune, std::string fileName=&quot;output.nn&quot;) const</td></tr>
<tr class="memdesc:a6ac0b02c0a91917b17cd6e2fb96afb18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy settings file but comment out lines provided.  <a href="#a6ac0b02c0a91917b17cd6e2fb96afb18">More...</a><br /></td></tr>
<tr class="separator:a6ac0b02c0a91917b17cd6e2fb96afb18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2d61853475185baae3fa3a7d358557a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#af2d61853475185baae3fa3a7d358557a">writeSettingsFile</a> (std::ofstream *const &amp;file) const</td></tr>
<tr class="memdesc:af2d61853475185baae3fa3a7d358557a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write complete settings file.  <a href="#af2d61853475185baae3fa3a7d358557a">More...</a><br /></td></tr>
<tr class="separator:af2d61853475185baae3fa3a7d358557a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a12a8249ac3aab222922c42781c344779"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00824.html">ElementMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a></td></tr>
<tr class="memdesc:a12a8249ac3aab222922c42781c344779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global element map, populated by <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5" title="Set up the element map. ">setupElementMap()</a>.  <a href="#a12a8249ac3aab222922c42781c344779">More...</a><br /></td></tr>
<tr class="separator:a12a8249ac3aab222922c42781c344779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae5d8b1186dde3ffbf2545fca1d08923"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00828.html">Log</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a></td></tr>
<tr class="memdesc:aae5d8b1186dde3ffbf2545fca1d08923"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global log file.  <a href="#aae5d8b1186dde3ffbf2545fca1d08923">More...</a><br /></td></tr>
<tr class="separator:aae5d8b1186dde3ffbf2545fca1d08923"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a043ac1c36d5edc38a6c72f4366823c69"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a></td></tr>
<tr class="separator:a043ac1c36d5edc38a6c72f4366823c69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03ee0e33408435b18a79a253e967856a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a></td></tr>
<tr class="separator:a03ee0e33408435b18a79a253e967856a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76d3694d566d2052c298325a18ee865c"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a></td></tr>
<tr class="separator:a76d3694d566d2052c298325a18ee865c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbb183f90ace9311391b9847580009ba"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::size_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a></td></tr>
<tr class="separator:abbb183f90ace9311391b9847580009ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16cf1320e7b8e3ff52802dff5b114fae"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a></td></tr>
<tr class="separator:a16cf1320e7b8e3ff52802dff5b114fae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38f8bc8db576ad1762dd306b4d225383"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a></td></tr>
<tr class="separator:a38f8bc8db576ad1762dd306b4d225383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded25017ec58efa0cc8d55bb9fb7dd25"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a></td></tr>
<tr class="separator:aded25017ec58efa0cc8d55bb9fb7dd25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c6554727f0af7501fe82dfe136b3865"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a></td></tr>
<tr class="separator:a5c6554727f0af7501fe82dfe136b3865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09461989d84484833b10c96e6871f87e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a></td></tr>
<tr class="separator:a09461989d84484833b10c96e6871f87e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d6eccfa0f21d64823f74cc75c89473f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a></td></tr>
<tr class="separator:a1d6eccfa0f21d64823f74cc75c89473f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf7de3d7a75f960af6a66c3e9ab6acb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00852.html">Settings</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a></td></tr>
<tr class="separator:acaf7de3d7a75f960af6a66c3e9ab6acb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ff5331297adab87a18dd7b0fac4e0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410">SymmetryFunction::ScalingType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a></td></tr>
<tr class="separator:ab7ff5331297adab87a18dd7b0fac4e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7e76062a64f8acdcf384bc487f8a4fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8">CutoffFunction::CutoffType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a></td></tr>
<tr class="separator:af7e76062a64f8acdcf384bc487f8a4fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f777011d3e3fbe644616e7763f9dd11"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="a00820.html">Element</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a></td></tr>
<tr class="separator:a6f777011d3e3fbe644616e7763f9dd11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Base class for all NNP applications. </p>
<p>This top-level class is the anchor point for existing and future applications. It contains functions to set up an existing neural network potential and calculate energies and forces for configurations given as <a class="el" href="a00864.html" title="Storage for one atomic configuration. ">Structure</a>. A minimal setup requires some consecutive functions calls as this minimal example shows:</p>
<div class="fragment"><div class="line"><a class="code" href="a00832.html#a098246baedeee64fa0ed3b53547cf55f">Mode</a> mode;</div><div class="line">mode.initialize();</div><div class="line">mode.loadSettingsFile();</div><div class="line">mode.setupElementMap();</div><div class="line">mode.setupElements();</div><div class="line">mode.setupCutoff();</div><div class="line">mode.setupSymmetryFunctions();</div><div class="line">mode.setupSymmetryFunctionGroups();</div><div class="line">mode.setupSymmetryFunctionStatistics(<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div><div class="line">mode.setupNeuralNetwork();</div></div><!-- fragment --><p> To load weights and scaling information from files add these lines: </p><div class="fragment"><div class="line">mode.setupSymmetryFunctionScaling();</div><div class="line">mode.setupNeuralNetworkWeights();</div></div><!-- fragment --><p> The NNP is now ready! If we load a structure from a data file: </p><div class="fragment"><div class="line">Structure structure;</div><div class="line">ifstream file;</div><div class="line">file.open(<span class="stringliteral">&quot;input.data&quot;</span>);</div><div class="line">structure.setupElementMap(mode.elementMap);</div><div class="line">structure.readFromFile(file);</div><div class="line">file.close();</div></div><!-- fragment --><p> we can finally predict the energy and forces from the neural network potential: </p><div class="fragment"><div class="line">structure.calculateNeighborList(mode.getMaxCutoffRadius());</div><div class="line">mode.calculateSymmetryFunctionGroups(structure, <span class="keyword">true</span>);</div><div class="line">mode.calculateAtomicNeuralNetworks(structure, <span class="keyword">true</span>);</div><div class="line">mode.calculateEnergy(structure);</div><div class="line">mode.calculateForces(structure);</div><div class="line">cout &lt;&lt; structure.energy &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div></div><!-- fragment --><p> The resulting potential energy is stored in <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5" title="Potential energy determined by neural network. ">Structure::energy</a>, the forces on individual atoms are located within the <a class="el" href="a00864.html#adee965dec483f9479378a2ed4acd5544" title="Vector of all atoms in this structure. ">Structure::atoms</a> vector in <a class="el" href="a00808.html#a170d82083599ace5c7973bd22c79ddae" title="Force vector calculated by neural network. ">Atom::f</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00082">82</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a098246baedeee64fa0ed3b53547cf55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a098246baedeee64fa0ed3b53547cf55f">&#9670;&nbsp;</a></span>Mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Mode::Mode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00033">33</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;           : <a class="code" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>                 (<span class="keyword">false</span>),</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;               <a class="code" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a>(<span class="keyword">false</span>),</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;               <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>               (0    ),</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;               <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>           (0.0  ),</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;               <a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a>               (0.0  ),</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;               <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>                (0.0  ),</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;               <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>                (1.0  ),</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;               <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>                (1.0  )</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
<div class="ttc" id="a00832_html_a043ac1c36d5edc38a6c72f4366823c69"><div class="ttname"><a href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a></div><div class="ttdeci">bool normalize</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00467">Mode.h:467</a></div></div>
<div class="ttc" id="a00832_html_aded25017ec58efa0cc8d55bb9fb7dd25"><div class="ttname"><a href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">nnp::Mode::cutoffAlpha</a></div><div class="ttdeci">double cutoffAlpha</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00473">Mode.h:473</a></div></div>
<div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a03ee0e33408435b18a79a253e967856a"><div class="ttname"><a href="a00832.html#a03ee0e33408435b18a79a253e967856a">nnp::Mode::checkExtrapolationWarnings</a></div><div class="ttdeci">bool checkExtrapolationWarnings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00468">Mode.h:468</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
<div class="ttc" id="a00832_html_a38f8bc8db576ad1762dd306b4d225383"><div class="ttname"><a href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">nnp::Mode::maxCutoffRadius</a></div><div class="ttdeci">double maxCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00472">Mode.h:472</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a19a68b9d8750ddc0b440b1828ecf9f17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a68b9d8750ddc0b440b1828ecf9f17">&#9670;&nbsp;</a></span>initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::initialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write welcome message with version information. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00044">44</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00209.html#a38dab5423f1c93cd2dc3b8079fd88895">NNP_GIT_BRANCH</a>, <a class="el" href="a00209.html#a4ea9d7ff8f854998b863f71a670e6d2d">NNP_GIT_REV</a>, <a class="el" href="a00209.html#a85d9a234f54dd66fb4b3e9e281188996">NNP_GIT_REV_SHORT</a>, <a class="el" href="a00209.html#aaf49e9de66a3e2c3e71ab3d928deac71">NNP_VERSION</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a">nnp::Prediction::setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;   NNP LIBRARY v&quot;</span> <a class="code" href="a00209.html#aaf49e9de66a3e2c3e71ab3d928deac71">NNP_VERSION</a> <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;   ------------------\n&quot;</span>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Git branch  : &quot;</span> <a class="code" href="a00209.html#a38dab5423f1c93cd2dc3b8079fd88895">NNP_GIT_BRANCH</a> <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Git revision: &quot;</span> <a class="code" href="a00209.html#a85d9a234f54dd66fb4b3e9e281188996">NNP_GIT_REV_SHORT</a> <span class="stringliteral">&quot; (&quot;</span> <a class="code" href="a00209.html#a4ea9d7ff8f854998b863f71a670e6d2d">NNP_GIT_REV</a> <span class="stringliteral">&quot;)\n&quot;</span>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Number of OpenMP threads: %d&quot;</span>, omp_get_max_threads());</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00209_html_a38dab5423f1c93cd2dc3b8079fd88895"><div class="ttname"><a href="a00209.html#a38dab5423f1c93cd2dc3b8079fd88895">NNP_GIT_BRANCH</a></div><div class="ttdeci">#define NNP_GIT_BRANCH</div><div class="ttdef"><b>Definition:</b> <a href="a00209_source.html#l00023">version.h:23</a></div></div>
<div class="ttc" id="a00209_html_a4ea9d7ff8f854998b863f71a670e6d2d"><div class="ttname"><a href="a00209.html#a4ea9d7ff8f854998b863f71a670e6d2d">NNP_GIT_REV</a></div><div class="ttdeci">#define NNP_GIT_REV</div><div class="ttdef"><b>Definition:</b> <a href="a00209_source.html#l00021">version.h:21</a></div></div>
<div class="ttc" id="a00209_html_a85d9a234f54dd66fb4b3e9e281188996"><div class="ttname"><a href="a00209.html#a85d9a234f54dd66fb4b3e9e281188996">NNP_GIT_REV_SHORT</a></div><div class="ttdeci">#define NNP_GIT_REV_SHORT</div><div class="ttdef"><b>Definition:</b> <a href="a00209_source.html#l00022">version.h:22</a></div></div>
<div class="ttc" id="a00209_html_aaf49e9de66a3e2c3e71ab3d928deac71"><div class="ttname"><a href="a00209.html#aaf49e9de66a3e2c3e71ab3d928deac71">NNP_VERSION</a></div><div class="ttdeci">#define NNP_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="a00209_source.html#l00020">version.h:20</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a19a68b9d8750ddc0b440b1828ecf9f17_cgraph.png" border="0" usemap="#a00832_a19a68b9d8750ddc0b440b1828ecf9f17_cgraph" alt=""/></div>
<map name="a00832_a19a68b9d8750ddc0b440b1828ecf9f17_cgraph" id="a00832_a19a68b9d8750ddc0b440b1828ecf9f17_cgraph">
<area shape="rect" id="node2" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="207,5,291,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a19a68b9d8750ddc0b440b1828ecf9f17_icgraph.png" border="0" usemap="#a00832_a19a68b9d8750ddc0b440b1828ecf9f17_icgraph" alt=""/></div>
<map name="a00832_a19a68b9d8750ddc0b440b1828ecf9f17_icgraph" id="a00832_a19a68b9d8750ddc0b440b1828ecf9f17_icgraph">
<area shape="rect" id="node2" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec" title="Initialize the LAMMPS interface. " alt="" coords="207,5,375,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="263,71,318,98"/>
<area shape="rect" id="node4" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a" title="nnp::Prediction::setup" alt="" coords="209,122,372,149"/>
</map>
</div>

</div>
</div>
<a id="ae8ca16789e7794309cf9931e58eb882b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8ca16789e7794309cf9931e58eb882b">&#9670;&nbsp;</a></span>loadSettingsFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::loadSettingsFile </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;input.nn&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open settings file and load all keywords into memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td><a class="el" href="a00852.html" title="Reads and analyzes settings file and stores parameters. ">Settings</a> file name. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00067">67</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00852.html#a10b63d77176a5a7a4f171e16bc1fccae">nnp::Settings::info()</a>, <a class="el" href="a00852.html#abb345542f6456257aae2e3409ab035f5">nnp::Settings::loadFile()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, and <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a">nnp::Prediction::setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SETTINGS FILE ****************&quot;</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#abb345542f6456257aae2e3409ab035f5">loadFile</a>(fileName);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a10b63d77176a5a7a4f171e16bc1fccae">info</a>();</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div><div class="ttc" id="a00852_html_abb345542f6456257aae2e3409ab035f5"><div class="ttname"><a href="a00852.html#abb345542f6456257aae2e3409ab035f5">nnp::Settings::loadFile</a></div><div class="ttdeci">void loadFile(std::string const &amp;fileName)</div><div class="ttdoc">Load a file with settings. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00107">Settings.cpp:107</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_a10b63d77176a5a7a4f171e16bc1fccae"><div class="ttname"><a href="a00852.html#a10b63d77176a5a7a4f171e16bc1fccae">nnp::Settings::info</a></div><div class="ttdeci">std::vector&lt; std::string &gt; info() const</div><div class="ttdoc">Get logged information about settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00142">Settings.cpp:142</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae8ca16789e7794309cf9931e58eb882b_cgraph.png" border="0" usemap="#a00832_ae8ca16789e7794309cf9931e58eb882b_cgraph" alt=""/></div>
<map name="a00832_ae8ca16789e7794309cf9931e58eb882b_cgraph" id="a00832_ae8ca16789e7794309cf9931e58eb882b_cgraph">
<area shape="rect" id="node2" href="a00852.html#a10b63d77176a5a7a4f171e16bc1fccae" title="Get logged information about settings file. " alt="" coords="266,5,406,32"/>
<area shape="rect" id="node3" href="a00852.html#abb345542f6456257aae2e3409ab035f5" title="Load a file with settings. " alt="" coords="253,56,419,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae8ca16789e7794309cf9931e58eb882b_icgraph.png" border="0" usemap="#a00832_ae8ca16789e7794309cf9931e58eb882b_icgraph" alt=""/></div>
<map name="a00832_ae8ca16789e7794309cf9931e58eb882b_icgraph" id="a00832_ae8ca16789e7794309cf9931e58eb882b_icgraph">
<area shape="rect" id="node2" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec" title="Initialize the LAMMPS interface. " alt="" coords="253,5,421,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="310,71,365,98"/>
<area shape="rect" id="node4" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a" title="nnp::Prediction::setup" alt="" coords="256,122,419,149"/>
</map>
</div>

</div>
</div>
<a id="adffbed0cbae8bc9c4f4c4556ff113b5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adffbed0cbae8bc9c4f4c4556ff113b5f">&#9670;&nbsp;</a></span>setupGeneric()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupGeneric </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Combine multiple setup routines and provide a basic NNP setup. </p>
<p>Sets up elements, symmetry functions, symmetry function groups, neural networks. No symmetry function scaling data is read, no weights are set. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00083">83</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff()</a>, <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap()</a>, <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements()</a>, <a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory()</a>, and <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a">nnp::Prediction::setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization</a>();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements</a>();</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff</a>();</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions</a>();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#ifdef IMPROVED_SFD_MEMORY</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#ifndef NOSFGROUPS</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups</a>();</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork</a>();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="ttc" id="a00832_html_a6f0184f87845a572cf4c3db0958a97d9"><div class="ttname"><a href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9">nnp::Mode::setupSymmetryFunctionGroups</a></div><div class="ttdeci">void setupSymmetryFunctionGroups()</div><div class="ttdoc">Set up symmetry function groups. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00534">Mode.cpp:534</a></div></div>
<div class="ttc" id="a00832_html_ae72c03926dc7ea9b8f43770fb5861ccf"><div class="ttname"><a href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">nnp::Mode::setupCutoff</a></div><div class="ttdeci">void setupCutoff()</div><div class="ttdoc">Set up cutoff function for all symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00217">Mode.cpp:217</a></div></div>
<div class="ttc" id="a00832_html_a3488a7fb2b0ccf17a9b2af514590f57c"><div class="ttname"><a href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">nnp::Mode::setupNeuralNetwork</a></div><div class="ttdeci">void setupNeuralNetwork()</div><div class="ttdoc">Set up neural networks for all elements. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00712">Mode.cpp:712</a></div></div>
<div class="ttc" id="a00832_html_af1d1548ef2d6a9bbfdc519b76b904700"><div class="ttname"><a href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">nnp::Mode::setupSymmetryFunctionMemory</a></div><div class="ttdeci">void setupSymmetryFunctionMemory(bool verbose=false)</div><div class="ttdoc">Extract required memory dimensions for symmetry function derivatives. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00583">Mode.cpp:583</a></div></div>
<div class="ttc" id="a00832_html_ad0080b25ea49cdd6ce085162751a379b"><div class="ttname"><a href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">nnp::Mode::setupSymmetryFunctions</a></div><div class="ttdeci">void setupSymmetryFunctions()</div><div class="ttdoc">Set up all symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00312">Mode.cpp:312</a></div></div>
<div class="ttc" id="a00832_html_aa837413e8d998f165f0b8527de636cb5"><div class="ttname"><a href="a00832.html#aa837413e8d998f165f0b8527de636cb5">nnp::Mode::setupNormalization</a></div><div class="ttdeci">void setupNormalization()</div><div class="ttdoc">Set up normalization. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00101">Mode.cpp:101</a></div></div>
<div class="ttc" id="a00832_html_afc4e43a8f905900eb4ea153d529053ec"><div class="ttname"><a href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">nnp::Mode::setupElements</a></div><div class="ttdeci">void setupElements()</div><div class="ttdoc">Set up all Element instances. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00171">Mode.cpp:171</a></div></div>
<div class="ttc" id="a00832_html_a259303c95ae2f64f2b192de1b2df51f5"><div class="ttname"><a href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">nnp::Mode::setupElementMap</a></div><div class="ttdeci">void setupElementMap()</div><div class="ttdoc">Set up the element map. </div><div class="ttdef"><b>Definition:</b> <a href="a00080_source.html#l00150">Mode.cpp:150</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_cgraph.png" border="0" usemap="#a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_cgraph" alt=""/></div>
<map name="a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_cgraph" id="a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_cgraph">
<area shape="rect" id="node2" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf" title="Set up cutoff function for all symmetry functions. " alt="" coords="265,5,437,32"/>
<area shape="rect" id="node3" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5" title="Set up the element map. " alt="" coords="244,56,459,83"/>
<area shape="rect" id="node4" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec" title="Set up all Element instances. " alt="" coords="254,107,449,133"/>
<area shape="rect" id="node5" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c" title="Set up neural networks for all elements. " alt="" coords="236,157,467,184"/>
<area shape="rect" id="node6" href="a00832.html#aa837413e8d998f165f0b8527de636cb5" title="Set up normalization. " alt="" coords="239,208,464,235"/>
<area shape="rect" id="node7" href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9" title="Set up symmetry function groups. " alt="" coords="251,259,452,301"/>
<area shape="rect" id="node8" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700" title="Extract required memory dimensions for symmetry function derivatives. " alt="" coords="251,325,452,366"/>
<area shape="rect" id="node9" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. " alt="" coords="251,390,452,431"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_icgraph.png" border="0" usemap="#a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_icgraph" alt=""/></div>
<map name="a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_icgraph" id="a00832_adffbed0cbae8bc9c4f4c4556ff113b5f_icgraph">
<area shape="rect" id="node2" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec" title="Initialize the LAMMPS interface. " alt="" coords="236,5,404,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="293,71,347,98"/>
<area shape="rect" id="node4" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a" title="nnp::Prediction::setup" alt="" coords="239,122,401,149"/>
</map>
</div>

</div>
</div>
<a id="aa837413e8d998f165f0b8527de636cb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa837413e8d998f165f0b8527de636cb5">&#9670;&nbsp;</a></span>setupNormalization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupNormalization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up normalization. </p>
<p>If the keywords <code>mean_energy</code>, <code>conv_length</code> and <code>conv_length</code> are present, the provided conversion factors are used to internally use a different unit system. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00101">101</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>, <a class="el" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, <a class="el" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: NORMALIZATION ****************&quot;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;mean_energy&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;conv_energy&quot;</span>) &amp;&amp;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;conv_length&quot;</span>))</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <a class="code" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a> = atof(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;mean_energy&quot;</span>].c_str());</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a> = atof(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;conv_energy&quot;</span>].c_str());</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a> = atof(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;conv_length&quot;</span>].c_str());</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Data set normalization is used.\n&quot;</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Mean energy per atom     : %24.16E\n&quot;</span>, <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Conversion factor energy : %24.16E\n&quot;</span>, <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Conversion factor length : %24.16E\n&quot;</span>, <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;atom_energy&quot;</span>))</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        {</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Atomic energy offsets are used in addition to&quot;</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                   <span class="stringliteral">&quot; data set normalization.\n&quot;</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Offsets will be subtracted from reference energies BEFORE&quot;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                   <span class="stringliteral">&quot; normalization is applied.\n&quot;</span>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        }</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((!<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;mean_energy&quot;</span>)) &amp;&amp;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;             (!<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;conv_energy&quot;</span>)) &amp;&amp;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;             (!<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;conv_length&quot;</span>)))</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Data set normalization is not used.\n&quot;</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Incorrect usage of normalization&quot;</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                            <span class="stringliteral">&quot; keywords.\n&quot;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                            <span class="stringliteral">&quot;       Use all or none of \&quot;mean_energy\&quot;, &quot;</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                            <span class="stringliteral">&quot;\&quot;conv_energy\&quot; and \&quot;conv_length\&quot;.\n&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
<div class="ttc" id="a00832_html_a043ac1c36d5edc38a6c72f4366823c69"><div class="ttname"><a href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a></div><div class="ttdeci">bool normalize</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00467">Mode.h:467</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_a14649c081ce9e5c31c8b152079407f1b"><div class="ttname"><a href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists</a></div><div class="ttdeci">bool keywordExists(std::string const &amp;keyword) const</div><div class="ttdoc">Check if keyword was read from the settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00115">Settings.cpp:115</a></div></div>
<div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa837413e8d998f165f0b8527de636cb5_cgraph.png" border="0" usemap="#a00832_aa837413e8d998f165f0b8527de636cb5_cgraph" alt=""/></div>
<map name="a00832_aa837413e8d998f165f0b8527de636cb5_cgraph" id="a00832_aa837413e8d998f165f0b8527de636cb5_cgraph">
<area shape="rect" id="node2" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b" title="Check if keyword was read from the settings file. " alt="" coords="279,5,489,32"/>
<area shape="rect" id="node3" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="342,56,426,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa837413e8d998f165f0b8527de636cb5_icgraph.png" border="0" usemap="#a00832_aa837413e8d998f165f0b8527de636cb5_icgraph" alt=""/></div>
<map name="a00832_aa837413e8d998f165f0b8527de636cb5_icgraph" id="a00832_aa837413e8d998f165f0b8527de636cb5_icgraph">
<area shape="rect" id="node2" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="279,5,461,32"/>
</map>
</div>

</div>
</div>
<a id="a259303c95ae2f64f2b192de1b2df51f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a259303c95ae2f64f2b192de1b2df51f5">&#9670;&nbsp;</a></span>setupElementMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupElementMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up the element map. </p>
<p>Uses keyword <code>elements</code>. This function should follow immediately after settings are loaded via <a class="el" href="a00832.html#ae8ca16789e7794309cf9931e58eb882b" title="Open settings file and load all keywords into memory. ">loadSettingsFile()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00150">150</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00824.html#acd54eb7c8fd1f9967604463ff11ffce1">nnp::ElementMap::atomicNumber()</a>, <a class="el" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00824.html#a17d6d160054a064199a8757eb62b3350">nnp::ElementMap::registerElements()</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, <a class="el" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00026.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: ELEMENT MAP ******************&quot;</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="a00824.html#a17d6d160054a064199a8757eb62b3350">registerElements</a>(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;elements&quot;</span>]);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Number of element strings found: %d\n&quot;</span>, <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>());</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>(); ++i)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Element %2zu: %2s (%3zu)\n&quot;</span>, i, <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[i].c_str(),</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                     <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="a00824.html#acd54eb7c8fd1f9967604463ff11ffce1">atomicNumber</a>(i));</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00824_html_acd54eb7c8fd1f9967604463ff11ffce1"><div class="ttname"><a href="a00824.html#acd54eb7c8fd1f9967604463ff11ffce1">nnp::ElementMap::atomicNumber</a></div><div class="ttdeci">std::size_t atomicNumber(std::size_t index) const</div><div class="ttdoc">Get atomic number from element index. </div><div class="ttdef"><b>Definition:</b> <a href="a00071_source.html#l00145">ElementMap.h:145</a></div></div>
<div class="ttc" id="a00824_html_a17d6d160054a064199a8757eb62b3350"><div class="ttname"><a href="a00824.html#a17d6d160054a064199a8757eb62b3350">nnp::ElementMap::registerElements</a></div><div class="ttdeci">std::size_t registerElements(std::string const &amp;elementLine)</div><div class="ttdoc">Extract all elements and store in element map. </div><div class="ttdef"><b>Definition:</b> <a href="a00068_source.html#l00036">ElementMap.cpp:36</a></div></div>
<div class="ttc" id="a00832_html_a12a8249ac3aab222922c42781c344779"><div class="ttname"><a href="a00832.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Global element map, populated by setupElementMap(). </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00462">Mode.h:462</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00824_html_a94031b84fe2b38bbdb62ba700d5481a4"><div class="ttname"><a href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">Get element map size. </div><div class="ttdef"><b>Definition:</b> <a href="a00071_source.html#l00140">ElementMap.h:140</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a259303c95ae2f64f2b192de1b2df51f5_cgraph.png" border="0" usemap="#a00832_a259303c95ae2f64f2b192de1b2df51f5_cgraph" alt=""/></div>
<map name="a00832_a259303c95ae2f64f2b192de1b2df51f5_cgraph" id="a00832_a259303c95ae2f64f2b192de1b2df51f5_cgraph">
<area shape="rect" id="node2" href="a00824.html#acd54eb7c8fd1f9967604463ff11ffce1" title="Get atomic number from element index. " alt="" coords="268,5,508,32"/>
<area shape="rect" id="node3" href="a00824.html#a17d6d160054a064199a8757eb62b3350" title="Extract all elements and store in element map. " alt="" coords="291,57,485,98"/>
<area shape="rect" id="node4" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size. " alt="" coords="303,123,473,149"/>
<area shape="rect" id="node5" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="346,173,430,200"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a259303c95ae2f64f2b192de1b2df51f5_icgraph.png" border="0" usemap="#a00832_a259303c95ae2f64f2b192de1b2df51f5_icgraph" alt=""/></div>
<map name="a00832_a259303c95ae2f64f2b192de1b2df51f5_icgraph" id="a00832_a259303c95ae2f64f2b192de1b2df51f5_icgraph">
<area shape="rect" id="node2" href="a00026.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="332,5,387,32"/>
<area shape="rect" id="node3" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="268,56,451,83"/>
</map>
</div>

</div>
</div>
<a id="afc4e43a8f905900eb4ea153d529053ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4e43a8f905900eb4ea153d529053ec">&#9670;&nbsp;</a></span>setupElements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupElements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up all <a class="el" href="a00820.html" title="Contains element-specific data. ">Element</a> instances. </p>
<p>Uses keywords <code>number_of_elements</code> and <code>atom_energy</code>. This function should follow immediately after <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5" title="Set up the element map. ">setupElementMap()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00171">171</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00852.html#a8b0d951c5548f17e64598900b5aca088">nnp::Settings::getValues()</a>, <a class="el" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, <a class="el" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce()</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, <a class="el" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size()</a>, <a class="el" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00026.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: ELEMENTS *********************&quot;</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a> = (size_t)atoi(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;number_of_elements&quot;</span>].c_str());</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a> != <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>())</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Inconsistent number of elements.\n&quot;</span>);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Number of elements is consistent: %zu\n&quot;</span>, <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.push_back(<a class="code" href="a00820.html">Element</a>(i, <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>));</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;atom_energy&quot;</span>))</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <a class="code" href="a00852.html#ac0f72e3b3484f4d411eb4a5d36e3d959">Settings::KeyRange</a> r = <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a8b0d951c5548f17e64598900b5aca088">getValues</a>(<span class="stringliteral">&quot;atom_energy&quot;</span>);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">for</span> (Settings::KeyMap::const_iterator it = r.first;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;             it != r.second; ++it)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            vector&lt;string&gt; args    = <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">reduce</a>(it-&gt;second.first));</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordtype">size_t</span>         element = <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[args.at(0)];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(element).</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                setAtomicEnergyOffset(atof(args.at(1).c_str()));</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Atomic energy offsets per element:\n&quot;</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>.<a class="code" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">size</a>(); ++i)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Element %2zu: %16.8E\n&quot;</span>,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                     i, <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset());</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Energy offsets are automatically subtracted from reference &quot;</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;           <span class="stringliteral">&quot;energies.\n&quot;</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00852_html_ac0f72e3b3484f4d411eb4a5d36e3d959"><div class="ttname"><a href="a00852.html#ac0f72e3b3484f4d411eb4a5d36e3d959">nnp::Settings::KeyRange</a></div><div class="ttdeci">std::pair&lt; KeyMap::const_iterator, KeyMap::const_iterator &gt; KeyRange</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00036">Settings.h:36</a></div></div>
<div class="ttc" id="a00258_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00032">utility.cpp:32</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00258_html_a90ee48c5fb70d20abeebe648dc07dba7"><div class="ttname"><a href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00059">utility.cpp:59</a></div></div>
<div class="ttc" id="a00852_html_a8b0d951c5548f17e64598900b5aca088"><div class="ttname"><a href="a00852.html#a8b0d951c5548f17e64598900b5aca088">nnp::Settings::getValues</a></div><div class="ttdeci">KeyRange getValues(std::string const &amp;keyword) const</div><div class="ttdoc">Get all keyword-value pairs for given keyword. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00131">Settings.cpp:131</a></div></div>
<div class="ttc" id="a00832_html_a12a8249ac3aab222922c42781c344779"><div class="ttname"><a href="a00832.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Global element map, populated by setupElementMap(). </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00462">Mode.h:462</a></div></div>
<div class="ttc" id="a00820_html"><div class="ttname"><a href="a00820.html">nnp::Element</a></div><div class="ttdoc">Contains element-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00036">Element.h:36</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_a14649c081ce9e5c31c8b152079407f1b"><div class="ttname"><a href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists</a></div><div class="ttdeci">bool keywordExists(std::string const &amp;keyword) const</div><div class="ttdoc">Check if keyword was read from the settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00115">Settings.cpp:115</a></div></div>
<div class="ttc" id="a00824_html_a94031b84fe2b38bbdb62ba700d5481a4"><div class="ttname"><a href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4">nnp::ElementMap::size</a></div><div class="ttdeci">std::size_t size() const</div><div class="ttdoc">Get element map size. </div><div class="ttdef"><b>Definition:</b> <a href="a00071_source.html#l00140">ElementMap.h:140</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_afc4e43a8f905900eb4ea153d529053ec_cgraph.png" border="0" usemap="#a00832_afc4e43a8f905900eb4ea153d529053ec_cgraph" alt=""/></div>
<map name="a00832_afc4e43a8f905900eb4ea153d529053ec_cgraph" id="a00832_afc4e43a8f905900eb4ea153d529053ec_cgraph">
<area shape="rect" id="node2" href="a00852.html#a8b0d951c5548f17e64598900b5aca088" title="Get all keyword&#45;value pairs for given keyword. " alt="" coords="264,5,443,32"/>
<area shape="rect" id="node3" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b" title="Check if keyword was read from the settings file. " alt="" coords="248,56,459,83"/>
<area shape="rect" id="node4" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7" title="Replace multiple whitespaces with fill. " alt="" coords="304,107,403,133"/>
<area shape="rect" id="node5" href="a00824.html#a94031b84fe2b38bbdb62ba700d5481a4" title="Get element map size. " alt="" coords="269,157,438,184"/>
<area shape="rect" id="node6" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter. " alt="" coords="312,208,395,235"/>
<area shape="rect" id="node7" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="311,259,395,285"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_afc4e43a8f905900eb4ea153d529053ec_icgraph.png" border="0" usemap="#a00832_afc4e43a8f905900eb4ea153d529053ec_icgraph" alt=""/></div>
<map name="a00832_afc4e43a8f905900eb4ea153d529053ec_icgraph" id="a00832_afc4e43a8f905900eb4ea153d529053ec_icgraph">
<area shape="rect" id="node2" href="a00026.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="312,5,367,32"/>
<area shape="rect" id="node3" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="248,56,431,83"/>
</map>
</div>

</div>
</div>
<a id="ae72c03926dc7ea9b8f43770fb5861ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae72c03926dc7ea9b8f43770fb5861ccf">&#9670;&nbsp;</a></span>setupCutoff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupCutoff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up cutoff function for all symmetry functions. </p>
<p>Uses keyword <code>cutoff_type</code>. Cutoff parameters are read from settings keywords and stored internally. As soon as <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a> is called the settings are restored and used for all symmetry functions. Thus, this function must be called before <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00217">217</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8adb8558ac5f4c7f7e47ecc6e6febf6cc1">nnp::CutoffFunction::CT_COS</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8ac56c478b60424a8239af9240824c75ab">nnp::CutoffFunction::CT_EXP</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aad0969728f1ff733e44eeb23a0243f29">nnp::CutoffFunction::CT_HARD</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aa026feb56e31f7b86310470f6d4b8fc3">nnp::CutoffFunction::CT_POLY1</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8a58e2b60c88345e1eda934ccfa8a502db">nnp::CutoffFunction::CT_POLY2</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8af34a44bd38be6dfdde4bc60a19c09e34">nnp::CutoffFunction::CT_POLY3</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8ae5d32c978f9537fd2e2fa4ac42797cc7">nnp::CutoffFunction::CT_POLY4</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8a0ec474efe78ea6ee51f6a92b109c1688">nnp::CutoffFunction::CT_TANH</a>, <a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aea950c10f5352bfe6d601fd68e61237c">nnp::CutoffFunction::CT_TANHU</a>, <a class="el" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a>, <a class="el" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, <a class="el" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00044.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;{</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: CUTOFF FUNCTIONS *************&quot;</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    vector&lt;string&gt; args = <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;cutoff_type&quot;</span>]);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> = (<a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8">CutoffFunction::CutoffType</a>) atoi(args.at(0).c_str());</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span> (args.size() &gt; 1)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a> = atof(args.at(1).c_str());</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (0.0 &lt; <a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a> &amp;&amp; <a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a> &gt;= 1.0)</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="keywordflow">throw</span> invalid_argument(<span class="stringliteral">&quot;ERROR: 0 &lt;= alpha &lt; 1.0 is required.\n&quot;</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Parameter alpha for inner cutoff: %f\n&quot;</span>, <a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a>);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Inner cutoff = Symmetry function cutoff * alpha\n&quot;</span>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Equal cutoff function type for all symmetry functions:\n&quot;</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8adb8558ac5f4c7f7e47ecc6e6febf6cc1">CutoffFunction::CT_COS</a>)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_COS (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;x := (r - rc * alpha) / (rc - rc * alpha)\n&quot;</span>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(x) = 1/2 * (cos(pi*x) + 1)\n&quot;</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aea950c10f5352bfe6d601fd68e61237c">CutoffFunction::CT_TANHU</a>)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_TANHU (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(r) = tanh^3(1 - r/rc)\n&quot;</span>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a> &gt; 0.0)</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Inner cutoff parameter not used in combination&quot;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                   <span class="stringliteral">&quot; with this cutoff function.\n&quot;</span>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8a0ec474efe78ea6ee51f6a92b109c1688">CutoffFunction::CT_TANH</a>)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_TANH (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(r) = c * tanh^3(1 - r/rc), f(0) = 1\n&quot;</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a> &gt; 0.0)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Inner cutoff parameter not used in combination&quot;</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                   <span class="stringliteral">&quot; with this cutoff function.\n&quot;</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aa026feb56e31f7b86310470f6d4b8fc3">CutoffFunction::CT_POLY1</a>)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_POLY1 (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;x := (r - rc * alpha) / (rc - rc * alpha)\n&quot;</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(x) = (2x - 3)x^2 + 1\n&quot;</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8a58e2b60c88345e1eda934ccfa8a502db">CutoffFunction::CT_POLY2</a>)</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_POLY2 (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;x := (r - rc * alpha) / (rc - rc * alpha)\n&quot;</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(x) = ((15 - 6x)x - 10)x^3 + 1\n&quot;</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8af34a44bd38be6dfdde4bc60a19c09e34">CutoffFunction::CT_POLY3</a>)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_POLY3 (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;x := (r - rc * alpha) / (rc - rc * alpha)\n&quot;</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(x) = (x(x(20x - 70) + 84) - 35)x^4 + 1\n&quot;</span>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8ae5d32c978f9537fd2e2fa4ac42797cc7">CutoffFunction::CT_POLY4</a>)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_POLY4 (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;x := (r - rc * alpha) / (rc - rc * alpha)\n&quot;</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(x) = (x(x((315 - 70x)x - 540) + 420) - 126)x^5 + 1\n&quot;</span>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8ac56c478b60424a8239af9240824c75ab">CutoffFunction::CT_EXP</a>)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_EXP (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;x := (r - rc * alpha) / (rc - rc * alpha)\n&quot;</span>;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(x) = exp(-1 / 1 - x^2)\n&quot;</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a> == <a class="code" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aad0969728f1ff733e44eeb23a0243f29">CutoffFunction::CT_HARD</a>)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;CutoffFunction::CT_HARD (%d)\n&quot;</span>, <a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;f(r) = 1\n&quot;</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Hard cutoff used!\n&quot;</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">throw</span> invalid_argument(<span class="stringliteral">&quot;ERROR: Unknown cutoff type.\n&quot;</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00258_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00032">utility.cpp:32</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8">nnp::CutoffFunction::CutoffType</a></div><div class="ttdeci">CutoffType</div><div class="ttdoc">List of available cutoff function types. </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00040">CutoffFunction.h:40</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8aad0969728f1ff733e44eeb23a0243f29"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aad0969728f1ff733e44eeb23a0243f29">nnp::CutoffFunction::CT_HARD</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00044">CutoffFunction.h:44</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8aa026feb56e31f7b86310470f6d4b8fc3"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aa026feb56e31f7b86310470f6d4b8fc3">nnp::CutoffFunction::CT_POLY1</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00060">CutoffFunction.h:60</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8ae5d32c978f9537fd2e2fa4ac42797cc7"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8ae5d32c978f9537fd2e2fa4ac42797cc7">nnp::CutoffFunction::CT_POLY4</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00069">CutoffFunction.h:69</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8af34a44bd38be6dfdde4bc60a19c09e34"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8af34a44bd38be6dfdde4bc60a19c09e34">nnp::CutoffFunction::CT_POLY3</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00066">CutoffFunction.h:66</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8ac56c478b60424a8239af9240824c75ab"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8ac56c478b60424a8239af9240824c75ab">nnp::CutoffFunction::CT_EXP</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00057">CutoffFunction.h:57</a></div></div>
<div class="ttc" id="a00832_html_af7e76062a64f8acdcf384bc487f8a4fb"><div class="ttname"><a href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">nnp::Mode::cutoffType</a></div><div class="ttdeci">CutoffFunction::CutoffType cutoffType</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00479">Mode.h:479</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8a0ec474efe78ea6ee51f6a92b109c1688"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8a0ec474efe78ea6ee51f6a92b109c1688">nnp::CutoffFunction::CT_TANH</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00054">CutoffFunction.h:54</a></div></div>
<div class="ttc" id="a00832_html_aded25017ec58efa0cc8d55bb9fb7dd25"><div class="ttname"><a href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">nnp::Mode::cutoffAlpha</a></div><div class="ttdeci">double cutoffAlpha</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00473">Mode.h:473</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8aea950c10f5352bfe6d601fd68e61237c"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8aea950c10f5352bfe6d601fd68e61237c">nnp::CutoffFunction::CT_TANHU</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00050">CutoffFunction.h:50</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8a58e2b60c88345e1eda934ccfa8a502db"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8a58e2b60c88345e1eda934ccfa8a502db">nnp::CutoffFunction::CT_POLY2</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00063">CutoffFunction.h:63</a></div></div>
<div class="ttc" id="a00816_html_a0a5fd8220ae66e1442b6692885316fa8adb8558ac5f4c7f7e47ecc6e6febf6cc1"><div class="ttname"><a href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8adb8558ac5f4c7f7e47ecc6e6febf6cc1">nnp::CutoffFunction::CT_COS</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00059_source.html#l00047">CutoffFunction.h:47</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae72c03926dc7ea9b8f43770fb5861ccf_cgraph.png" border="0" usemap="#a00832_ae72c03926dc7ea9b8f43770fb5861ccf_cgraph" alt=""/></div>
<map name="a00832_ae72c03926dc7ea9b8f43770fb5861ccf_cgraph" id="a00832_ae72c03926dc7ea9b8f43770fb5861ccf_cgraph">
<area shape="rect" id="node2" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter. " alt="" coords="226,5,309,32"/>
<area shape="rect" id="node3" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="225,56,309,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae72c03926dc7ea9b8f43770fb5861ccf_icgraph.png" border="0" usemap="#a00832_ae72c03926dc7ea9b8f43770fb5861ccf_icgraph" alt=""/></div>
<map name="a00832_ae72c03926dc7ea9b8f43770fb5861ccf_icgraph" id="a00832_ae72c03926dc7ea9b8f43770fb5861ccf_icgraph">
<area shape="rect" id="node2" href="a00044.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="289,5,344,32"/>
<area shape="rect" id="node3" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="225,56,408,83"/>
</map>
</div>

</div>
</div>
<a id="ad0080b25ea49cdd6ce085162751a379b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0080b25ea49cdd6ce085162751a379b">&#9670;&nbsp;</a></span>setupSymmetryFunctions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupSymmetryFunctions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up all symmetry functions. </p>
<p>Uses keyword <code>symfunction_short</code>. Reads all symmetry functions from settings and automatically assigns them to the correct element. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00312">312</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>, <a class="el" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a>, <a class="el" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>, <a class="el" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00852.html#a8b0d951c5548f17e64598900b5aca088">nnp::Settings::getValues()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>, <a class="el" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>, <a class="el" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>, <a class="el" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>, <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, <a class="el" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce()</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, <a class="el" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00044.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SYMMETRY FUNCTIONS ***********&quot;</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="a00852.html#ac0f72e3b3484f4d411eb4a5d36e3d959">Settings::KeyRange</a> r = <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a8b0d951c5548f17e64598900b5aca088">getValues</a>(<span class="stringliteral">&quot;symfunction_short&quot;</span>);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">for</span> (Settings::KeyMap::const_iterator it = r.first; it != r.second; ++it)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        vector&lt;string&gt; args    = <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">reduce</a>(it-&gt;second.first));</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordtype">size_t</span>         element = <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[args.at(0)];</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(element).addSymmetryFunction(it-&gt;second.first,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                                 it-&gt;second.second);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Abbreviations:\n&quot;</span>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;--------------\n&quot;</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ind .... Symmetry function index.\n&quot;</span>;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ec ..... Central atom element.\n&quot;</span>;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ty ..... Symmetry function type.\n&quot;</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;e1 ..... Neighbor 1 element.\n&quot;</span>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;e2 ..... Neighbor 2 element.\n&quot;</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;eta .... Gaussian width eta.\n&quot;</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;rs ..... Shift distance of Gaussian.\n&quot;</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;la ..... Angle prefactor lambda.\n&quot;</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;zeta ... Angle term exponent zeta.\n&quot;</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;rc ..... Cutoff radius.\n&quot;</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ct ..... Cutoff type.\n&quot;</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ca ..... Cutoff alpha.\n&quot;</span>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ln ..... Line number in settings file.\n&quot;</span>;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a> = 0.0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>) it-&gt;changeLengthUnitSymmetryFunctions(<a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        it-&gt;sortSymmetryFunctions();</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a> = max(it-&gt;getMaxCutoffRadius(), <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        it-&gt;setCutoffFunction(<a class="code" href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">cutoffType</a>, <a class="code" href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">cutoffAlpha</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Short range atomic symmetry functions element %2s :\n&quot;</span>,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                     it-&gt;getSymbol().c_str());</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot; ind ec ty e1 e2       eta        rs la &quot;</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;               <span class="stringliteral">&quot;zeta        rc ct   ca    ln\n&quot;</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        log &lt;&lt; it-&gt;infoSymmetryFunctionParameters();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>.resize(<a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, 0);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>.resize(<a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <a class="code" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>.at(i) = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getMinNeighbors();</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>.at(i) = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getMinCutoffRadius();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Minimum cutoff radius for element %2s: %f\n&quot;</span>,</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                     <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getSymbol().c_str(),</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                     <a class="code" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>.at(i) / <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Maximum cutoff radius (global)      : %f\n&quot;</span>,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                 <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a> / <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00852_html_ac0f72e3b3484f4d411eb4a5d36e3d959"><div class="ttname"><a href="a00852.html#ac0f72e3b3484f4d411eb4a5d36e3d959">nnp::Settings::KeyRange</a></div><div class="ttdeci">std::pair&lt; KeyMap::const_iterator, KeyMap::const_iterator &gt; KeyRange</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00036">Settings.h:36</a></div></div>
<div class="ttc" id="a00258_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00032">utility.cpp:32</a></div></div>
<div class="ttc" id="a00832_html_a16cf1320e7b8e3ff52802dff5b114fae"><div class="ttname"><a href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">nnp::Mode::minCutoffRadius</a></div><div class="ttdeci">std::vector&lt; double &gt; minCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00471">Mode.h:471</a></div></div>
<div class="ttc" id="a00832_html_abbb183f90ace9311391b9847580009ba"><div class="ttname"><a href="a00832.html#abbb183f90ace9311391b9847580009ba">nnp::Mode::minNeighbors</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; minNeighbors</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00470">Mode.h:470</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00832_html_a043ac1c36d5edc38a6c72f4366823c69"><div class="ttname"><a href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a></div><div class="ttdeci">bool normalize</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00467">Mode.h:467</a></div></div>
<div class="ttc" id="a00258_html_a90ee48c5fb70d20abeebe648dc07dba7"><div class="ttname"><a href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00059">utility.cpp:59</a></div></div>
<div class="ttc" id="a00852_html_a8b0d951c5548f17e64598900b5aca088"><div class="ttname"><a href="a00852.html#a8b0d951c5548f17e64598900b5aca088">nnp::Settings::getValues</a></div><div class="ttdeci">KeyRange getValues(std::string const &amp;keyword) const</div><div class="ttdoc">Get all keyword-value pairs for given keyword. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00131">Settings.cpp:131</a></div></div>
<div class="ttc" id="a00832_html_a12a8249ac3aab222922c42781c344779"><div class="ttname"><a href="a00832.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Global element map, populated by setupElementMap(). </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00462">Mode.h:462</a></div></div>
<div class="ttc" id="a00832_html_af7e76062a64f8acdcf384bc487f8a4fb"><div class="ttname"><a href="a00832.html#af7e76062a64f8acdcf384bc487f8a4fb">nnp::Mode::cutoffType</a></div><div class="ttdeci">CutoffFunction::CutoffType cutoffType</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00479">Mode.h:479</a></div></div>
<div class="ttc" id="a00832_html_aded25017ec58efa0cc8d55bb9fb7dd25"><div class="ttname"><a href="a00832.html#aded25017ec58efa0cc8d55bb9fb7dd25">nnp::Mode::cutoffAlpha</a></div><div class="ttdeci">double cutoffAlpha</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00473">Mode.h:473</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a38f8bc8db576ad1762dd306b4d225383"><div class="ttname"><a href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">nnp::Mode::maxCutoffRadius</a></div><div class="ttdeci">double maxCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00472">Mode.h:472</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ad0080b25ea49cdd6ce085162751a379b_cgraph.png" border="0" usemap="#a00832_ad0080b25ea49cdd6ce085162751a379b_cgraph" alt=""/></div>
<map name="a00832_ad0080b25ea49cdd6ce085162751a379b_cgraph" id="a00832_ad0080b25ea49cdd6ce085162751a379b_cgraph">
<area shape="rect" id="node2" href="a00852.html#a8b0d951c5548f17e64598900b5aca088" title="Get all keyword&#45;value pairs for given keyword. " alt="" coords="255,5,433,32"/>
<area shape="rect" id="node3" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7" title="Replace multiple whitespaces with fill. " alt="" coords="295,56,393,83"/>
<area shape="rect" id="node4" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter. " alt="" coords="303,107,385,133"/>
<area shape="rect" id="node5" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="302,157,386,184"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ad0080b25ea49cdd6ce085162751a379b_icgraph.png" border="0" usemap="#a00832_ad0080b25ea49cdd6ce085162751a379b_icgraph" alt=""/></div>
<map name="a00832_ad0080b25ea49cdd6ce085162751a379b_icgraph" id="a00832_ad0080b25ea49cdd6ce085162751a379b_icgraph">
<area shape="rect" id="node2" href="a00044.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="319,5,373,32"/>
<area shape="rect" id="node3" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="255,56,437,83"/>
</map>
</div>

</div>
</div>
<a id="a9a672cac54995b226d8e69bb8be2669d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a672cac54995b226d8e69bb8be2669d">&#9670;&nbsp;</a></span>setupSymmetryFunctionScalingNone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupSymmetryFunctionScalingNone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up "empy" symmetry function scaling. </p>
<p>Does not use any keywords. Sets no scaling for all symmetry functions. Call after <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a>. Alternatively set scaling via <a class="el" href="a00832.html#aa26222b7b9dc3fd141f6e775690b5d2b" title="Set up symmetry function scaling from file. ">setupSymmetryFunctionScaling()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00384">384</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, and <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00035.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SYMMETRY FUNCTION SCALING ****&quot;</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;No scaling for symmetry functions.\n&quot;</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    {</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        it-&gt;setScalingNone();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div><div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a9a672cac54995b226d8e69bb8be2669d_icgraph.png" border="0" usemap="#a00832_a9a672cac54995b226d8e69bb8be2669d_icgraph" alt=""/></div>
<map name="a00832_a9a672cac54995b226d8e69bb8be2669d_icgraph" id="a00832_a9a672cac54995b226d8e69bb8be2669d_icgraph">
<area shape="rect" id="node2" href="a00035.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="255,13,309,39"/>
</map>
</div>

</div>
</div>
<a id="aa26222b7b9dc3fd141f6e775690b5d2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa26222b7b9dc3fd141f6e775690b5d2b">&#9670;&nbsp;</a></span>setupSymmetryFunctionScaling()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupSymmetryFunctionScaling </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;scaling.data&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up symmetry function scaling from file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Scaling file name.</td></tr>
  </table>
  </dd>
</dl>
<p>Uses keywords <code>scale_symmetry_functions</code>, <code>center_symmetry_functions</code>, <code>scale_symmetry_functions_sigma</code>, <code>scale_min_short</code> and <code>scale_max_short</code>. Reads in scaling information and sets correct scaling behavior for all symmetry functions. Call after <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00404">404</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, <a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a4cec917c81df7b855e6465e2b74b8e27">nnp::SymmetryFunction::ST_CENTER</a>, <a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410ad3072f9f35ccec9e99afc05b59592bdc">nnp::SymmetryFunction::ST_NONE</a>, <a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a0566f47a41cdc017fc89c746fe97ce25">nnp::SymmetryFunction::ST_SCALE</a>, <a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a67720263b628f46cf0c56f895561fa5f">nnp::SymmetryFunction::ST_SCALECENTER</a>, <a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410af66e7656f508710a6a4737e71447246c">nnp::SymmetryFunction::ST_SCALESIGMA</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a">nnp::Prediction::setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;{</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SYMMETRY FUNCTION SCALING ****&quot;</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Equal scaling type for all symmetry functions:\n&quot;</span>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">if</span> (   ( <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;scale_symmetry_functions&quot;</span> ))</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        &amp;&amp; (!<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;center_symmetry_functions&quot;</span>)))</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> = <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a0566f47a41cdc017fc89c746fe97ce25">SymmetryFunction::ST_SCALE</a>;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Scaling type::ST_SCALE (%d)\n&quot;</span>, <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Gs = Smin + (Smax - Smin) * (G - Gmin) / (Gmax - Gmin)\n&quot;</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (   (!<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;scale_symmetry_functions&quot;</span> ))</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;             &amp;&amp; ( <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;center_symmetry_functions&quot;</span>)))</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> = <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a4cec917c81df7b855e6465e2b74b8e27">SymmetryFunction::ST_CENTER</a>;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Scaling type::ST_CENTER (%d)\n&quot;</span>, <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Gs = G - Gmean\n&quot;</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (   ( <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;scale_symmetry_functions&quot;</span> ))</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;             &amp;&amp; ( <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;center_symmetry_functions&quot;</span>)))</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> = <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a67720263b628f46cf0c56f895561fa5f">SymmetryFunction::ST_SCALECENTER</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Scaling type::ST_SCALECENTER (%d)\n&quot;</span>, <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Gs = Smin + (Smax - Smin) * (G - Gmean) / (Gmax - Gmin)\n&quot;</span>;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;scale_symmetry_functions_sigma&quot;</span>))</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> = <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410af66e7656f508710a6a4737e71447246c">SymmetryFunction::ST_SCALESIGMA</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Scaling type::ST_SCALESIGMA (%d)\n&quot;</span>, <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Gs = Smin + (Smax - Smin) * (G - Gmean) / Gsigma\n&quot;</span>;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> = <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410ad3072f9f35ccec9e99afc05b59592bdc">SymmetryFunction::ST_NONE</a>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Scaling type::ST_NONE (%d)\n&quot;</span>, <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Gs = G\n&quot;</span>;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: No symmetry function scaling!\n&quot;</span>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordtype">double</span> Smin = 0.0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">double</span> Smax = 0.0;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> == <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a0566f47a41cdc017fc89c746fe97ce25">SymmetryFunction::ST_SCALE</a> ||</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> == <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a67720263b628f46cf0c56f895561fa5f">SymmetryFunction::ST_SCALECENTER</a> ||</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a> == <a class="code" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410af66e7656f508710a6a4737e71447246c">SymmetryFunction::ST_SCALESIGMA</a>)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;scale_min_short&quot;</span>))</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            Smin = atof(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;scale_min_short&quot;</span>].c_str());</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Keyword \&quot;scale_min_short\&quot; not found.\n&quot;</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;         Default value for Smin = 0.0.\n&quot;</span>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            Smin = 0.0;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;scale_max_short&quot;</span>))</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            Smax = atof(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;scale_max_short&quot;</span>].c_str());</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        {</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Keyword \&quot;scale_max_short\&quot; not found.\n&quot;</span>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;         Default value for Smax = 1.0.\n&quot;</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            Smax = 1.0;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        }</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Smin = %f\n&quot;</span>, Smin);</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Smax = %f\n&quot;</span>, Smax);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Symmetry function scaling statistics from file: %s\n&quot;</span>,</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                 fileName.c_str());</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    ifstream file;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    file.open(fileName.c_str());</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (!file.is_open())</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Could not open file: \&quot;&quot;</span> + fileName</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                            + <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordtype">string</span> line;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    vector&lt;string&gt; lines;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">while</span> (getline(file, line))</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">if</span> (line.at(0) != <span class="charliteral">&#39;#&#39;</span>) lines.push_back(line);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    file.close();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;Abbreviations:\n&quot;</span>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;--------------\n&quot;</span>;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;ind ..... Symmetry function index.\n&quot;</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;min ..... Minimum symmetry function value.\n&quot;</span>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;max ..... Maximum symmetry function value.\n&quot;</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;mean .... Mean symmetry function value.\n&quot;</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;sigma ... Standard deviation of symmetry function values.\n&quot;</span>;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;sf ...... Scaling factor for derivatives.\n&quot;</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;Smin .... Desired minimum scaled symmetry function value.\n&quot;</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;Smax .... Desired maximum scaled symmetry function value.\n&quot;</span>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;t ....... Scaling type.\n&quot;</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        it-&gt;setScaling(<a class="code" href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">scalingType</a>, lines, Smin, Smax);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Scaling data for symmetry functions element %2s :\n&quot;</span>,</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                     it-&gt;getSymbol().c_str());</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot; ind       min       max      mean     sigma        sf  Smin  Smax t\n&quot;</span>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        log &lt;&lt; it-&gt;infoSymmetryFunctionScaling();</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        lines.erase(lines.begin(), lines.begin() + it-&gt;numSymmetryFunctions());</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00832_html_ab7ff5331297adab87a18dd7b0fac4e0b"><div class="ttname"><a href="a00832.html#ab7ff5331297adab87a18dd7b0fac4e0b">nnp::Mode::scalingType</a></div><div class="ttdeci">SymmetryFunction::ScalingType scalingType</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00478">Mode.h:478</a></div></div>
<div class="ttc" id="a00868_html_aeccad03c72e37304d5aa86a3f2fbb410ad3072f9f35ccec9e99afc05b59592bdc"><div class="ttname"><a href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410ad3072f9f35ccec9e99afc05b59592bdc">nnp::SymmetryFunction::ST_NONE</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00048">SymmetryFunction.h:48</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00868_html_aeccad03c72e37304d5aa86a3f2fbb410af66e7656f508710a6a4737e71447246c"><div class="ttname"><a href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410af66e7656f508710a6a4737e71447246c">nnp::SymmetryFunction::ST_SCALESIGMA</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00065">SymmetryFunction.h:65</a></div></div>
<div class="ttc" id="a00868_html_aeccad03c72e37304d5aa86a3f2fbb410a67720263b628f46cf0c56f895561fa5f"><div class="ttname"><a href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a67720263b628f46cf0c56f895561fa5f">nnp::SymmetryFunction::ST_SCALECENTER</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00061">SymmetryFunction.h:61</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_a14649c081ce9e5c31c8b152079407f1b"><div class="ttname"><a href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists</a></div><div class="ttdeci">bool keywordExists(std::string const &amp;keyword) const</div><div class="ttdoc">Check if keyword was read from the settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00115">Settings.cpp:115</a></div></div>
<div class="ttc" id="a00868_html_aeccad03c72e37304d5aa86a3f2fbb410a0566f47a41cdc017fc89c746fe97ce25"><div class="ttname"><a href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a0566f47a41cdc017fc89c746fe97ce25">nnp::SymmetryFunction::ST_SCALE</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00053">SymmetryFunction.h:53</a></div></div>
<div class="ttc" id="a00868_html_aeccad03c72e37304d5aa86a3f2fbb410a4cec917c81df7b855e6465e2b74b8e27"><div class="ttname"><a href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410a4cec917c81df7b855e6465e2b74b8e27">nnp::SymmetryFunction::ST_CENTER</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00056">SymmetryFunction.h:56</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa26222b7b9dc3fd141f6e775690b5d2b_cgraph.png" border="0" usemap="#a00832_aa26222b7b9dc3fd141f6e775690b5d2b_cgraph" alt=""/></div>
<map name="a00832_aa26222b7b9dc3fd141f6e775690b5d2b_cgraph" id="a00832_aa26222b7b9dc3fd141f6e775690b5d2b_cgraph">
<area shape="rect" id="node2" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b" title="Check if keyword was read from the settings file. " alt="" coords="255,5,465,32"/>
<area shape="rect" id="node3" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="318,56,402,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa26222b7b9dc3fd141f6e775690b5d2b_icgraph.png" border="0" usemap="#a00832_aa26222b7b9dc3fd141f6e775690b5d2b_icgraph" alt=""/></div>
<map name="a00832_aa26222b7b9dc3fd141f6e775690b5d2b_icgraph" id="a00832_aa26222b7b9dc3fd141f6e775690b5d2b_icgraph">
<area shape="rect" id="node2" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec" title="Initialize the LAMMPS interface. " alt="" coords="255,5,423,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="311,71,366,98"/>
<area shape="rect" id="node4" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a" title="nnp::Prediction::setup" alt="" coords="257,122,420,149"/>
</map>
</div>

</div>
</div>
<a id="a6f0184f87845a572cf4c3db0958a97d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f0184f87845a572cf4c3db0958a97d9">&#9670;&nbsp;</a></span>setupSymmetryFunctionGroups()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupSymmetryFunctionGroups </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up symmetry function groups. </p>
<p>Does not use any keywords. Call after <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a> and ensure that correct scaling behavior has already been set. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00534">534</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;{</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SYMMETRY FUNCTION GROUPS *****&quot;</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Abbreviations:\n&quot;</span>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;--------------\n&quot;</span>;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ind .... Symmetry function group index.\n&quot;</span>;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ec ..... Central atom element.\n&quot;</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ty ..... Symmetry function type.\n&quot;</span>;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;e1 ..... Neighbor 1 element.\n&quot;</span>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;e2 ..... Neighbor 2 element.\n&quot;</span>;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;eta .... Gaussian width eta.\n&quot;</span>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;rs ..... Shift distance of Gaussian.\n&quot;</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;la ..... Angle prefactor lambda.\n&quot;</span>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;zeta ... Angle term exponent zeta.\n&quot;</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;rc ..... Cutoff radius.\n&quot;</span>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ct ..... Cutoff type.\n&quot;</span>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ca ..... Cutoff alpha.\n&quot;</span>;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;ln ..... Line number in settings file.\n&quot;</span>;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;mi ..... Member index.\n&quot;</span>;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;sfi .... Symmetry function index.\n&quot;</span>;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;e ...... Recalculate exponential term.\n&quot;</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        it-&gt;setupSymmetryFunctionGroups();</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Short range atomic symmetry function groups &quot;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                     <span class="stringliteral">&quot;element %2s :\n&quot;</span>, it-&gt;getSymbol().c_str());</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot; ind ec ty e1 e2       eta        rs la &quot;</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;               <span class="stringliteral">&quot;zeta        rc ct   ca    ln   mi  sfi e\n&quot;</span>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        log &lt;&lt; it-&gt;infoSymmetryFunctionGroups();</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a6f0184f87845a572cf4c3db0958a97d9_cgraph.png" border="0" usemap="#a00832_a6f0184f87845a572cf4c3db0958a97d9_cgraph" alt=""/></div>
<map name="a00832_a6f0184f87845a572cf4c3db0958a97d9_cgraph" id="a00832_a6f0184f87845a572cf4c3db0958a97d9_cgraph">
<area shape="rect" id="node2" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="255,13,339,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a6f0184f87845a572cf4c3db0958a97d9_icgraph.png" border="0" usemap="#a00832_a6f0184f87845a572cf4c3db0958a97d9_icgraph" alt=""/></div>
<map name="a00832_a6f0184f87845a572cf4c3db0958a97d9_icgraph" id="a00832_a6f0184f87845a572cf4c3db0958a97d9_icgraph">
<area shape="rect" id="node2" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="255,13,437,39"/>
</map>
</div>

</div>
</div>
<a id="af1d1548ef2d6a9bbfdc519b76b904700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1d1548ef2d6a9bbfdc519b76b904700">&#9670;&nbsp;</a></span>setupSymmetryFunctionMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupSymmetryFunctionMemory </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract required memory dimensions for symmetry function derivatives. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>If true, print all symmetry function lines.</td></tr>
  </table>
  </dd>
</dl>
<p>Call after symmetry functions have been set up and sorted. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00583">583</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00868.html#a959fa6cbf3511f4a5ef541a52d886b9e">nnp::SymmetryFunction::getIndex()</a>, <a class="el" href="a00868.html#aaaa65d4e0b6ab1f673e896d14a07a30c">nnp::SymmetryFunction::getIndexPerElement()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, <a class="el" href="a00868.html#a26722552536a0b563c58e4d276923944">nnp::SymmetryFunction::parameterLine()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;{</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SYMMETRY FUNCTION MEMORY *****&quot;</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; e : <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        e.setupSymmetryFunctionMemory();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        vector&lt;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">size_t</span>&gt; symmetryFunctionNumTable = e.getSymmetryFunctionNumTable();</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        vector&lt;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        vector&lt;size_t&gt;&gt; symmetryFunctionTable = e.getSymmetryFunctionTable();</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Symmetry function derivatives memory table &quot;</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                     <span class="stringliteral">&quot;for element %2s :\n&quot;</span>, e.getSymbol().c_str());</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;Relevant symmetry functions for neighbors with element:\n&quot;</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;- %2s: %4zu of %4zu (%5.1f %)\n&quot;</span>,</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                         <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[i].c_str(),</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                         symmetryFunctionNumTable.at(i),</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                         e.numSymmetryFunctions(),</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                         (100.0 * symmetryFunctionNumTable.at(i))</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                         / e.numSymmetryFunctions());</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                       <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> isf : symmetryFunctionTable.at(i))</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    <a class="code" href="a00868.html">SymmetryFunction</a> <span class="keyword">const</span>&amp; sf = e.getSymmetryFunction(isf);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                    log &lt;&lt; sf.<a class="code" href="a00868.html#a26722552536a0b563c58e4d276923944">parameterLine</a>();</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                       <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; e : elements)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%2s - symmetry function per-element index table:\n&quot;</span>,</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                         e.getSymbol().c_str());</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                   <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            log &lt;&lt; <span class="stringliteral">&quot; ind&quot;</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %4s&quot;</span>, <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[i].c_str());</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            log &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                   <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; e.numSymmetryFunctions(); ++i)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <a class="code" href="a00868.html">SymmetryFunction</a> <span class="keyword">const</span>&amp; sf = e.getSymmetryFunction(i);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;%4zu&quot;</span>, sf.<a class="code" href="a00868.html#a959fa6cbf3511f4a5ef541a52d886b9e">getIndex</a>() + 1);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                vector&lt;size_t&gt; indexPerElement = sf.<a class="code" href="a00868.html#aaaa65d4e0b6ab1f673e896d14a07a30c">getIndexPerElement</a>();</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> ipe : sf.<a class="code" href="a00868.html#aaaa65d4e0b6ab1f673e896d14a07a30c">getIndexPerElement</a>())</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="keywordflow">if</span> (ipe == numeric_limits&lt;size_t&gt;::max())</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;     &quot;</span>);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        log &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot; %4zu&quot;</span>, ipe + 1);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                    }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                log &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            }</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            log &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                   <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    log &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00868_html"><div class="ttname"><a href="a00868.html">nnp::SymmetryFunction</a></div><div class="ttdoc">Symmetry function base class. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00040">SymmetryFunction.h:40</a></div></div>
<div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00868_html_a959fa6cbf3511f4a5ef541a52d886b9e"><div class="ttname"><a href="a00868.html#a959fa6cbf3511f4a5ef541a52d886b9e">nnp::SymmetryFunction::getIndex</a></div><div class="ttdeci">std::size_t getIndex() const</div><div class="ttdoc">Get private index member variable. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00342">SymmetryFunction.h:342</a></div></div>
<div class="ttc" id="a00832_html_a12a8249ac3aab222922c42781c344779"><div class="ttname"><a href="a00832.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Global element map, populated by setupElementMap(). </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00462">Mode.h:462</a></div></div>
<div class="ttc" id="a00868_html_aaaa65d4e0b6ab1f673e896d14a07a30c"><div class="ttname"><a href="a00868.html#aaaa65d4e0b6ab1f673e896d14a07a30c">nnp::SymmetryFunction::getIndexPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; getIndexPerElement() const</div><div class="ttdoc">Get private indexPerElement member variable. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00409">SymmetryFunction.h:409</a></div></div>
<div class="ttc" id="a00868_html_a26722552536a0b563c58e4d276923944"><div class="ttname"><a href="a00868.html#a26722552536a0b563c58e4d276923944">nnp::SymmetryFunction::parameterLine</a></div><div class="ttdeci">virtual std::string parameterLine() const =0</div><div class="ttdoc">Give symmetry function parameters in one line. </div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_af1d1548ef2d6a9bbfdc519b76b904700_cgraph.png" border="0" usemap="#a00832_af1d1548ef2d6a9bbfdc519b76b904700_cgraph" alt=""/></div>
<map name="a00832_af1d1548ef2d6a9bbfdc519b76b904700_cgraph" id="a00832_af1d1548ef2d6a9bbfdc519b76b904700_cgraph">
<area shape="rect" id="node2" href="a00868.html#a959fa6cbf3511f4a5ef541a52d886b9e" title="Get private index member variable. " alt="" coords="255,5,431,47"/>
<area shape="rect" id="node3" href="a00868.html#aaaa65d4e0b6ab1f673e896d14a07a30c" title="Get private indexPerElement member variable. " alt="" coords="255,71,431,112"/>
<area shape="rect" id="node4" href="a00868.html#a26722552536a0b563c58e4d276923944" title="Give symmetry function parameters in one line. " alt="" coords="255,136,431,177"/>
<area shape="rect" id="node5" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="301,202,385,229"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_af1d1548ef2d6a9bbfdc519b76b904700_icgraph.png" border="0" usemap="#a00832_af1d1548ef2d6a9bbfdc519b76b904700_icgraph" alt=""/></div>
<map name="a00832_af1d1548ef2d6a9bbfdc519b76b904700_icgraph" id="a00832_af1d1548ef2d6a9bbfdc519b76b904700_icgraph">
<area shape="rect" id="node2" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="255,13,437,39"/>
</map>
</div>

</div>
</div>
<a id="ae4b348e9b5e2ef89cb30c760bdb55153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b348e9b5e2ef89cb30c760bdb55153">&#9670;&nbsp;</a></span>setupSymmetryFunctionStatistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupSymmetryFunctionStatistics </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>collectStatistics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>collectExtrapolationWarnings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>writeExtrapolationWarnings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>stopOnExtrapolationWarnings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up symmetry function statistics collection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">collectStatistics</td><td>Whether statistics (min, max, mean, sigma) is collected. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">collectExtrapolationWarnings</td><td>Whether extrapolation warnings are logged. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">writeExtrapolationWarnings</td><td>Write extrapolation warnings immediately when they occur. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stopOnExtrapolationWarnings</td><td>Throw error immediately when an extrapolation warning occurs.</td></tr>
  </table>
  </dd>
</dl>
<p>Does not use any keywords. Calling this setup function is not required, by default no statistics collection is enabled (all arguments <code>false</code>). Call after <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec" title="Set up all Element instances. ">setupElements()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00672">672</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a">nnp::Prediction::setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;{</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: SYMMETRY FUNCTION STATISTICS *&quot;</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;Equal symmetry function statistics for all elements.\n&quot;</span>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Collect min/max/mean/sigma                        : %d\n&quot;</span>,</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                 (<span class="keywordtype">int</span>)collectStatistics);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Collect extrapolation warnings                    : %d\n&quot;</span>,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                 (<span class="keywordtype">int</span>)collectExtrapolationWarnings);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Write extrapolation warnings immediately to stderr: %d\n&quot;</span>,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                 (<span class="keywordtype">int</span>)writeExtrapolationWarnings);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Halt on any extrapolation warning                 : %d\n&quot;</span>,</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                 (<span class="keywordtype">int</span>)stopOnExtrapolationWarnings);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        it-&gt;statistics.collectStatistics = collectStatistics;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        it-&gt;statistics.collectExtrapolationWarnings =</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                                  collectExtrapolationWarnings;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        it-&gt;statistics.writeExtrapolationWarnings = writeExtrapolationWarnings;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        it-&gt;statistics.stopOnExtrapolationWarnings =</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                                   stopOnExtrapolationWarnings;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a> = collectStatistics</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                              || collectExtrapolationWarnings</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                              || writeExtrapolationWarnings</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                              || stopOnExtrapolationWarnings;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_a03ee0e33408435b18a79a253e967856a"><div class="ttname"><a href="a00832.html#a03ee0e33408435b18a79a253e967856a">nnp::Mode::checkExtrapolationWarnings</a></div><div class="ttdeci">bool checkExtrapolationWarnings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00468">Mode.h:468</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae4b348e9b5e2ef89cb30c760bdb55153_cgraph.png" border="0" usemap="#a00832_ae4b348e9b5e2ef89cb30c760bdb55153_cgraph" alt=""/></div>
<map name="a00832_ae4b348e9b5e2ef89cb30c760bdb55153_cgraph" id="a00832_ae4b348e9b5e2ef89cb30c760bdb55153_cgraph">
<area shape="rect" id="node2" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="255,13,339,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae4b348e9b5e2ef89cb30c760bdb55153_icgraph.png" border="0" usemap="#a00832_ae4b348e9b5e2ef89cb30c760bdb55153_icgraph" alt=""/></div>
<map name="a00832_ae4b348e9b5e2ef89cb30c760bdb55153_icgraph" id="a00832_ae4b348e9b5e2ef89cb30c760bdb55153_icgraph">
<area shape="rect" id="node2" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec" title="Initialize the LAMMPS interface. " alt="" coords="255,5,423,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="311,71,366,98"/>
<area shape="rect" id="node4" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a" title="nnp::Prediction::setup" alt="" coords="257,122,420,149"/>
</map>
</div>

</div>
</div>
<a id="a3488a7fb2b0ccf17a9b2af514590f57c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3488a7fb2b0ccf17a9b2af514590f57c">&#9670;&nbsp;</a></span>setupNeuralNetwork()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupNeuralNetwork </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up neural networks for all elements. </p>
<p>Uses keywords <code>global_hidden_layers_short</code>, <code>global_nodes_short</code>, <code>global_activation_short</code>, <code>normalize_nodes</code>. Call after <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a>, only then the number of input layer neurons is known. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00712">712</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda2721d2639f95e923ac6fafd0980a2588">nnp::NeuralNetwork::AF_COS</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedad56bdaa89dd2aa1d72d539995267a967">nnp::NeuralNetwork::AF_EXP</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda66545b5c028ebb8934093188e3279492">nnp::NeuralNetwork::AF_GAUSSIAN</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedaf565187036a46ee35d905df14542dc01">nnp::NeuralNetwork::AF_HARMONIC</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04">nnp::NeuralNetwork::AF_IDENTITY</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5915a5141aaee3c8fd8ea61da99b3b41">nnp::NeuralNetwork::AF_LOGISTIC</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedafe93c3a968224442e85a58ba3627e3a9">nnp::NeuralNetwork::AF_RELU</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedaf1b2dce761bdf00c9ff8d6ebd1374578">nnp::NeuralNetwork::AF_REVLOGISTIC</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda85811bbf7c259d1fee628b2a69114530">nnp::NeuralNetwork::AF_SOFTPLUS</a>, <a class="el" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda1569427fccd98a9f3e8ec25d334b982b">nnp::NeuralNetwork::AF_TANH</a>, <a class="el" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00820.html#aa1813b575aa3fa99f500a7cccbf90633">nnp::Element::getSymbol()</a>, <a class="el" href="a00852.html#a8b0d951c5548f17e64598900b5aca088">nnp::Settings::getValues()</a>, <a class="el" href="a00836.html#aee07252d0a6b47e550117120470845f3">nnp::NeuralNetwork::info()</a>, <a class="el" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists()</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">nnp::Element::neuralNetwork</a>, <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>, <a class="el" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">nnp::Element::numSymmetryFunctions()</a>, <a class="el" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce()</a>, <a class="el" href="a00836.html#aa3970c1a57ef211ce23e5dfd85619e93">nnp::NeuralNetwork::setNormalizeNeurons()</a>, <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, <a class="el" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f">setupGeneric()</a>.</p>
<div class="fragment"><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;{</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: NEURAL NETWORKS **************&quot;</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keyword">struct </span>NeuralNetworkTopology</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordtype">int</span>                                       numLayers = 0;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        vector&lt;int&gt;                               numNeuronsPerLayer;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        vector&lt;NeuralNetwork::ActivationFunction&gt; activationFunctionsPerLayer;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    };</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    vector&lt;NeuralNetworkTopology&gt; nnt(<a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordtype">size_t</span> globalNumHiddenLayers =</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        (size_t)atoi(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;global_hidden_layers_short&quot;</span>].c_str());</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    vector&lt;string&gt; globalNumNeuronsPerHiddenLayer =</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">reduce</a>(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;global_nodes_short&quot;</span>]));</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    vector&lt;string&gt; globalActivationFunctions =</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">reduce</a>(<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>[<span class="stringliteral">&quot;global_activation_short&quot;</span>]));</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        NeuralNetworkTopology&amp; t = nnt.at(i);</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        t.numLayers = 2 + globalNumHiddenLayers;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        t.numNeuronsPerLayer.resize(t.numLayers, 0);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        t.activationFunctionsPerLayer.resize(t.numLayers,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                             <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04">NeuralNetwork::AF_IDENTITY</a>);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; t.numLayers; i++)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        {</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            NeuralNetwork::</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            ActivationFunction&amp; a = t.activationFunctionsPerLayer[i];</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">if</span> (i == 0)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                t.numNeuronsPerLayer[i] = 0;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04">NeuralNetwork::AF_IDENTITY</a>;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == t.numLayers - 1)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                t.numNeuronsPerLayer[i] = 1;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04">NeuralNetwork::AF_IDENTITY</a>;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                t.numNeuronsPerLayer[i] =</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                    atoi(globalNumNeuronsPerHiddenLayer.at(i-1).c_str());</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;l&quot;</span>)</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                {</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04">NeuralNetwork::AF_IDENTITY</a>;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;t&quot;</span>)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda1569427fccd98a9f3e8ec25d334b982b">NeuralNetwork::AF_TANH</a>;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                }</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;s&quot;</span>)</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5915a5141aaee3c8fd8ea61da99b3b41">NeuralNetwork::AF_LOGISTIC</a>;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                }</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;p&quot;</span>)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda85811bbf7c259d1fee628b2a69114530">NeuralNetwork::AF_SOFTPLUS</a>;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;r&quot;</span>)</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                {</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedafe93c3a968224442e85a58ba3627e3a9">NeuralNetwork::AF_RELU</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;g&quot;</span>)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda66545b5c028ebb8934093188e3279492">NeuralNetwork::AF_GAUSSIAN</a>;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;c&quot;</span>)</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda2721d2639f95e923ac6fafd0980a2588">NeuralNetwork::AF_COS</a>;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;S&quot;</span>)</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                {</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedaf1b2dce761bdf00c9ff8d6ebd1374578">NeuralNetwork::AF_REVLOGISTIC</a>;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;e&quot;</span>)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedad56bdaa89dd2aa1d72d539995267a967">NeuralNetwork::AF_EXP</a>;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                }</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (globalActivationFunctions.at(i-1) == <span class="stringliteral">&quot;h&quot;</span>)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    a = <a class="code" href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedaf565187036a46ee35d905df14542dc01">NeuralNetwork::AF_HARMONIC</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Unknown activation &quot;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                        <span class="stringliteral">&quot;function.\n&quot;</span>);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            }</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;element_nodes_short&quot;</span>))</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    {</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="a00852.html#ac0f72e3b3484f4d411eb4a5d36e3d959">Settings::KeyRange</a> r = <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a8b0d951c5548f17e64598900b5aca088">getValues</a>(<span class="stringliteral">&quot;element_nodes_short&quot;</span>);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordflow">for</span> (Settings::KeyMap::const_iterator it = r.first;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;             it != r.second; ++it)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            vector&lt;string&gt; args = <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">reduce</a>(it-&gt;second.first));</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="keywordtype">size_t</span> e = <a class="code" href="a00832.html#a12a8249ac3aab222922c42781c344779">elementMap</a>[args.at(0)];</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordtype">size_t</span> l = atoi(args.at(1).c_str());</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            nnt.at(e).numNeuronsPerLayer.at(l) =</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                (size_t)atoi(args.at(2).c_str());</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        }</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordtype">bool</span> normalizeNeurons = <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(<span class="stringliteral">&quot;normalize_nodes&quot;</span>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Normalize neurons (all elements): %d\n&quot;</span>,</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                 (<span class="keywordtype">int</span>)normalizeNeurons);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;           <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <a class="code" href="a00820.html">Element</a>&amp; e = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i);</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        NeuralNetworkTopology&amp; t = nnt.at(i);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        t.numNeuronsPerLayer[0] = e.<a class="code" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">numSymmetryFunctions</a>();</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a> = <span class="keyword">new</span> <a class="code" href="a00836.html">NeuralNetwork</a>(</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                         t.numLayers,</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                         t.numNeuronsPerLayer.data(),</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                         t.activationFunctionsPerLayer.data());</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a>-&gt;<a class="code" href="a00836.html#aa3970c1a57ef211ce23e5dfd85619e93">setNormalizeNeurons</a>(normalizeNeurons);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Atomic short range NN for &quot;</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                     <span class="stringliteral">&quot;element %2s :\n&quot;</span>, e.<a class="code" href="a00820.html#aa1813b575aa3fa99f500a7cccbf90633">getSymbol</a>().c_str());</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a>-&gt;<a class="code" href="a00836.html#aee07252d0a6b47e550117120470845f3">info</a>();</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;-----------------------------------------&quot;</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;               <span class="stringliteral">&quot;--------------------------------------\n&quot;</span>;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbeda2721d2639f95e923ac6fafd0980a2588"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda2721d2639f95e923ac6fafd0980a2588">nnp::NeuralNetwork::AF_COS</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00047">NeuralNetwork.h:47</a></div></div>
<div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbeda85811bbf7c259d1fee628b2a69114530"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda85811bbf7c259d1fee628b2a69114530">nnp::NeuralNetwork::AF_SOFTPLUS</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00041">NeuralNetwork.h:41</a></div></div>
<div class="ttc" id="a00852_html_ac0f72e3b3484f4d411eb4a5d36e3d959"><div class="ttname"><a href="a00852.html#ac0f72e3b3484f4d411eb4a5d36e3d959">nnp::Settings::KeyRange</a></div><div class="ttdeci">std::pair&lt; KeyMap::const_iterator, KeyMap::const_iterator &gt; KeyRange</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00036">Settings.h:36</a></div></div>
<div class="ttc" id="a00258_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00032">utility.cpp:32</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbedad56bdaa89dd2aa1d72d539995267a967"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedad56bdaa89dd2aa1d72d539995267a967">nnp::NeuralNetwork::AF_EXP</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00051">NeuralNetwork.h:51</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbedaf565187036a46ee35d905df14542dc01"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedaf565187036a46ee35d905df14542dc01">nnp::NeuralNetwork::AF_HARMONIC</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00053">NeuralNetwork.h:53</a></div></div>
<div class="ttc" id="a00820_html_ab72768a2e5659bcff9dfbb8cea05fe33"><div class="ttname"><a href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">nnp::Element::neuralNetwork</a></div><div class="ttdeci">NeuralNetwork * neuralNetwork</div><div class="ttdoc">Neural network pointer for this element. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00194">Element.h:194</a></div></div>
<div class="ttc" id="a00836_html_aee07252d0a6b47e550117120470845f3"><div class="ttname"><a href="a00836.html#aee07252d0a6b47e550117120470845f3">nnp::NeuralNetwork::info</a></div><div class="ttdeci">std::vector&lt; std::string &gt; info() const</div><div class="ttdoc">Print neural network architecture. </div><div class="ttdef"><b>Definition:</b> <a href="a00086_source.html#l00981">NeuralNetwork.cpp:981</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00820_html_af1b22fc60cd3e9d71e91ec2448f4c4d1"><div class="ttname"><a href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">nnp::Element::numSymmetryFunctions</a></div><div class="ttdeci">std::size_t numSymmetryFunctions() const</div><div class="ttdoc">Get number of symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00268">Element.h:268</a></div></div>
<div class="ttc" id="a00258_html_a90ee48c5fb70d20abeebe648dc07dba7"><div class="ttname"><a href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00059">utility.cpp:59</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbedaf1b2dce761bdf00c9ff8d6ebd1374578"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedaf1b2dce761bdf00c9ff8d6ebd1374578">nnp::NeuralNetwork::AF_REVLOGISTIC</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00049">NeuralNetwork.h:49</a></div></div>
<div class="ttc" id="a00852_html_a8b0d951c5548f17e64598900b5aca088"><div class="ttname"><a href="a00852.html#a8b0d951c5548f17e64598900b5aca088">nnp::Settings::getValues</a></div><div class="ttdeci">KeyRange getValues(std::string const &amp;keyword) const</div><div class="ttdoc">Get all keyword-value pairs for given keyword. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00131">Settings.cpp:131</a></div></div>
<div class="ttc" id="a00820_html_aa1813b575aa3fa99f500a7cccbf90633"><div class="ttname"><a href="a00820.html#aa1813b575aa3fa99f500a7cccbf90633">nnp::Element::getSymbol</a></div><div class="ttdeci">std::string getSymbol() const</div><div class="ttdoc">Get symbol. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00245">Element.h:245</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5b0c59d80a0e661ef1f0bfc3df1f5a04">nnp::NeuralNetwork::AF_IDENTITY</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00035">NeuralNetwork.h:35</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbeda66545b5c028ebb8934093188e3279492"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda66545b5c028ebb8934093188e3279492">nnp::NeuralNetwork::AF_GAUSSIAN</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00045">NeuralNetwork.h:45</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbeda5915a5141aaee3c8fd8ea61da99b3b41"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda5915a5141aaee3c8fd8ea61da99b3b41">nnp::NeuralNetwork::AF_LOGISTIC</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00039">NeuralNetwork.h:39</a></div></div>
<div class="ttc" id="a00832_html_a12a8249ac3aab222922c42781c344779"><div class="ttname"><a href="a00832.html#a12a8249ac3aab222922c42781c344779">nnp::Mode::elementMap</a></div><div class="ttdeci">ElementMap elementMap</div><div class="ttdoc">Global element map, populated by setupElementMap(). </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00462">Mode.h:462</a></div></div>
<div class="ttc" id="a00820_html"><div class="ttname"><a href="a00820.html">nnp::Element</a></div><div class="ttdoc">Contains element-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00036">Element.h:36</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbeda1569427fccd98a9f3e8ec25d334b982b"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbeda1569427fccd98a9f3e8ec25d334b982b">nnp::NeuralNetwork::AF_TANH</a></div><div class="ttdoc"> </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00037">NeuralNetwork.h:37</a></div></div>
<div class="ttc" id="a00836_html_aa3970c1a57ef211ce23e5dfd85619e93"><div class="ttname"><a href="a00836.html#aa3970c1a57ef211ce23e5dfd85619e93">nnp::NeuralNetwork::setNormalizeNeurons</a></div><div class="ttdeci">void setNormalizeNeurons(bool normalizeNeurons)</div><div class="ttdoc">Turn on/off neuron normalization. </div><div class="ttdef"><b>Definition:</b> <a href="a00086_source.html#l00113">NeuralNetwork.cpp:113</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_a14649c081ce9e5c31c8b152079407f1b"><div class="ttname"><a href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists</a></div><div class="ttdeci">bool keywordExists(std::string const &amp;keyword) const</div><div class="ttdoc">Check if keyword was read from the settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00115">Settings.cpp:115</a></div></div>
<div class="ttc" id="a00836_html_a032b3b525f06cd70953aec8e6aeedbedafe93c3a968224442e85a58ba3627e3a9"><div class="ttname"><a href="a00836.html#a032b3b525f06cd70953aec8e6aeedbedafe93c3a968224442e85a58ba3627e3a9">nnp::NeuralNetwork::AF_RELU</a></div><div class="ttdoc"> (NOT recommended for HDNNPs!) </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00043">NeuralNetwork.h:43</a></div></div>
<div class="ttc" id="a00836_html"><div class="ttname"><a href="a00836.html">nnp::NeuralNetwork</a></div><div class="ttdoc">This class implements a feed-forward neural network. </div><div class="ttdef"><b>Definition:</b> <a href="a00089_source.html#l00028">NeuralNetwork.h:28</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a3488a7fb2b0ccf17a9b2af514590f57c_cgraph.png" border="0" usemap="#a00832_a3488a7fb2b0ccf17a9b2af514590f57c_cgraph" alt=""/></div>
<map name="a00832_a3488a7fb2b0ccf17a9b2af514590f57c_cgraph" id="a00832_a3488a7fb2b0ccf17a9b2af514590f57c_cgraph">
<area shape="rect" id="node2" href="a00820.html#aa1813b575aa3fa99f500a7cccbf90633" title="Get symbol. " alt="" coords="297,5,484,32"/>
<area shape="rect" id="node3" href="a00852.html#a8b0d951c5548f17e64598900b5aca088" title="Get all keyword&#45;value pairs for given keyword. " alt="" coords="301,56,480,83"/>
<area shape="rect" id="node4" href="a00836.html#aee07252d0a6b47e550117120470845f3" title="Print neural network architecture. " alt="" coords="315,107,467,149"/>
<area shape="rect" id="node5" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="545,144,629,171"/>
<area shape="rect" id="node6" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b" title="Check if keyword was read from the settings file. " alt="" coords="285,224,496,251"/>
<area shape="rect" id="node7" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1" title="Get number of symmetry functions. " alt="" coords="284,275,497,317"/>
<area shape="rect" id="node8" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7" title="Replace multiple whitespaces with fill. " alt="" coords="341,341,440,368"/>
<area shape="rect" id="node9" href="a00836.html#aa3970c1a57ef211ce23e5dfd85619e93" title="Turn on/off neuron normalization. " alt="" coords="305,393,476,434"/>
<area shape="rect" id="node10" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter. " alt="" coords="349,459,432,485"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a3488a7fb2b0ccf17a9b2af514590f57c_icgraph.png" border="0" usemap="#a00832_a3488a7fb2b0ccf17a9b2af514590f57c_icgraph" alt=""/></div>
<map name="a00832_a3488a7fb2b0ccf17a9b2af514590f57c_icgraph" id="a00832_a3488a7fb2b0ccf17a9b2af514590f57c_icgraph">
<area shape="rect" id="node2" href="a00832.html#adffbed0cbae8bc9c4f4c4556ff113b5f" title="Combine multiple setup routines and provide a basic NNP setup. " alt="" coords="284,5,467,32"/>
</map>
</div>

</div>
</div>
<a id="a091fea0011ed8260c93db7c38c3d1e82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a091fea0011ed8260c93db7c38c3d1e82">&#9670;&nbsp;</a></span>setupNeuralNetworkWeights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::setupNeuralNetworkWeights </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>fileNameFormat</em> = <code>&quot;weights.%03zu.data&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up neural network weights from files. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fileNameFormat</td><td>Format for weights file name. The string must contain one placeholder for the atomic number.</td></tr>
  </table>
  </dd>
</dl>
<p>Does not use any keywords. The weight files should contain one weight per line, see <a class="el" href="a00836.html#a3479cb0b5dc64c4260837adbfa11f868" title="Set neural network weights and biases. ">NeuralNetwork::setConnections()</a> for the correct order. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00855">855</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce()</a>, <a class="el" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split()</a>, and <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00944.html#ab3025fc3780b67e91e063fd490640043">nnp::Training::initializeWeights()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a">nnp::Prediction::setup()</a>.</p>
<div class="fragment"><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;{</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*** SETUP: NEURAL NETWORK WEIGHTS *******&quot;</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Weight file name format: %s\n&quot;</span>, fileNameFormat.c_str());</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <span class="keywordtype">string</span> fileName = <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(fileNameFormat.c_str(), it-&gt;getAtomicNumber());</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;Weight file for element %2s: %s\n&quot;</span>,</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                     it-&gt;getSymbol().c_str(),</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                     fileName.c_str());</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        ifstream file;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        file.open(fileName.c_str());</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (!file.is_open())</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordflow">throw</span> runtime_error(<span class="stringliteral">&quot;ERROR: Could not open file: \&quot;&quot;</span> + fileName</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                                + <span class="stringliteral">&quot;\&quot;.\n&quot;</span>);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordtype">string</span> line;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        vector&lt;double&gt; weights;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">while</span> (getline(file, line))</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        {</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            <span class="keywordflow">if</span> (line.at(0) != <span class="charliteral">&#39;#&#39;</span>)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                vector&lt;string&gt; splitLine = <a class="code" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">split</a>(<a class="code" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">reduce</a>(line));</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                weights.push_back(atof(splitLine.at(0).c_str()));</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        it-&gt;neuralNetwork-&gt;setConnections(&amp;(weights.front()));</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        file.close();</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <span class="stringliteral">&quot;*****************************************&quot;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;           <span class="stringliteral">&quot;**************************************\n&quot;</span>;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00258_html_a6ecc8126eac4f4c52283f9f776986aa0"><div class="ttname"><a href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0">nnp::split</a></div><div class="ttdeci">vector&lt; string &gt; split(string const &amp;input, char delimiter)</div><div class="ttdoc">Split string at each delimiter. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00032">utility.cpp:32</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00258_html_a90ee48c5fb70d20abeebe648dc07dba7"><div class="ttname"><a href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7">nnp::reduce</a></div><div class="ttdeci">string reduce(string const &amp;line, string const &amp;whitespace, string const &amp;fill)</div><div class="ttdoc">Replace multiple whitespaces with fill. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00059">utility.cpp:59</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a091fea0011ed8260c93db7c38c3d1e82_cgraph.png" border="0" usemap="#a00832_a091fea0011ed8260c93db7c38c3d1e82_cgraph" alt=""/></div>
<map name="a00832_a091fea0011ed8260c93db7c38c3d1e82_cgraph" id="a00832_a091fea0011ed8260c93db7c38c3d1e82_cgraph">
<area shape="rect" id="node2" href="a00258.html#a90ee48c5fb70d20abeebe648dc07dba7" title="Replace multiple whitespaces with fill. " alt="" coords="284,5,383,32"/>
<area shape="rect" id="node3" href="a00258.html#a6ecc8126eac4f4c52283f9f776986aa0" title="Split string at each delimiter. " alt="" coords="292,56,375,83"/>
<area shape="rect" id="node4" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="291,107,375,133"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a091fea0011ed8260c93db7c38c3d1e82_icgraph.png" border="0" usemap="#a00832_a091fea0011ed8260c93db7c38c3d1e82_icgraph" alt=""/></div>
<map name="a00832_a091fea0011ed8260c93db7c38c3d1e82_icgraph" id="a00832_a091fea0011ed8260c93db7c38c3d1e82_icgraph">
<area shape="rect" id="node2" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec" title="Initialize the LAMMPS interface. " alt="" coords="285,5,453,47"/>
<area shape="rect" id="node3" href="a00944.html#ab3025fc3780b67e91e063fd490640043" title="Initialize weights for all elements. " alt="" coords="284,71,453,112"/>
<area shape="rect" id="node4" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="341,137,396,163"/>
<area shape="rect" id="node5" href="a00848.html#ae3aa29d34a5d2cb6659e2038623dc93a" title="nnp::Prediction::setup" alt="" coords="287,187,450,214"/>
</map>
</div>

</div>
</div>
<a id="add11e3c30eb86aba38d8239d1e5d8736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add11e3c30eb86aba38d8239d1e5d8736">&#9670;&nbsp;</a></span>calculateSymmetryFunctions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::calculateSymmetryFunctions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>derivatives</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate all symmetry functions for all atoms in given structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derivatives</td><td>If <code>true</code> calculate also derivatives of symmetry functions.</td></tr>
  </table>
  </dd>
</dl>
<p>This function should be replaced by <a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955" title="Calculate all symmetry function groups for all atoms in given structure. ">calculateSymmetryFunctionGroups()</a> whenever possible. Results are stored in <a class="el" href="a00808.html#abc64f09e49aabb8112004f5af6983102" title="Symmetry function values. ">Atom::G</a>. If derivatives are calculated, additional results are stored in <a class="el" href="a00808.html#a482ea8be24723a1a05012e4d405a60db" title="Derivative of symmetry functions with respect to this atom&#39;s coordinates. ">Atom::dGdr</a> and <a class="el" href="a00812.html#ace4770399203773624ab9c7db8db66d5" title="Derivatives of symmetry functions with respect to neighbor coordinates. ">Atom::Neighbor::dGdr</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00897">897</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299">nnp::Atom::allocate()</a>, <a class="el" href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="a00820.html#a0196402cabb3d6effd4ab154d53f91bf">nnp::Element::calculateSymmetryFunctions()</a>, <a class="el" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a>, <a class="el" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">nnp::Element::getIndex()</a>, <a class="el" href="a00808.html#af1688532887675a8f0dd944768589fff">nnp::Atom::getNumNeighbors()</a>, <a class="el" href="a00820.html#af610c8dced27214120a57c24098ba0ac">nnp::Element::getSymmetryFunctionNumTable()</a>, <a class="el" href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">nnp::Structure::hasSymmetryFunctionDerivatives</a>, <a class="el" href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">nnp::Atom::hasSymmetryFunctionDerivatives</a>, <a class="el" href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">nnp::Structure::hasSymmetryFunctions</a>, <a class="el" href="a00808.html#a8b6403674a98b82e02508193fa86f196">nnp::Atom::hasSymmetryFunctions</a>, <a class="el" href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a>, <a class="el" href="a00808.html#a708047feeff8f20e48b6a3d476ddb643">nnp::Atom::indexStructure</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>, <a class="el" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>, <a class="el" href="a00808.html#a318eadf8f83a00480174a168020f7e84">nnp::Atom::numSymmetryFunctionDerivatives</a>, <a class="el" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a>, <a class="el" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">nnp::Element::numSymmetryFunctions()</a>, <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486">nnp::Element::updateSymmetryFunctionStatistics()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00944.html#ae22bf5b246022c4f52f45bcc98d7c4be">nnp::Training::calculateWeightDerivatives()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, and <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;{</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="comment">// Skip calculation for whole structure if results are already saved.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (structure.<a class="code" href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    <span class="keywordflow">if</span> (structure.<a class="code" href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> &amp;&amp; !derivatives) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="a00808.html">Atom</a>* a = NULL;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="a00820.html">Element</a>* e = NULL;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">    #pragma omp parallel for private (a, e)</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    {</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="comment">// Pointer to atom.</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        a = &amp;(structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i));</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="comment">// Skip calculation for individual atom if results are already saved.</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">hasSymmetryFunctionDerivatives</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="a00808.html#a8b6403674a98b82e02508193fa86f196">hasSymmetryFunctions</a> &amp;&amp; !derivatives) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="comment">// Get element of atom and set number of symmetry functions.</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        e = &amp;(<a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(a-&gt;<a class="code" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>));</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        a-&gt;<a class="code" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">numSymmetryFunctions</a> = e-&gt;<a class="code" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">numSymmetryFunctions</a>();</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">if</span> (derivatives)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            a-&gt;<a class="code" href="a00808.html#a318eadf8f83a00480174a168020f7e84">numSymmetryFunctionDerivatives</a></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                = e-&gt;<a class="code" href="a00820.html#af610c8dced27214120a57c24098ba0ac">getSymmetryFunctionNumTable</a>();</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="preprocessor">#ifndef NONEIGHCHECK</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// Check if atom has low number of neighbors.</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordtype">size_t</span> numNeighbors = a-&gt;<a class="code" href="a00808.html#af1688532887675a8f0dd944768589fff">getNumNeighbors</a>(</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                            <a class="code" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>.at(e-&gt;<a class="code" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">getIndex</a>()));</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span> (numNeighbors &lt; <a class="code" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>.at(e-&gt;<a class="code" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">getIndex</a>()))</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;WARNING: Structure %6zu Atom %6zu : %zu &quot;</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                         <span class="stringliteral">&quot;neighbors.\n&quot;</span>,</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                         a-&gt;<a class="code" href="a00808.html#a708047feeff8f20e48b6a3d476ddb643">indexStructure</a>,</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                         a-&gt;<a class="code" href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">index</a>,</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                         numNeighbors);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="comment">// Allocate symmetry function data vectors in atom.</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        a-&gt;<a class="code" href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299">allocate</a>(derivatives);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">// Calculate symmetry functions (and derivatives).</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        e-&gt;<a class="code" href="a00820.html#a0196402cabb3d6effd4ab154d53f91bf">calculateSymmetryFunctions</a>(*a, derivatives);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="comment">// Remember that symmetry functions of this atom have been calculated.</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        a-&gt;<a class="code" href="a00808.html#a8b6403674a98b82e02508193fa86f196">hasSymmetryFunctions</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="keywordflow">if</span> (derivatives) a-&gt;<a class="code" href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">hasSymmetryFunctionDerivatives</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// If requested, check extrapolation warnings or update statistics.</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// Needed to shift this out of the loop above to make it thread-safe.</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a>)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    {</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            a = &amp;(structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i));</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            e = &amp;(<a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(a-&gt;<a class="code" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>));</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            e-&gt;<a class="code" href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486">updateSymmetryFunctionStatistics</a>(*a);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// Remember that symmetry functions of this structure have been calculated.</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    structure.<a class="code" href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">if</span> (derivatives) structure.<a class="code" href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00864_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00093">Structure.h:93</a></div></div>
<div class="ttc" id="a00832_html_a16cf1320e7b8e3ff52802dff5b114fae"><div class="ttname"><a href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">nnp::Mode::minCutoffRadius</a></div><div class="ttdeci">std::vector&lt; double &gt; minCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00471">Mode.h:471</a></div></div>
<div class="ttc" id="a00808_html_a0b2e4de557a8b4f97936fcd4bab7a564"><div class="ttname"><a href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a></div><div class="ttdeci">std::size_t numSymmetryFunctions</div><div class="ttdoc">Number of symmetry functions used to describe the atom environment. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00113">Atom.h:113</a></div></div>
<div class="ttc" id="a00832_html_abbb183f90ace9311391b9847580009ba"><div class="ttname"><a href="a00832.html#abbb183f90ace9311391b9847580009ba">nnp::Mode::minNeighbors</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; minNeighbors</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00470">Mode.h:470</a></div></div>
<div class="ttc" id="a00808_html_a318eadf8f83a00480174a168020f7e84"><div class="ttname"><a href="a00808.html#a318eadf8f83a00480174a168020f7e84">nnp::Atom::numSymmetryFunctionDerivatives</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numSymmetryFunctionDerivatives</div><div class="ttdoc">Number of neighbor atom symmetry function derivatives per element. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00129">Atom.h:129</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00808_html_a2e45492f424bf0af6841ce9a9033d11e"><div class="ttname"><a href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a></div><div class="ttdeci">std::size_t index</div><div class="ttdoc">Index number of this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00101">Atom.h:101</a></div></div>
<div class="ttc" id="a00820_html_af610c8dced27214120a57c24098ba0ac"><div class="ttname"><a href="a00820.html#af610c8dced27214120a57c24098ba0ac">nnp::Element::getSymmetryFunctionNumTable</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; const  &amp; getSymmetryFunctionNumTable() const</div><div class="ttdoc">Get number of relevant symmetry functions per element. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00251">Element.h:251</a></div></div>
<div class="ttc" id="a00820_html_af1b22fc60cd3e9d71e91ec2448f4c4d1"><div class="ttname"><a href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">nnp::Element::numSymmetryFunctions</a></div><div class="ttdeci">std::size_t numSymmetryFunctions() const</div><div class="ttdoc">Get number of symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00268">Element.h:268</a></div></div>
<div class="ttc" id="a00820_html_a5fbd74ba2c16338eacd4bb519cf0b975"><div class="ttname"><a href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">nnp::Element::getIndex</a></div><div class="ttdeci">std::size_t getIndex() const</div><div class="ttdoc">Get index. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00230">Element.h:230</a></div></div>
<div class="ttc" id="a00864_html_a82f10399909e0f7fa8f6344c305781cc"><div class="ttname"><a href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">nnp::Structure::hasSymmetryFunctionDerivatives</a></div><div class="ttdeci">bool hasSymmetryFunctionDerivatives</div><div class="ttdoc">If symmetry function derivatives are saved for each atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00063">Structure.h:63</a></div></div>
<div class="ttc" id="a00808_html_a708047feeff8f20e48b6a3d476ddb643"><div class="ttname"><a href="a00808.html#a708047feeff8f20e48b6a3d476ddb643">nnp::Atom::indexStructure</a></div><div class="ttdeci">std::size_t indexStructure</div><div class="ttdoc">Index number of structure this atom belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00103">Atom.h:103</a></div></div>
<div class="ttc" id="a00808_html_a1f3ed8b68d3c546d068024b0c949eac1"><div class="ttname"><a href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">nnp::Atom::hasSymmetryFunctionDerivatives</a></div><div class="ttdeci">bool hasSymmetryFunctionDerivatives</div><div class="ttdoc">If symmetry function derivatives are saved for this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00099">Atom.h:99</a></div></div>
<div class="ttc" id="a00820_html_a0196402cabb3d6effd4ab154d53f91bf"><div class="ttname"><a href="a00820.html#a0196402cabb3d6effd4ab154d53f91bf">nnp::Element::calculateSymmetryFunctions</a></div><div class="ttdeci">void calculateSymmetryFunctions(Atom &amp;atom, bool const derivatives) const</div><div class="ttdoc">Calculate symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00062_source.html#l00360">Element.cpp:360</a></div></div>
<div class="ttc" id="a00808_html_a807a4cf41842f8225d88f1848f1ef6ee"><div class="ttname"><a href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a></div><div class="ttdeci">std::size_t element</div><div class="ttdoc">Element index of this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00107">Atom.h:107</a></div></div>
<div class="ttc" id="a00820_html"><div class="ttname"><a href="a00820.html">nnp::Element</a></div><div class="ttdoc">Contains element-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00036">Element.h:36</a></div></div>
<div class="ttc" id="a00808_html_af1688532887675a8f0dd944768589fff"><div class="ttname"><a href="a00808.html#af1688532887675a8f0dd944768589fff">nnp::Atom::getNumNeighbors</a></div><div class="ttdeci">std::size_t getNumNeighbors(double cutoffRadius) const</div><div class="ttdoc">Calculate number of neighbors for a given cutoff radius. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.html#l00253">Atom.cpp:253</a></div></div>
<div class="ttc" id="a00808_html_a8b6403674a98b82e02508193fa86f196"><div class="ttname"><a href="a00808.html#a8b6403674a98b82e02508193fa86f196">nnp::Atom::hasSymmetryFunctions</a></div><div class="ttdeci">bool hasSymmetryFunctions</div><div class="ttdoc">If symmetry function values are saved for this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00097">Atom.h:97</a></div></div>
<div class="ttc" id="a00820_html_a6dc921df037ff55fa8e20a834b1bf486"><div class="ttname"><a href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486">nnp::Element::updateSymmetryFunctionStatistics</a></div><div class="ttdeci">std::size_t updateSymmetryFunctionStatistics(Atom const &amp;atom)</div><div class="ttdoc">Update symmetry function statistics. </div><div class="ttdef"><b>Definition:</b> <a href="a00062_source.html#l00386">Element.cpp:386</a></div></div>
<div class="ttc" id="a00864_html_aff934fe32fb46e93dd9551d50ed4b0b6"><div class="ttname"><a href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">nnp::Structure::hasSymmetryFunctions</a></div><div class="ttdeci">bool hasSymmetryFunctions</div><div class="ttdoc">If symmetry function values are saved for each atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00061">Structure.h:61</a></div></div>
<div class="ttc" id="a00808_html"><div class="ttname"><a href="a00808.html">nnp::Atom</a></div><div class="ttdoc">Storage for a single atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00030">Atom.h:30</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_a03ee0e33408435b18a79a253e967856a"><div class="ttname"><a href="a00832.html#a03ee0e33408435b18a79a253e967856a">nnp::Mode::checkExtrapolationWarnings</a></div><div class="ttdeci">bool checkExtrapolationWarnings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00468">Mode.h:468</a></div></div>
<div class="ttc" id="a00808_html_a2de21db9dfe00cf608d5b77e6b0f6299"><div class="ttname"><a href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299">nnp::Atom::allocate</a></div><div class="ttdeci">void allocate(bool all)</div><div class="ttdoc">Allocate vectors related to symmetry functions (G, dEdG). </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.html#l00148">Atom.cpp:148</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_add11e3c30eb86aba38d8239d1e5d8736_cgraph.png" border="0" usemap="#a00832_add11e3c30eb86aba38d8239d1e5d8736_cgraph" alt=""/></div>
<map name="a00832_add11e3c30eb86aba38d8239d1e5d8736_cgraph" id="a00832_add11e3c30eb86aba38d8239d1e5d8736_cgraph">
<area shape="rect" id="node2" href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299" title="Allocate vectors related to symmetry functions (G, dEdG). " alt="" coords="324,5,473,32"/>
<area shape="rect" id="node3" href="a00820.html#a0196402cabb3d6effd4ab154d53f91bf" title="Calculate symmetry functions. " alt="" coords="277,57,520,98"/>
<area shape="rect" id="node4" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975" title="Get index. " alt="" coords="312,123,485,149"/>
<area shape="rect" id="node5" href="a00808.html#af1688532887675a8f0dd944768589fff" title="Calculate number of neighbors for a given cutoff radius. " alt="" coords="291,173,506,200"/>
<area shape="rect" id="node6" href="a00820.html#af610c8dced27214120a57c24098ba0ac" title="Get number of relevant symmetry functions per element. " alt="" coords="296,225,501,266"/>
<area shape="rect" id="node7" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1" title="Get number of symmetry functions. " alt="" coords="292,290,505,331"/>
<area shape="rect" id="node8" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="568,385,652,412"/>
<area shape="rect" id="node9" href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486" title="Update symmetry function statistics. " alt="" coords="284,407,513,449"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_add11e3c30eb86aba38d8239d1e5d8736_icgraph.png" border="0" usemap="#a00832_add11e3c30eb86aba38d8239d1e5d8736_icgraph" alt=""/></div>
<map name="a00832_add11e3c30eb86aba38d8239d1e5d8736_icgraph" id="a00832_add11e3c30eb86aba38d8239d1e5d8736_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="277,5,449,47"/>
<area shape="rect" id="node3" href="a00944.html#ae22bf5b246022c4f52f45bcc98d7c4be" title="Calculate derivatives of energy with respect to weights. " alt="" coords="277,71,449,112"/>
<area shape="rect" id="node4" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="336,137,391,163"/>
<area shape="rect" id="node5" href="a00848.html#af86efaec86e8002a84368c7282704858" title="nnp::Prediction::predict" alt="" coords="277,187,449,214"/>
<area shape="rect" id="node6" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2" title="Calculate symmetry functions, atomic neural networks and sum of local energy contributions. " alt="" coords="279,239,447,280"/>
<area shape="rect" id="node7" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa" title="Perform one update. " alt="" coords="284,305,443,331"/>
</map>
</div>

</div>
</div>
<a id="a8aec6fb4708b93b93a9cfa0e8045f955"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aec6fb4708b93b93a9cfa0e8045f955">&#9670;&nbsp;</a></span>calculateSymmetryFunctionGroups()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::calculateSymmetryFunctionGroups </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>derivatives</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate all symmetry function groups for all atoms in given structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derivatives</td><td>If <code>true</code> calculate also derivatives of symmetry functions.</td></tr>
  </table>
  </dd>
</dl>
<p>This function replaces <a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736" title="Calculate all symmetry functions for all atoms in given structure. ">calculateSymmetryFunctions()</a> when symmetry function groups are enabled (faster, default behavior). Results are stored in <a class="el" href="a00808.html#abc64f09e49aabb8112004f5af6983102" title="Symmetry function values. ">Atom::G</a>. If derivatives are calculated, additional results are stored in <a class="el" href="a00808.html#a482ea8be24723a1a05012e4d405a60db" title="Derivative of symmetry functions with respect to this atom&#39;s coordinates. ">Atom::dGdr</a> and <a class="el" href="a00812.html#ace4770399203773624ab9c7db8db66d5" title="Derivatives of symmetry functions with respect to neighbor coordinates. ">Atom::Neighbor::dGdr</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l00971">971</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299">nnp::Atom::allocate()</a>, <a class="el" href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="a00820.html#a2224824f8ec31f118ea82508a0875067">nnp::Element::calculateSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a>, <a class="el" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">nnp::Element::getIndex()</a>, <a class="el" href="a00808.html#af1688532887675a8f0dd944768589fff">nnp::Atom::getNumNeighbors()</a>, <a class="el" href="a00820.html#af610c8dced27214120a57c24098ba0ac">nnp::Element::getSymmetryFunctionNumTable()</a>, <a class="el" href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">nnp::Structure::hasSymmetryFunctionDerivatives</a>, <a class="el" href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">nnp::Atom::hasSymmetryFunctionDerivatives</a>, <a class="el" href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">nnp::Structure::hasSymmetryFunctions</a>, <a class="el" href="a00808.html#a8b6403674a98b82e02508193fa86f196">nnp::Atom::hasSymmetryFunctions</a>, <a class="el" href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a>, <a class="el" href="a00808.html#a708047feeff8f20e48b6a3d476ddb643">nnp::Atom::indexStructure</a>, <a class="el" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a>, <a class="el" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>, <a class="el" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>, <a class="el" href="a00808.html#a318eadf8f83a00480174a168020f7e84">nnp::Atom::numSymmetryFunctionDerivatives</a>, <a class="el" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a>, <a class="el" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">nnp::Element::numSymmetryFunctions()</a>, <a class="el" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr()</a>, and <a class="el" href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486">nnp::Element::updateSymmetryFunctionStatistics()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00944.html#ae22bf5b246022c4f52f45bcc98d7c4be">nnp::Training::calculateWeightDerivatives()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, and <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>.</p>
<div class="fragment"><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;{</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="comment">// Skip calculation for whole structure if results are already saved.</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (structure.<a class="code" href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a>) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordflow">if</span> (structure.<a class="code" href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> &amp;&amp; !derivatives) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="a00808.html">Atom</a>* a = NULL;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <a class="code" href="a00820.html">Element</a>* e = NULL;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="preprocessor">    #pragma omp parallel for private (a, e)</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">// Pointer to atom.</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        a = &amp;(structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i));</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <span class="comment">// Skip calculation for individual atom if results are already saved.</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">hasSymmetryFunctionDerivatives</a>) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="a00808.html#a8b6403674a98b82e02508193fa86f196">hasSymmetryFunctions</a> &amp;&amp; !derivatives) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="comment">// Get element of atom and set number of symmetry functions.</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        e = &amp;(<a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(a-&gt;<a class="code" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>));</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        a-&gt;<a class="code" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">numSymmetryFunctions</a> = e-&gt;<a class="code" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">numSymmetryFunctions</a>();</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">if</span> (derivatives)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            a-&gt;<a class="code" href="a00808.html#a318eadf8f83a00480174a168020f7e84">numSymmetryFunctionDerivatives</a></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                = e-&gt;<a class="code" href="a00820.html#af610c8dced27214120a57c24098ba0ac">getSymmetryFunctionNumTable</a>();</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="preprocessor">#ifndef NONEIGHCHECK</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">// Check if atom has low number of neighbors.</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordtype">size_t</span> numNeighbors = a-&gt;<a class="code" href="a00808.html#af1688532887675a8f0dd944768589fff">getNumNeighbors</a>(</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                            <a class="code" href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">minCutoffRadius</a>.at(e-&gt;<a class="code" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">getIndex</a>()));</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="keywordflow">if</span> (numNeighbors &lt; <a class="code" href="a00832.html#abbb183f90ace9311391b9847580009ba">minNeighbors</a>.at(e-&gt;<a class="code" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">getIndex</a>()))</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <a class="code" href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">log</a> &lt;&lt; <a class="code" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">strpr</a>(<span class="stringliteral">&quot;WARNING: Structure %6zu Atom %6zu : %zu &quot;</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                         <span class="stringliteral">&quot;neighbors.\n&quot;</span>,</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                         a-&gt;<a class="code" href="a00808.html#a708047feeff8f20e48b6a3d476ddb643">indexStructure</a>,</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                         a-&gt;<a class="code" href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">index</a>,</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                         numNeighbors);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="comment">// Allocate symmetry function data vectors in atom.</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        a-&gt;<a class="code" href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299">allocate</a>(derivatives);</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="comment">// Calculate symmetry functions (and derivatives).</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        e-&gt;<a class="code" href="a00820.html#a2224824f8ec31f118ea82508a0875067">calculateSymmetryFunctionGroups</a>(*a, derivatives);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        <span class="comment">// Remember that symmetry functions of this atom have been calculated.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        a-&gt;<a class="code" href="a00808.html#a8b6403674a98b82e02508193fa86f196">hasSymmetryFunctions</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordflow">if</span> (derivatives) a-&gt;<a class="code" href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">hasSymmetryFunctionDerivatives</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">// If requested, check extrapolation warnings or update statistics.</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="comment">// Needed to shift this out of the loop above to make it thread-safe.</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00832.html#a03ee0e33408435b18a79a253e967856a">checkExtrapolationWarnings</a>)</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            a = &amp;(structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i));</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            e = &amp;(<a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(a-&gt;<a class="code" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>));</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            e-&gt;<a class="code" href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486">updateSymmetryFunctionStatistics</a>(*a);</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// Remember that symmetry functions of this structure have been calculated.</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    structure.<a class="code" href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">hasSymmetryFunctions</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">if</span> (derivatives) structure.<a class="code" href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">hasSymmetryFunctionDerivatives</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;}</div><div class="ttc" id="a00258_html_a398f0bcafb57e99ba1581c4b8f8a7f76"><div class="ttname"><a href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76">nnp::strpr</a></div><div class="ttdeci">string strpr(const char *format,...)</div><div class="ttdoc">String version of printf function. </div><div class="ttdef"><b>Definition:</b> <a href="a00200_source.html#l00089">utility.cpp:89</a></div></div>
<div class="ttc" id="a00820_html_a2224824f8ec31f118ea82508a0875067"><div class="ttname"><a href="a00820.html#a2224824f8ec31f118ea82508a0875067">nnp::Element::calculateSymmetryFunctionGroups</a></div><div class="ttdeci">void calculateSymmetryFunctionGroups(Atom &amp;atom, bool const derivatives) const</div><div class="ttdoc">Calculate symmetry functions via groups. </div><div class="ttdef"><b>Definition:</b> <a href="a00062_source.html#l00373">Element.cpp:373</a></div></div>
<div class="ttc" id="a00864_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00093">Structure.h:93</a></div></div>
<div class="ttc" id="a00832_html_a16cf1320e7b8e3ff52802dff5b114fae"><div class="ttname"><a href="a00832.html#a16cf1320e7b8e3ff52802dff5b114fae">nnp::Mode::minCutoffRadius</a></div><div class="ttdeci">std::vector&lt; double &gt; minCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00471">Mode.h:471</a></div></div>
<div class="ttc" id="a00808_html_a0b2e4de557a8b4f97936fcd4bab7a564"><div class="ttname"><a href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a></div><div class="ttdeci">std::size_t numSymmetryFunctions</div><div class="ttdoc">Number of symmetry functions used to describe the atom environment. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00113">Atom.h:113</a></div></div>
<div class="ttc" id="a00832_html_abbb183f90ace9311391b9847580009ba"><div class="ttname"><a href="a00832.html#abbb183f90ace9311391b9847580009ba">nnp::Mode::minNeighbors</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; minNeighbors</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00470">Mode.h:470</a></div></div>
<div class="ttc" id="a00808_html_a318eadf8f83a00480174a168020f7e84"><div class="ttname"><a href="a00808.html#a318eadf8f83a00480174a168020f7e84">nnp::Atom::numSymmetryFunctionDerivatives</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numSymmetryFunctionDerivatives</div><div class="ttdoc">Number of neighbor atom symmetry function derivatives per element. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00129">Atom.h:129</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00808_html_a2e45492f424bf0af6841ce9a9033d11e"><div class="ttname"><a href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a></div><div class="ttdeci">std::size_t index</div><div class="ttdoc">Index number of this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00101">Atom.h:101</a></div></div>
<div class="ttc" id="a00820_html_af610c8dced27214120a57c24098ba0ac"><div class="ttname"><a href="a00820.html#af610c8dced27214120a57c24098ba0ac">nnp::Element::getSymmetryFunctionNumTable</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; const  &amp; getSymmetryFunctionNumTable() const</div><div class="ttdoc">Get number of relevant symmetry functions per element. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00251">Element.h:251</a></div></div>
<div class="ttc" id="a00820_html_af1b22fc60cd3e9d71e91ec2448f4c4d1"><div class="ttname"><a href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1">nnp::Element::numSymmetryFunctions</a></div><div class="ttdeci">std::size_t numSymmetryFunctions() const</div><div class="ttdoc">Get number of symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00268">Element.h:268</a></div></div>
<div class="ttc" id="a00820_html_a5fbd74ba2c16338eacd4bb519cf0b975"><div class="ttname"><a href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975">nnp::Element::getIndex</a></div><div class="ttdeci">std::size_t getIndex() const</div><div class="ttdoc">Get index. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00230">Element.h:230</a></div></div>
<div class="ttc" id="a00864_html_a82f10399909e0f7fa8f6344c305781cc"><div class="ttname"><a href="a00864.html#a82f10399909e0f7fa8f6344c305781cc">nnp::Structure::hasSymmetryFunctionDerivatives</a></div><div class="ttdeci">bool hasSymmetryFunctionDerivatives</div><div class="ttdoc">If symmetry function derivatives are saved for each atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00063">Structure.h:63</a></div></div>
<div class="ttc" id="a00808_html_a708047feeff8f20e48b6a3d476ddb643"><div class="ttname"><a href="a00808.html#a708047feeff8f20e48b6a3d476ddb643">nnp::Atom::indexStructure</a></div><div class="ttdeci">std::size_t indexStructure</div><div class="ttdoc">Index number of structure this atom belongs to. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00103">Atom.h:103</a></div></div>
<div class="ttc" id="a00808_html_a1f3ed8b68d3c546d068024b0c949eac1"><div class="ttname"><a href="a00808.html#a1f3ed8b68d3c546d068024b0c949eac1">nnp::Atom::hasSymmetryFunctionDerivatives</a></div><div class="ttdeci">bool hasSymmetryFunctionDerivatives</div><div class="ttdoc">If symmetry function derivatives are saved for this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00099">Atom.h:99</a></div></div>
<div class="ttc" id="a00808_html_a807a4cf41842f8225d88f1848f1ef6ee"><div class="ttname"><a href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a></div><div class="ttdeci">std::size_t element</div><div class="ttdoc">Element index of this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00107">Atom.h:107</a></div></div>
<div class="ttc" id="a00820_html"><div class="ttname"><a href="a00820.html">nnp::Element</a></div><div class="ttdoc">Contains element-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00036">Element.h:36</a></div></div>
<div class="ttc" id="a00808_html_af1688532887675a8f0dd944768589fff"><div class="ttname"><a href="a00808.html#af1688532887675a8f0dd944768589fff">nnp::Atom::getNumNeighbors</a></div><div class="ttdeci">std::size_t getNumNeighbors(double cutoffRadius) const</div><div class="ttdoc">Calculate number of neighbors for a given cutoff radius. </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.html#l00253">Atom.cpp:253</a></div></div>
<div class="ttc" id="a00808_html_a8b6403674a98b82e02508193fa86f196"><div class="ttname"><a href="a00808.html#a8b6403674a98b82e02508193fa86f196">nnp::Atom::hasSymmetryFunctions</a></div><div class="ttdeci">bool hasSymmetryFunctions</div><div class="ttdoc">If symmetry function values are saved for this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00097">Atom.h:97</a></div></div>
<div class="ttc" id="a00820_html_a6dc921df037ff55fa8e20a834b1bf486"><div class="ttname"><a href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486">nnp::Element::updateSymmetryFunctionStatistics</a></div><div class="ttdeci">std::size_t updateSymmetryFunctionStatistics(Atom const &amp;atom)</div><div class="ttdoc">Update symmetry function statistics. </div><div class="ttdef"><b>Definition:</b> <a href="a00062_source.html#l00386">Element.cpp:386</a></div></div>
<div class="ttc" id="a00864_html_aff934fe32fb46e93dd9551d50ed4b0b6"><div class="ttname"><a href="a00864.html#aff934fe32fb46e93dd9551d50ed4b0b6">nnp::Structure::hasSymmetryFunctions</a></div><div class="ttdeci">bool hasSymmetryFunctions</div><div class="ttdoc">If symmetry function values are saved for each atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00061">Structure.h:61</a></div></div>
<div class="ttc" id="a00808_html"><div class="ttname"><a href="a00808.html">nnp::Atom</a></div><div class="ttdoc">Storage for a single atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00030">Atom.h:30</a></div></div>
<div class="ttc" id="a00832_html_aae5d8b1186dde3ffbf2545fca1d08923"><div class="ttname"><a href="a00832.html#aae5d8b1186dde3ffbf2545fca1d08923">nnp::Mode::log</a></div><div class="ttdeci">Log log</div><div class="ttdoc">Global log file. </div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00464">Mode.h:464</a></div></div>
<div class="ttc" id="a00832_html_a03ee0e33408435b18a79a253e967856a"><div class="ttname"><a href="a00832.html#a03ee0e33408435b18a79a253e967856a">nnp::Mode::checkExtrapolationWarnings</a></div><div class="ttdeci">bool checkExtrapolationWarnings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00468">Mode.h:468</a></div></div>
<div class="ttc" id="a00808_html_a2de21db9dfe00cf608d5b77e6b0f6299"><div class="ttname"><a href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299">nnp::Atom::allocate</a></div><div class="ttdeci">void allocate(bool all)</div><div class="ttdoc">Allocate vectors related to symmetry functions (G, dEdG). </div><div class="ttdef"><b>Definition:</b> <a href="a00050_source.html#l00148">Atom.cpp:148</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a8aec6fb4708b93b93a9cfa0e8045f955_cgraph.png" border="0" usemap="#a00832_a8aec6fb4708b93b93a9cfa0e8045f955_cgraph" alt=""/></div>
<map name="a00832_a8aec6fb4708b93b93a9cfa0e8045f955_cgraph" id="a00832_a8aec6fb4708b93b93a9cfa0e8045f955_cgraph">
<area shape="rect" id="node2" href="a00808.html#a2de21db9dfe00cf608d5b77e6b0f6299" title="Allocate vectors related to symmetry functions (G, dEdG). " alt="" coords="324,5,473,32"/>
<area shape="rect" id="node3" href="a00820.html#a2224824f8ec31f118ea82508a0875067" title="Calculate symmetry functions via groups. " alt="" coords="277,57,520,98"/>
<area shape="rect" id="node4" href="a00820.html#a5fbd74ba2c16338eacd4bb519cf0b975" title="Get index. " alt="" coords="312,123,485,149"/>
<area shape="rect" id="node5" href="a00808.html#af1688532887675a8f0dd944768589fff" title="Calculate number of neighbors for a given cutoff radius. " alt="" coords="291,173,506,200"/>
<area shape="rect" id="node6" href="a00820.html#af610c8dced27214120a57c24098ba0ac" title="Get number of relevant symmetry functions per element. " alt="" coords="296,225,501,266"/>
<area shape="rect" id="node7" href="a00820.html#af1b22fc60cd3e9d71e91ec2448f4c4d1" title="Get number of symmetry functions. " alt="" coords="292,290,505,331"/>
<area shape="rect" id="node8" href="a00258.html#a398f0bcafb57e99ba1581c4b8f8a7f76" title="String version of printf function. " alt="" coords="568,385,652,412"/>
<area shape="rect" id="node9" href="a00820.html#a6dc921df037ff55fa8e20a834b1bf486" title="Update symmetry function statistics. " alt="" coords="284,407,513,449"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a8aec6fb4708b93b93a9cfa0e8045f955_icgraph.png" border="0" usemap="#a00832_a8aec6fb4708b93b93a9cfa0e8045f955_icgraph" alt=""/></div>
<map name="a00832_a8aec6fb4708b93b93a9cfa0e8045f955_icgraph" id="a00832_a8aec6fb4708b93b93a9cfa0e8045f955_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="277,5,449,47"/>
<area shape="rect" id="node3" href="a00944.html#ae22bf5b246022c4f52f45bcc98d7c4be" title="Calculate derivatives of energy with respect to weights. " alt="" coords="277,71,449,112"/>
<area shape="rect" id="node4" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="336,137,391,163"/>
<area shape="rect" id="node5" href="a00848.html#af86efaec86e8002a84368c7282704858" title="nnp::Prediction::predict" alt="" coords="277,187,449,214"/>
<area shape="rect" id="node6" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2" title="Calculate symmetry functions, atomic neural networks and sum of local energy contributions. " alt="" coords="279,239,447,280"/>
<area shape="rect" id="node7" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa" title="Perform one update. " alt="" coords="284,305,443,331"/>
</map>
</div>

</div>
</div>
<a id="a93dc4a306a3caf233268dad71efd565f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93dc4a306a3caf233268dad71efd565f">&#9670;&nbsp;</a></span>calculateAtomicNeuralNetworks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::calculateAtomicNeuralNetworks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool const&#160;</td>
          <td class="paramname"><em>derivatives</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate atomic neural networks for all atoms in given structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">derivatives</td><td>If <code>true</code> calculate also derivatives of neural networks with respect to input layer neurons (required for force calculation).</td></tr>
  </table>
  </dd>
</dl>
<p>The atomic energy is stored in <a class="el" href="a00808.html#abae2157524b61b7772f09d7fae340fa3" title="Atomic energy determined by neural network. ">Atom::energy</a>. If derivatives are calculated the results are stored in <a class="el" href="a00808.html#a139bcae479dfbf132aa5e33956c0610d" title="Derivative of atomic energy with respect to symmetry functions. ">Atom::dEdG</a>. The atomic energy energy offset (keyword <code>atom_energy</code>) is also added at this point. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01045">1045</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="a00836.html#abf46d0d0d2a4c068f67bb13ae445d725">nnp::NeuralNetwork::calculateDEdG()</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00836.html#ad7e18949cd215e5427440fce7a1437d7">nnp::NeuralNetwork::getOutput()</a>, <a class="el" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">nnp::Element::neuralNetwork</a>, <a class="el" href="a00836.html#a9d2a2d332c23876935e3a3272f40f5c2">nnp::NeuralNetwork::propagate()</a>, and <a class="el" href="a00836.html#a0ddcfb0243cca5956075a75c90431c37">nnp::NeuralNetwork::setInput()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, and <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;{</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;         it != structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <a class="code" href="a00820.html">Element</a> <span class="keyword">const</span>&amp; e = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(it-&gt;element);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a>-&gt;<a class="code" href="a00836.html#a0ddcfb0243cca5956075a75c90431c37">setInput</a>(&amp;((it-&gt;G).front()));</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a>-&gt;<a class="code" href="a00836.html#a9d2a2d332c23876935e3a3272f40f5c2">propagate</a>();</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordflow">if</span> (derivatives) e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a>-&gt;<a class="code" href="a00836.html#abf46d0d0d2a4c068f67bb13ae445d725">calculateDEdG</a>(&amp;((it-&gt;dEdG).front()));</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        e.<a class="code" href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">neuralNetwork</a>-&gt;<a class="code" href="a00836.html#ad7e18949cd215e5427440fce7a1437d7">getOutput</a>(&amp;(it-&gt;energy));</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    }</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;}</div><div class="ttc" id="a00864_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00093">Structure.h:93</a></div></div>
<div class="ttc" id="a00836_html_abf46d0d0d2a4c068f67bb13ae445d725"><div class="ttname"><a href="a00836.html#abf46d0d0d2a4c068f67bb13ae445d725">nnp::NeuralNetwork::calculateDEdG</a></div><div class="ttdeci">void calculateDEdG(double *dEdG) const</div><div class="ttdoc">Calculate derivative of output neuron with respect to input neurons. </div><div class="ttdef"><b>Definition:</b> <a href="a00086_source.html#l00381">NeuralNetwork.cpp:381</a></div></div>
<div class="ttc" id="a00836_html_ad7e18949cd215e5427440fce7a1437d7"><div class="ttname"><a href="a00836.html#ad7e18949cd215e5427440fce7a1437d7">nnp::NeuralNetwork::getOutput</a></div><div class="ttdeci">void getOutput(double *output) const</div><div class="ttdoc">Get neural network output layer node values. </div><div class="ttdef"><b>Definition:</b> <a href="a00086_source.html#l00361">NeuralNetwork.cpp:361</a></div></div>
<div class="ttc" id="a00820_html_ab72768a2e5659bcff9dfbb8cea05fe33"><div class="ttname"><a href="a00820.html#ab72768a2e5659bcff9dfbb8cea05fe33">nnp::Element::neuralNetwork</a></div><div class="ttdeci">NeuralNetwork * neuralNetwork</div><div class="ttdoc">Neural network pointer for this element. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00194">Element.h:194</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00836_html_a9d2a2d332c23876935e3a3272f40f5c2"><div class="ttname"><a href="a00836.html#a9d2a2d332c23876935e3a3272f40f5c2">nnp::NeuralNetwork::propagate</a></div><div class="ttdeci">void propagate()</div><div class="ttdoc">Propagate input information through all layers. </div><div class="ttdef"><b>Definition:</b> <a href="a00086_source.html#l00371">NeuralNetwork.cpp:371</a></div></div>
<div class="ttc" id="a00820_html"><div class="ttname"><a href="a00820.html">nnp::Element</a></div><div class="ttdoc">Contains element-specific data. </div><div class="ttdef"><b>Definition:</b> <a href="a00065_source.html#l00036">Element.h:36</a></div></div>
<div class="ttc" id="a00836_html_a0ddcfb0243cca5956075a75c90431c37"><div class="ttname"><a href="a00836.html#a0ddcfb0243cca5956075a75c90431c37">nnp::NeuralNetwork::setInput</a></div><div class="ttdeci">void setInput(double const *const &amp;input) const</div><div class="ttdoc">Set neural network input layer node values. </div><div class="ttdef"><b>Definition:</b> <a href="a00086_source.html#l00344">NeuralNetwork.cpp:344</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a93dc4a306a3caf233268dad71efd565f_cgraph.png" border="0" usemap="#a00832_a93dc4a306a3caf233268dad71efd565f_cgraph" alt=""/></div>
<map name="a00832_a93dc4a306a3caf233268dad71efd565f_cgraph" id="a00832_a93dc4a306a3caf233268dad71efd565f_cgraph">
<area shape="rect" id="node2" href="a00836.html#abf46d0d0d2a4c068f67bb13ae445d725" title="Calculate derivative of output neuron with respect to input neurons. " alt="" coords="256,5,408,47"/>
<area shape="rect" id="node3" href="a00836.html#ad7e18949cd215e5427440fce7a1437d7" title="Get neural network output layer node values. " alt="" coords="256,71,408,112"/>
<area shape="rect" id="node4" href="a00836.html#a9d2a2d332c23876935e3a3272f40f5c2" title="Propagate input information through all layers. " alt="" coords="256,136,408,177"/>
<area shape="rect" id="node5" href="a00836.html#a0ddcfb0243cca5956075a75c90431c37" title="Set neural network input layer node values. " alt="" coords="256,201,408,243"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a93dc4a306a3caf233268dad71efd565f_icgraph.png" border="0" usemap="#a00832_a93dc4a306a3caf233268dad71efd565f_icgraph" alt=""/></div>
<map name="a00832_a93dc4a306a3caf233268dad71efd565f_icgraph" id="a00832_a93dc4a306a3caf233268dad71efd565f_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="256,5,428,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="315,71,369,98"/>
<area shape="rect" id="node4" href="a00848.html#af86efaec86e8002a84368c7282704858" title="nnp::Prediction::predict" alt="" coords="256,122,428,149"/>
<area shape="rect" id="node5" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2" title="Calculate symmetry functions, atomic neural networks and sum of local energy contributions. " alt="" coords="258,173,426,215"/>
<area shape="rect" id="node6" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa" title="Perform one update. " alt="" coords="263,239,421,266"/>
</map>
</div>

</div>
</div>
<a id="a88fb8800851f3d440fcf393cbc073308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88fb8800851f3d440fcf393cbc073308">&#9670;&nbsp;</a></span>calculateEnergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::calculateEnergy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate potential energy for a given structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure.</td></tr>
  </table>
  </dd>
</dl>
<p>Sum up potential energy from atomic energy contributions. Result is stored in <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5" title="Potential energy determined by neural network. ">Structure::energy</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01061">1061</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, and <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, and <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;{</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="comment">// Loop over all atoms and add atomic contributions to total energy.</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    structure.<a class="code" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> = 0.0;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Atom&gt;::iterator it = structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.begin();</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;         it != structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.end(); ++it)</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    {</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        structure.<a class="code" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> += it-&gt;energy;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;}</div><div class="ttc" id="a00864_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00093">Structure.h:93</a></div></div>
<div class="ttc" id="a00864_html_aa9fd0fd0f8a23b6bf96247589feceeb5"><div class="ttname"><a href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a></div><div class="ttdeci">double energy</div><div class="ttdoc">Potential energy determined by neural network. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00075">Structure.h:75</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a88fb8800851f3d440fcf393cbc073308_icgraph.png" border="0" usemap="#a00832_a88fb8800851f3d440fcf393cbc073308_icgraph" alt=""/></div>
<map name="a00832_a88fb8800851f3d440fcf393cbc073308_icgraph" id="a00832_a88fb8800851f3d440fcf393cbc073308_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="255,5,427,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="313,71,368,98"/>
<area shape="rect" id="node4" href="a00848.html#af86efaec86e8002a84368c7282704858" title="nnp::Prediction::predict" alt="" coords="255,122,427,149"/>
<area shape="rect" id="node5" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2" title="Calculate symmetry functions, atomic neural networks and sum of local energy contributions. " alt="" coords="257,173,425,215"/>
<area shape="rect" id="node6" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa" title="Perform one update. " alt="" coords="261,239,420,266"/>
</map>
</div>

</div>
</div>
<a id="ae2fddd6f29bb63ef67b9619544d81ab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2fddd6f29bb63ef67b9619544d81ab1">&#9670;&nbsp;</a></span>calculateForces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::calculateForces </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate forces for all atoms in given structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure.</td></tr>
  </table>
  </dd>
</dl>
<p>Combine intermediate results from symmetry function and neural network computation to atomic forces. Results are stored in <a class="el" href="a00808.html#a170d82083599ace5c7973bd22c79ddae" title="Force vector calculated by neural network. ">Atom::f</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01074">1074</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a>, <a class="el" href="a00808.html#a139bcae479dfbf132aa5e33956c0610d">nnp::Atom::dEdG</a>, <a class="el" href="a00808.html#a482ea8be24723a1a05012e4d405a60db">nnp::Atom::dGdr</a>, <a class="el" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a>, <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">nnp::Atom::f</a>, <a class="el" href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a>, <a class="el" href="a00808.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a>, <a class="el" href="a00808.html#ac4f376687337d16d376f1ea76c4d5f9c">nnp::Atom::neighborsUnique</a>, and <a class="el" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, and <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;{</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="a00808.html">Atom</a>* ai = NULL;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">// Loop over all atoms, center atom i (ai).</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="preprocessor">#ifdef _OPENMP</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="preprocessor">    #pragma omp parallel for private(ai)</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.size(); ++i)</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="comment">// Set pointer to atom.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        ai = &amp;(structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(i));</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="comment">// Reset forces.</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        ai-&gt;<a class="code" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">f</a>[0] = 0.0;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        ai-&gt;<a class="code" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">f</a>[1] = 0.0;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        ai-&gt;<a class="code" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">f</a>[2] = 0.0;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="comment">// First add force contributions from atom i itself (gradient of</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="comment">// atomic energy E_i).</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; ai-&gt;<a class="code" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">numSymmetryFunctions</a>; ++j)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        {</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            ai-&gt;<a class="code" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">f</a> -= ai-&gt;<a class="code" href="a00808.html#a139bcae479dfbf132aa5e33956c0610d">dEdG</a>.at(j) * ai-&gt;<a class="code" href="a00808.html#a482ea8be24723a1a05012e4d405a60db">dGdr</a>.at(j);</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <span class="comment">// Now loop over all neighbor atoms j of atom i. These may hold</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">// non-zero derivatives of their symmetry functions with respect to</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="comment">// atom i&#39;s coordinates. Some atoms may appear multiple times in the</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="comment">// neighbor list because of periodic boundary conditions. To avoid</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="comment">// that the same contributions are added multiple times use the</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="comment">// &quot;unique neighbor&quot; list (but skip the first entry, this is always</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="comment">// atom i itself).</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">for</span> (vector&lt;size_t&gt;::const_iterator it =</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;             ai-&gt;<a class="code" href="a00808.html#ac4f376687337d16d376f1ea76c4d5f9c">neighborsUnique</a>.begin() + 1;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;             it != ai-&gt;<a class="code" href="a00808.html#ac4f376687337d16d376f1ea76c4d5f9c">neighborsUnique</a>.end(); ++it)</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        {</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="comment">// Define shortcut for atom j (aj).</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            <a class="code" href="a00808.html">Atom</a>&amp; aj = structure.<a class="code" href="a00864.html#adee965dec483f9479378a2ed4acd5544">atoms</a>.at(*it);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="preprocessor">#ifdef IMPROVED_SFD_MEMORY</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            vector&lt;vector&lt;size_t&gt; &gt; <span class="keyword">const</span>&amp; tableFull</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(aj.<a class="code" href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">element</a>).getSymmetryFunctionTable();</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="comment">// Loop over atom j&#39;s neighbors (n), atom i should be one of them.</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="keywordflow">for</span> (vector&lt;Atom::Neighbor&gt;::const_iterator n =</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                 aj.<a class="code" href="a00808.html#a0361a8e48f3b762f76db75abcf6fc305">neighbors</a>.begin(); n != aj.<a class="code" href="a00808.html#a0361a8e48f3b762f76db75abcf6fc305">neighbors</a>.end(); ++n)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            {</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="comment">// If atom j&#39;s neighbor is atom i add force contributions.</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <span class="keywordflow">if</span> (n-&gt;index == ai-&gt;<a class="code" href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">index</a>)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="preprocessor">#ifdef IMPROVED_SFD_MEMORY</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    vector&lt;size_t&gt; <span class="keyword">const</span>&amp; table = tableFull.at(n-&gt;element);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; n-&gt;dGdr.size(); ++j)</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                    {</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                        ai-&gt;<a class="code" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">f</a> -= aj.<a class="code" href="a00808.html#a139bcae479dfbf132aa5e33956c0610d">dEdG</a>.at(table.at(j)) * n-&gt;dGdr.at(j);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    }</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; aj.<a class="code" href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">numSymmetryFunctions</a>; ++j)</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                    {</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                        ai-&gt;<a class="code" href="a00808.html#a170d82083599ace5c7973bd22c79ddae">f</a> -= aj.<a class="code" href="a00808.html#a139bcae479dfbf132aa5e33956c0610d">dEdG</a>.at(j) * n-&gt;dGdr.at(j);</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                    }</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                }</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            }</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;}</div><div class="ttc" id="a00864_html_adee965dec483f9479378a2ed4acd5544"><div class="ttname"><a href="a00864.html#adee965dec483f9479378a2ed4acd5544">nnp::Structure::atoms</a></div><div class="ttdeci">std::vector&lt; Atom &gt; atoms</div><div class="ttdoc">Vector of all atoms in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00093">Structure.h:93</a></div></div>
<div class="ttc" id="a00808_html_a0b2e4de557a8b4f97936fcd4bab7a564"><div class="ttname"><a href="a00808.html#a0b2e4de557a8b4f97936fcd4bab7a564">nnp::Atom::numSymmetryFunctions</a></div><div class="ttdeci">std::size_t numSymmetryFunctions</div><div class="ttdoc">Number of symmetry functions used to describe the atom environment. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00113">Atom.h:113</a></div></div>
<div class="ttc" id="a00808_html_ac4f376687337d16d376f1ea76c4d5f9c"><div class="ttname"><a href="a00808.html#ac4f376687337d16d376f1ea76c4d5f9c">nnp::Atom::neighborsUnique</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; neighborsUnique</div><div class="ttdoc">List of unique neighbor indices (don&amp;#39;t count multiple PBC images). </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00125">Atom.h:125</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00808_html_a2e45492f424bf0af6841ce9a9033d11e"><div class="ttname"><a href="a00808.html#a2e45492f424bf0af6841ce9a9033d11e">nnp::Atom::index</a></div><div class="ttdeci">std::size_t index</div><div class="ttdoc">Index number of this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00101">Atom.h:101</a></div></div>
<div class="ttc" id="a00808_html_a482ea8be24723a1a05012e4d405a60db"><div class="ttname"><a href="a00808.html#a482ea8be24723a1a05012e4d405a60db">nnp::Atom::dGdr</a></div><div class="ttdeci">std::vector&lt; Vec3D &gt; dGdr</div><div class="ttdoc">Derivative of symmetry functions with respect to this atom&amp;#39;s coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00141">Atom.h:141</a></div></div>
<div class="ttc" id="a00808_html_a807a4cf41842f8225d88f1848f1ef6ee"><div class="ttname"><a href="a00808.html#a807a4cf41842f8225d88f1848f1ef6ee">nnp::Atom::element</a></div><div class="ttdeci">std::size_t element</div><div class="ttdoc">Element index of this atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00107">Atom.h:107</a></div></div>
<div class="ttc" id="a00808_html_a170d82083599ace5c7973bd22c79ddae"><div class="ttname"><a href="a00808.html#a170d82083599ace5c7973bd22c79ddae">nnp::Atom::f</a></div><div class="ttdeci">Vec3D f</div><div class="ttdoc">Force vector calculated by neural network. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00121">Atom.h:121</a></div></div>
<div class="ttc" id="a00808_html_a139bcae479dfbf132aa5e33956c0610d"><div class="ttname"><a href="a00808.html#a139bcae479dfbf132aa5e33956c0610d">nnp::Atom::dEdG</a></div><div class="ttdeci">std::vector&lt; double &gt; dEdG</div><div class="ttdoc">Derivative of atomic energy with respect to symmetry functions. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00133">Atom.h:133</a></div></div>
<div class="ttc" id="a00808_html"><div class="ttname"><a href="a00808.html">nnp::Atom</a></div><div class="ttdoc">Storage for a single atom. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00030">Atom.h:30</a></div></div>
<div class="ttc" id="a00808_html_a0361a8e48f3b762f76db75abcf6fc305"><div class="ttname"><a href="a00808.html#a0361a8e48f3b762f76db75abcf6fc305">nnp::Atom::neighbors</a></div><div class="ttdeci">std::vector&lt; Neighbor &gt; neighbors</div><div class="ttdoc">Neighbor array (maximum number defined in macros.h. </div><div class="ttdef"><b>Definition:</b> <a href="a00053_source.html#l00143">Atom.h:143</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae2fddd6f29bb63ef67b9619544d81ab1_icgraph.png" border="0" usemap="#a00832_ae2fddd6f29bb63ef67b9619544d81ab1_icgraph" alt=""/></div>
<map name="a00832_ae2fddd6f29bb63ef67b9619544d81ab1_icgraph" id="a00832_ae2fddd6f29bb63ef67b9619544d81ab1_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="252,5,424,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="311,71,365,98"/>
<area shape="rect" id="node4" href="a00848.html#af86efaec86e8002a84368c7282704858" title="nnp::Prediction::predict" alt="" coords="252,122,424,149"/>
<area shape="rect" id="node5" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa" title="Perform one update. " alt="" coords="259,173,417,199"/>
</map>
</div>

</div>
</div>
<a id="a17ba3ecbce972ff28d7a17bdade38674"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17ba3ecbce972ff28d7a17bdade38674">&#9670;&nbsp;</a></span>addEnergyOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::addEnergyOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add atomic energy offsets to reference energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, use reference energy, otherwise use NN energy. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01142">1142</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a>, and <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, and <a class="el" href="a00944.html#af4cbb8263eeb79634e06fc62dc4b359d">nnp::Training::writeSetsToFiles()</a>.</p>
<div class="fragment"><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;{</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    {</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">if</span> (ref)</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        {</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            structure.<a class="code" href="a00864.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> += structure.<a class="code" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                 * <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset();</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            structure.<a class="code" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> += structure.<a class="code" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                              * <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset();</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        }</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00864_html_aaee087b13af754a75198def4d12c8b61"><div class="ttname"><a href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a></div><div class="ttdeci">double energyRef</div><div class="ttdoc">Reference potential energy. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00077">Structure.h:77</a></div></div>
<div class="ttc" id="a00864_html_a3427c9bd877e3bf72ad71f30dfb76ac2"><div class="ttname"><a href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numAtomsPerElement</div><div class="ttdoc">Number of atoms of each element in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00091">Structure.h:91</a></div></div>
<div class="ttc" id="a00864_html_aa9fd0fd0f8a23b6bf96247589feceeb5"><div class="ttname"><a href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a></div><div class="ttdeci">double energy</div><div class="ttdoc">Potential energy determined by neural network. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00075">Structure.h:75</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a17ba3ecbce972ff28d7a17bdade38674_icgraph.png" border="0" usemap="#a00832_a17ba3ecbce972ff28d7a17bdade38674_icgraph" alt=""/></div>
<map name="a00832_a17ba3ecbce972ff28d7a17bdade38674_icgraph" id="a00832_a17ba3ecbce972ff28d7a17bdade38674_icgraph">
<area shape="rect" id="node2" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="319,5,373,32"/>
<area shape="rect" id="node3" href="a00848.html#af86efaec86e8002a84368c7282704858" title="nnp::Prediction::predict" alt="" coords="260,56,432,83"/>
<area shape="rect" id="node4" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2" title="Calculate symmetry functions, atomic neural networks and sum of local energy contributions. " alt="" coords="262,107,430,149"/>
<area shape="rect" id="node5" href="a00944.html#af4cbb8263eeb79634e06fc62dc4b359d" title="Write training and test set to separate files (train.data and test.data, same format as input..." alt="" coords="259,173,433,214"/>
</map>
</div>

</div>
</div>
<a id="aa8ddf0701dbcd60868955ca556892bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ddf0701dbcd60868955ca556892bc5">&#9670;&nbsp;</a></span>removeEnergyOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::removeEnergyOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove atomic energy offsets from reference energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, use reference energy, otherwise use NN energy.</td></tr>
  </table>
  </dd>
</dl>
<p>This function should be called immediately after structures are read in. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01161">1161</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a>, and <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00932.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="a00848.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, and <a class="el" href="a00944.html#af4cbb8263eeb79634e06fc62dc4b359d">nnp::Training::writeSetsToFiles()</a>.</p>
<div class="fragment"><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;{</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        <span class="keywordflow">if</span> (ref)</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        {</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            structure.<a class="code" href="a00864.html#aaee087b13af754a75198def4d12c8b61">energyRef</a> -= structure.<a class="code" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                 * <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset();</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        }</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        {</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            structure.<a class="code" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">energy</a> -= structure.<a class="code" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">numAtomsPerElement</a>.at(i)</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                              * <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset();</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        }</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    }</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00864_html_aaee087b13af754a75198def4d12c8b61"><div class="ttname"><a href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a></div><div class="ttdeci">double energyRef</div><div class="ttdoc">Reference potential energy. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00077">Structure.h:77</a></div></div>
<div class="ttc" id="a00864_html_a3427c9bd877e3bf72ad71f30dfb76ac2"><div class="ttname"><a href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a></div><div class="ttdeci">std::vector&lt; std::size_t &gt; numAtomsPerElement</div><div class="ttdoc">Number of atoms of each element in this structure. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00091">Structure.h:91</a></div></div>
<div class="ttc" id="a00864_html_aa9fd0fd0f8a23b6bf96247589feceeb5"><div class="ttname"><a href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a></div><div class="ttdeci">double energy</div><div class="ttdoc">Potential energy determined by neural network. </div><div class="ttdef"><b>Definition:</b> <a href="a00119_source.html#l00075">Structure.h:75</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa8ddf0701dbcd60868955ca556892bc5_icgraph.png" border="0" usemap="#a00832_aa8ddf0701dbcd60868955ca556892bc5_icgraph" alt=""/></div>
<map name="a00832_aa8ddf0701dbcd60868955ca556892bc5_icgraph" id="a00832_aa8ddf0701dbcd60868955ca556892bc5_icgraph">
<area shape="rect" id="node2" href="a00932.html#a1ecb649e652e2c6acb83102340f48afd" title="Read data file and distribute structures among processors. " alt="" coords="304,5,479,47"/>
<area shape="rect" id="node3" href="a00848.html#a217f052c181f847506b5d2382c02246c" title="nnp::Prediction::readStructure\lFromFile" alt="" coords="284,71,499,112"/>
<area shape="rect" id="node4" href="a00944.html#af4cbb8263eeb79634e06fc62dc4b359d" title="Write training and test set to separate files (train.data and test.data, same format as input..." alt="" coords="304,136,479,177"/>
</map>
</div>

</div>
</div>
<a id="af05a24414c9b595a8ccb95b05b5030de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af05a24414c9b595a8ccb95b05b5030de">&#9670;&nbsp;</a></span>getEnergyOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::getEnergyOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> const &amp;&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get atomic energy offset for given structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Summed atomic energy offsets for structure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01180">1180</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a>, and <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00932.html#aa12823183030d6cff2e059e860d15671">nnp::Dataset::writeSymmetryFunctionFile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;{</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordtype">double</span> result = 0.0;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    {</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        result += structure.numAtomsPerElement.at(i)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                * <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset();</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    }</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_af05a24414c9b595a8ccb95b05b5030de_icgraph.png" border="0" usemap="#a00832_af05a24414c9b595a8ccb95b05b5030de_icgraph" alt=""/></div>
<map name="a00832_af05a24414c9b595a8ccb95b05b5030de_icgraph" id="a00832_af05a24414c9b595a8ccb95b05b5030de_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="336,5,391,32"/>
<area shape="rect" id="node3" href="a00932.html#aa12823183030d6cff2e059e860d15671" title="Write symmetry function legacy file (&quot;function.data&quot;). " alt="" coords="256,57,471,98"/>
</map>
</div>

</div>
</div>
<a id="ab86800b032be86f1321d3f6683c75b01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab86800b032be86f1321d3f6683c75b01">&#9670;&nbsp;</a></span>getEnergyWithOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::getEnergyWithOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> const &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add atomic energy offsets and return energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, use reference energy, otherwise use NN energy.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference or NNP energy with energy offsets added.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If normalization is used, ensure that structure energy is already in physical units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01193">1193</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="a00864.html#a3427c9bd877e3bf72ad71f30dfb76ac2">nnp::Structure::numAtomsPerElement</a>, and <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;{</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordtype">double</span> result;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (ref) result = structure.energyRef;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">else</span>     result = structure.energy;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        result += structure.numAtomsPerElement.at(i)</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                * <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getAtomicEnergyOffset();</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ab86800b032be86f1321d3f6683c75b01_icgraph.png" border="0" usemap="#a00832_ab86800b032be86f1321d3f6683c75b01_icgraph" alt=""/></div>
<map name="a00832_ab86800b032be86f1321d3f6683c75b01_icgraph" id="a00832_ab86800b032be86f1321d3f6683c75b01_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="247,13,301,39"/>
</map>
</div>

</div>
</div>
<a id="ad914604c902d947d44c32b4f760e1da3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad914604c902d947d44c32b4f760e1da3">&#9670;&nbsp;</a></span>normalizedEnergy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::normalizedEnergy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply normalization to given energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">energy</td><td>Input energy in physical units.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Energy in normalized units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01208">1208</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>.</p>
<div class="fragment"><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;{</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">return</span> energy * <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>; </div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div><div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af5d51e9328414aea8106d85bde5a1729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5d51e9328414aea8106d85bde5a1729">&#9670;&nbsp;</a></span>normalizedEnergy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::normalizedEnergy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> const &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply normalization to given energy of structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure with energy in physical units. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, use reference energy, otherwise use NN energy.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Energy in normalized units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01213">1213</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, and <a class="el" href="a00864.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a>.</p>
<div class="fragment"><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;{</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">if</span> (ref)</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    {</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <span class="keywordflow">return</span> (structure.energyRef - structure.numAtoms * <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;               * <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>; </div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    }</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">return</span> (structure.energy - structure.numAtoms * <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>)</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;               * <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>; </div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;}</div><div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a42377e19341fd2666856b9177b6588dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42377e19341fd2666856b9177b6588dd">&#9670;&nbsp;</a></span>normalizedForce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::normalizedForce </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>force</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply normalization to given force. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">force</td><td>Input force in physical units.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Force in normalized units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01227">1227</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, and <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>.</p>
<div class="fragment"><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;{</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">return</span> force * <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a> / <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div><div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fcf4fe91e191c78e4bc2a999225b8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fcf4fe91e191c78e4bc2a999225b8b1">&#9670;&nbsp;</a></span>physicalEnergy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::physicalEnergy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>energy</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Undo normalization for a given energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">energy</td><td>Input energy in normalized units.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Energy in physical units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01232">1232</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00928.html#a680dca82d8c1670ac2effe7ba7df60fc">nnp::InterfaceLammps::getAtomicEnergy()</a>, <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, <a class="el" href="a00944.html#ae4ccff5ae694d46c03cae84aa7ae696d">nnp::Training::writeLearningCurve()</a>, and <a class="el" href="a00932.html#aa12823183030d6cff2e059e860d15671">nnp::Dataset::writeSymmetryFunctionFile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;{</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordflow">return</span> energy / <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>; </div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;}</div><div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a9fcf4fe91e191c78e4bc2a999225b8b1_icgraph.png" border="0" usemap="#a00832_a9fcf4fe91e191c78e4bc2a999225b8b1_icgraph" alt=""/></div>
<map name="a00832_a9fcf4fe91e191c78e4bc2a999225b8b1_icgraph" id="a00832_a9fcf4fe91e191c78e4bc2a999225b8b1_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="271,5,443,47"/>
<area shape="rect" id="node3" href="a00928.html#a680dca82d8c1670ac2effe7ba7df60fc" title="Return energy contribution of one atom. " alt="" coords="273,71,441,112"/>
<area shape="rect" id="node4" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="329,137,384,163"/>
<area shape="rect" id="node5" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2" title="Calculate symmetry functions, atomic neural networks and sum of local energy contributions. " alt="" coords="273,188,441,229"/>
<area shape="rect" id="node6" href="a00944.html#ae4ccff5ae694d46c03cae84aa7ae696d" title="Write current RMSEs and epoch information to file. " alt="" coords="255,253,458,295"/>
<area shape="rect" id="node7" href="a00932.html#aa12823183030d6cff2e059e860d15671" title="Write symmetry function legacy file (&quot;function.data&quot;). " alt="" coords="249,319,464,360"/>
</map>
</div>

</div>
</div>
<a id="a02d558483ab82d340ee587febcfddd8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d558483ab82d340ee587febcfddd8f">&#9670;&nbsp;</a></span>physicalEnergy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::physicalEnergy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> const &amp;&#160;</td>
          <td class="paramname"><em>structure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ref</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Undo normalization for a given energy of structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">structure</td><td>Input structure with energy in normalized units. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>If true, use reference energy, otherwise use NN energy.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Energy in physical units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01237">1237</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="el" href="a00864.html#aa9fd0fd0f8a23b6bf96247589feceeb5">nnp::Structure::energy</a>, <a class="el" href="a00864.html#aaee087b13af754a75198def4d12c8b61">nnp::Structure::energyRef</a>, <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, and <a class="el" href="a00864.html#ad2c737c945e42ec42fa852e4dbacaf90">nnp::Structure::numAtoms</a>.</p>
<div class="fragment"><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;{</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">if</span> (ref)</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keywordflow">return</span> structure.energyRef / <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a> + structure.numAtoms</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;               * <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>; </div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    {</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">return</span> structure.energy / <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a> + structure.numAtoms * <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>; </div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9cfdc02d7860f91735b789ee11532982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cfdc02d7860f91735b789ee11532982">&#9670;&nbsp;</a></span>physicalForce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Mode::physicalForce </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>force</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Undo normalization for a given force. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">force</td><td>Input force in normalized units.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Force in physical units. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01250">1250</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, and <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, and <a class="el" href="a00944.html#ae4ccff5ae694d46c03cae84aa7ae696d">nnp::Training::writeLearningCurve()</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">return</span> force * <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a> / <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;}</div><div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a9cfdc02d7860f91735b789ee11532982_icgraph.png" border="0" usemap="#a00832_a9cfdc02d7860f91735b789ee11532982_icgraph" alt=""/></div>
<map name="a00832_a9cfdc02d7860f91735b789ee11532982_icgraph" id="a00832_a9cfdc02d7860f91735b789ee11532982_icgraph">
<area shape="rect" id="node2" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8" title="Calculate error metrics for all structures. " alt="" coords="255,5,427,47"/>
<area shape="rect" id="node3" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="314,71,369,98"/>
<area shape="rect" id="node4" href="a00944.html#ae4ccff5ae694d46c03cae84aa7ae696d" title="Write current RMSEs and epoch information to file. " alt="" coords="240,123,443,164"/>
</map>
</div>

</div>
</div>
<a id="a8353f189a07813687e6cda9dff5ef55a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8353f189a07813687e6cda9dff5ef55a">&#9670;&nbsp;</a></span>convertToNormalizedUnits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::convertToNormalizedUnits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert one structure to normalized units. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01255">1255</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>, <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, and <a class="el" href="a00864.html#acd39fe39b2b0e86e676c7bd52dc2b835">nnp::Structure::toNormalizedUnits()</a>.</p>
<div class="fragment"><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;{</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    structure.<a class="code" href="a00864.html#acd39fe39b2b0e86e676c7bd52dc2b835">toNormalizedUnits</a>(<a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;}</div><div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
<div class="ttc" id="a00864_html_acd39fe39b2b0e86e676c7bd52dc2b835"><div class="ttname"><a href="a00864.html#acd39fe39b2b0e86e676c7bd52dc2b835">nnp::Structure::toNormalizedUnits</a></div><div class="ttdeci">void toNormalizedUnits(double meanEnergy, double convEnergy, double convLength)</div><div class="ttdoc">Normalize structure, shift energy and change energy and length unit. </div><div class="ttdef"><b>Definition:</b> <a href="a00116_source.html#l00460">Structure.cpp:460</a></div></div>
<div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a8353f189a07813687e6cda9dff5ef55a_cgraph.png" border="0" usemap="#a00832_a8353f189a07813687e6cda9dff5ef55a_cgraph" alt=""/></div>
<map name="a00832_a8353f189a07813687e6cda9dff5ef55a_cgraph" id="a00832_a8353f189a07813687e6cda9dff5ef55a_cgraph">
<area shape="rect" id="node2" href="a00864.html#acd39fe39b2b0e86e676c7bd52dc2b835" title="Normalize structure, shift energy and change energy and length unit. " alt="" coords="288,5,497,47"/>
</map>
</div>

</div>
</div>
<a id="abbe07bd6a67b5df0b6dd5f5ce00fb1f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">&#9670;&nbsp;</a></span>convertToPhysicalUnits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::convertToPhysicalUnits </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00864.html">Structure</a> &amp;&#160;</td>
          <td class="paramname"><em>structure</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert one structure to physical units. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">structure</td><td>Input structure. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01262">1262</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>, <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, and <a class="el" href="a00864.html#a041778a6c0a2f6d436852e2325c65d20">nnp::Structure::toPhysicalUnits()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;{</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    structure.<a class="code" href="a00864.html#a041778a6c0a2f6d436852e2325c65d20">toPhysicalUnits</a>(<a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>, <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>, <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>);</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div><div class="ttc" id="a00864_html_a041778a6c0a2f6d436852e2325c65d20"><div class="ttname"><a href="a00864.html#a041778a6c0a2f6d436852e2325c65d20">nnp::Structure::toPhysicalUnits</a></div><div class="ttdeci">void toPhysicalUnits(double meanEnergy, double convEnergy, double convLength)</div><div class="ttdoc">Switch to physical units, shift energy and change energy and length unit. </div><div class="ttdef"><b>Definition:</b> <a href="a00116_source.html#l00486">Structure.cpp:486</a></div></div>
<div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
<div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
<div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_cgraph.png" border="0" usemap="#a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_cgraph" alt=""/></div>
<map name="a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_cgraph" id="a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_cgraph">
<area shape="rect" id="node2" href="a00864.html#a041778a6c0a2f6d436852e2325c65d20" title="Switch to physical units, shift energy and change energy and length unit. " alt="" coords="268,5,456,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_icgraph.png" border="0" usemap="#a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_icgraph" alt=""/></div>
<map name="a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_icgraph" id="a00832_abbe07bd6a67b5df0b6dd5f5ce00fb1f6_icgraph">
<area shape="rect" id="node2" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="268,13,323,39"/>
</map>
</div>

</div>
</div>
<a id="aa73bc18bc5e85e53303fea2132c4e78c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa73bc18bc5e85e53303fea2132c4e78c">&#9670;&nbsp;</a></span>getNumExtrapolationWarnings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t Mode::getNumExtrapolationWarnings </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Count total number of extrapolation warnings encountered for all elements and symmetry functions. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of extrapolation warnings. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01280">1280</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00956.html#a31e9057e2529ee8a779496358dcbd4f8">LAMMPS_NS::PairNNP::handleExtrapolationWarnings()</a>, and <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;{</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordtype">size_t</span> numExtrapolationWarnings = 0;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::const_iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    {</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        numExtrapolationWarnings +=</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            it-&gt;statistics.countExtrapolationWarnings();</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">return</span> numExtrapolationWarnings;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div><div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa73bc18bc5e85e53303fea2132c4e78c_icgraph.png" border="0" usemap="#a00832_aa73bc18bc5e85e53303fea2132c4e78c_icgraph" alt=""/></div>
<map name="a00832_aa73bc18bc5e85e53303fea2132c4e78c_icgraph" id="a00832_aa73bc18bc5e85e53303fea2132c4e78c_icgraph">
<area shape="rect" id="node2" href="a00956.html#a31e9057e2529ee8a779496358dcbd4f8" title="LAMMPS_NS::PairNNP\l::handleExtrapolationWarnings" alt="" coords="289,5,511,47"/>
<area shape="rect" id="node3" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="373,71,427,98"/>
</map>
</div>

</div>
</div>
<a id="ab71571b8b4742c474c645fa50ffa667e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab71571b8b4742c474c645fa50ffa667e">&#9670;&nbsp;</a></span>resetExtrapolationWarnings()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::resetExtrapolationWarnings </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Erase all extrapolation warnings and reset counters. </p>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01269">1269</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;{</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        it-&gt;statistics.resetExtrapolationWarnings();</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div><div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ab71571b8b4742c474c645fa50ffa667e_icgraph.png" border="0" usemap="#a00832_ab71571b8b4742c474c645fa50ffa667e_icgraph" alt=""/></div>
<map name="a00832_ab71571b8b4742c474c645fa50ffa667e_icgraph" id="a00832_ab71571b8b4742c474c645fa50ffa667e_icgraph">
<area shape="rect" id="node2" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="271,13,325,39"/>
</map>
</div>

</div>
</div>
<a id="ab6e30b5a1e840dc2a98516a0f276a3c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6e30b5a1e840dc2a98516a0f276a3c4">&#9670;&nbsp;</a></span>getMeanEnergy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::getMeanEnergy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter for <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">Mode::meanEnergy</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Mean energy per atom. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00487">487</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">meanEnergy</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div><div class="ttc" id="a00832_html_a5c6554727f0af7501fe82dfe136b3865"><div class="ttname"><a href="a00832.html#a5c6554727f0af7501fe82dfe136b3865">nnp::Mode::meanEnergy</a></div><div class="ttdeci">double meanEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00474">Mode.h:474</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ab6e30b5a1e840dc2a98516a0f276a3c4_icgraph.png" border="0" usemap="#a00832_ab6e30b5a1e840dc2a98516a0f276a3c4_icgraph" alt=""/></div>
<map name="a00832_ab6e30b5a1e840dc2a98516a0f276a3c4_icgraph" id="a00832_ab6e30b5a1e840dc2a98516a0f276a3c4_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="252,5,307,32"/>
</map>
</div>

</div>
</div>
<a id="a8da7486dc693fafe772c12a440a623d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8da7486dc693fafe772c12a440a623d8">&#9670;&nbsp;</a></span>getConvEnergy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::getConvEnergy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter for <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">Mode::convEnergy</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Energy unit conversion factor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00492">492</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;{</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#a09461989d84484833b10c96e6871f87e">convEnergy</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div><div class="ttc" id="a00832_html_a09461989d84484833b10c96e6871f87e"><div class="ttname"><a href="a00832.html#a09461989d84484833b10c96e6871f87e">nnp::Mode::convEnergy</a></div><div class="ttdeci">double convEnergy</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00475">Mode.h:475</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a8da7486dc693fafe772c12a440a623d8_icgraph.png" border="0" usemap="#a00832_a8da7486dc693fafe772c12a440a623d8_icgraph" alt=""/></div>
<map name="a00832_a8da7486dc693fafe772c12a440a623d8_icgraph" id="a00832_a8da7486dc693fafe772c12a440a623d8_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="249,5,304,32"/>
</map>
</div>

</div>
</div>
<a id="a373073bd1acb1c9ac293369bb892bdc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a373073bd1acb1c9ac293369bb892bdc4">&#9670;&nbsp;</a></span>getConvLength()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::getConvLength </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter for <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">Mode::convLength</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Length unit conversion factor. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00497">497</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">convLength</a>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;}</div><div class="ttc" id="a00832_html_a1d6eccfa0f21d64823f74cc75c89473f"><div class="ttname"><a href="a00832.html#a1d6eccfa0f21d64823f74cc75c89473f">nnp::Mode::convLength</a></div><div class="ttdeci">double convLength</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00476">Mode.h:476</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a373073bd1acb1c9ac293369bb892bdc4_icgraph.png" border="0" usemap="#a00832_a373073bd1acb1c9ac293369bb892bdc4_icgraph" alt=""/></div>
<map name="a00832_a373073bd1acb1c9ac293369bb892bdc4_icgraph" id="a00832_a373073bd1acb1c9ac293369bb892bdc4_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="248,5,303,32"/>
</map>
</div>

</div>
</div>
<a id="a73f1fcdcbb76828f6aca2d322bfeb2a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73f1fcdcbb76828f6aca2d322bfeb2a9">&#9670;&nbsp;</a></span>getMaxCutoffRadius()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::getMaxCutoffRadius </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter for <a class="el" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">Mode::maxCutoffRadius</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Maximum cutoff radius of all symmetry functions.</dd></dl>
<p>The maximum cutoff radius is determined by <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b" title="Set up all symmetry functions. ">setupSymmetryFunctions()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00502">502</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;{</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">maxCutoffRadius</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="ttc" id="a00832_html_a38f8bc8db576ad1762dd306b4d225383"><div class="ttname"><a href="a00832.html#a38f8bc8db576ad1762dd306b4d225383">nnp::Mode::maxCutoffRadius</a></div><div class="ttdeci">double maxCutoffRadius</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00472">Mode.h:472</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a73f1fcdcbb76828f6aca2d322bfeb2a9_icgraph.png" border="0" usemap="#a00832_a73f1fcdcbb76828f6aca2d322bfeb2a9_icgraph" alt=""/></div>
<map name="a00832_a73f1fcdcbb76828f6aca2d322bfeb2a9_icgraph" id="a00832_a73f1fcdcbb76828f6aca2d322bfeb2a9_icgraph">
<area shape="rect" id="node2" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="281,5,336,32"/>
</map>
</div>

</div>
</div>
<a id="a2dbf87eaa9cc33fa740e03608acdf156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dbf87eaa9cc33fa740e03608acdf156">&#9670;&nbsp;</a></span>getNumElements()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Mode::getNumElements </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Getter for <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">Mode::numElements</a>. </p>
<dl class="section return"><dt>Returns</dt><dd>Number of elements defined.</dd></dl>
<p>The number of elements is determined by <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec" title="Set up all Element instances. ">setupElements()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00507">507</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;{</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a2dbf87eaa9cc33fa740e03608acdf156_icgraph.png" border="0" usemap="#a00832_a2dbf87eaa9cc33fa740e03608acdf156_icgraph" alt=""/></div>
<map name="a00832_a2dbf87eaa9cc33fa740e03608acdf156_icgraph" id="a00832_a2dbf87eaa9cc33fa740e03608acdf156_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="264,5,319,32"/>
</map>
</div>

</div>
</div>
<a id="aa4fc3399c130a3778a20a625fa2ee34c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4fc3399c130a3778a20a625fa2ee34c">&#9670;&nbsp;</a></span>getNumSymmetryFunctions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; Mode::getNumSymmetryFunctions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get number of symmetry functions per element. </p>
<dl class="section return"><dt>Returns</dt><dd>Vector with number of symmetry functions for each element. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01294">1294</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;{</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    vector&lt;size_t&gt; v;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::const_iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    {</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        v.push_back(it-&gt;numSymmetryFunctions());</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordflow">return</span> v;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div><div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa4fc3399c130a3778a20a625fa2ee34c_icgraph.png" border="0" usemap="#a00832_aa4fc3399c130a3778a20a625fa2ee34c_icgraph" alt=""/></div>
<map name="a00832_aa4fc3399c130a3778a20a625fa2ee34c_icgraph" id="a00832_aa4fc3399c130a3778a20a625fa2ee34c_icgraph">
<area shape="rect" id="node2" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="271,13,325,39"/>
</map>
</div>

</div>
</div>
<a id="a7c500a49ebbd16752c9dbe988f56f451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c500a49ebbd16752c9dbe988f56f451">&#9670;&nbsp;</a></span>useNormalization()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Mode::useNormalization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if normalization is enabled. </p>
<dl class="section return"><dt>Returns</dt><dd>Value of <a class="el" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00512">512</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">normalize</a>;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div><div class="ttc" id="a00832_html_a043ac1c36d5edc38a6c72f4366823c69"><div class="ttname"><a href="a00832.html#a043ac1c36d5edc38a6c72f4366823c69">nnp::Mode::normalize</a></div><div class="ttdeci">bool normalize</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00467">Mode.h:467</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a7c500a49ebbd16752c9dbe988f56f451_icgraph.png" border="0" usemap="#a00832_a7c500a49ebbd16752c9dbe988f56f451_icgraph" alt=""/></div>
<map name="a00832_a7c500a49ebbd16752c9dbe988f56f451_icgraph" id="a00832_a7c500a49ebbd16752c9dbe988f56f451_icgraph">
<area shape="rect" id="node2" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="265,5,320,32"/>
</map>
</div>

</div>
</div>
<a id="aa9606884fa146912a6b4ab6d26df9275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9606884fa146912a6b4ab6d26df9275">&#9670;&nbsp;</a></span>settingsKeywordExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Mode::settingsKeywordExists </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>keyword</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if keyword was found in settings file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyword</td><td>Keyword for which value is requested.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if keyword exists, <code>false</code> otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01307">1307</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists()</a>, and <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;{</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">keywordExists</a>(keyword);</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;}</div><div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_a14649c081ce9e5c31c8b152079407f1b"><div class="ttname"><a href="a00852.html#a14649c081ce9e5c31c8b152079407f1b">nnp::Settings::keywordExists</a></div><div class="ttdeci">bool keywordExists(std::string const &amp;keyword) const</div><div class="ttdoc">Check if keyword was read from the settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00115">Settings.cpp:115</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa9606884fa146912a6b4ab6d26df9275_cgraph.png" border="0" usemap="#a00832_aa9606884fa146912a6b4ab6d26df9275_cgraph" alt=""/></div>
<map name="a00832_aa9606884fa146912a6b4ab6d26df9275_cgraph" id="a00832_aa9606884fa146912a6b4ab6d26df9275_cgraph">
<area shape="rect" id="node2" href="a00852.html#a14649c081ce9e5c31c8b152079407f1b" title="Check if keyword was read from the settings file. " alt="" coords="259,13,469,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_aa9606884fa146912a6b4ab6d26df9275_icgraph.png" border="0" usemap="#a00832_aa9606884fa146912a6b4ab6d26df9275_icgraph" alt=""/></div>
<map name="a00832_aa9606884fa146912a6b4ab6d26df9275_icgraph" id="a00832_aa9606884fa146912a6b4ab6d26df9275_icgraph">
<area shape="rect" id="node2" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="259,13,313,39"/>
</map>
</div>

</div>
</div>
<a id="a9b7eeb5daa541cc8e3ab36a9bcf69ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b7eeb5daa541cc8e3ab36a9bcf69ab8">&#9670;&nbsp;</a></span>settingsGetValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string Mode::settingsGetValue </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>keyword</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get value for given keyword in <a class="el" href="a00852.html" title="Reads and analyzes settings file and stores parameters. ">Settings</a> instance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keyword</td><td>Keyword for which value is requested.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value string corresponding to keyword. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01312">1312</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00852.html#abe28e4e40135fa996a04c00494a403d8">nnp::Settings::getValue()</a>, and <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.</p>
<div class="fragment"><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;{</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#abe28e4e40135fa996a04c00494a403d8">getValue</a>(keyword);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;}</div><div class="ttc" id="a00852_html_abe28e4e40135fa996a04c00494a403d8"><div class="ttname"><a href="a00852.html#abe28e4e40135fa996a04c00494a403d8">nnp::Settings::getValue</a></div><div class="ttdeci">std::string getValue(std::string const &amp;keyword) const</div><div class="ttdoc">Get value for given keyword. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00120">Settings.cpp:120</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a9b7eeb5daa541cc8e3ab36a9bcf69ab8_cgraph.png" border="0" usemap="#a00832_a9b7eeb5daa541cc8e3ab36a9bcf69ab8_cgraph" alt=""/></div>
<map name="a00832_a9b7eeb5daa541cc8e3ab36a9bcf69ab8_cgraph" id="a00832_a9b7eeb5daa541cc8e3ab36a9bcf69ab8_cgraph">
<area shape="rect" id="node2" href="a00852.html#abe28e4e40135fa996a04c00494a403d8" title="Get value for given keyword. " alt="" coords="261,5,433,32"/>
</map>
</div>

</div>
</div>
<a id="a5b8ceb8be242844ec8b72987e0bf0c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b8ceb8be242844ec8b72987e0bf0c3e">&#9670;&nbsp;</a></span>pruneSymmetryFunctionsRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; Mode::pruneSymmetryFunctionsRange </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prune symmetry functions according to their range and write settings file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold</td><td>Symmetry functions with range (max - min) smaller than this threshold will be pruned.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of line numbers with symmetry function to be removed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01342">1342</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, <a class="el" href="a00868.html#a445aece4ff74bbed5bf4598408787dfa">nnp::SymmetryFunction::getGmax()</a>, and <a class="el" href="a00868.html#ac562fb974ba5834d40b6b1a6b0191fd9">nnp::SymmetryFunction::getGmin()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00032.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;{</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    vector&lt;size_t&gt; prune;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="comment">// Check if symmetry functions have low range.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">for</span> (vector&lt;Element&gt;::const_iterator it = <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.begin();</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;         it != <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.end(); ++it)</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; it-&gt;numSymmetryFunctions(); ++i)</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <a class="code" href="a00868.html">SymmetryFunction</a> <span class="keyword">const</span>&amp; s = it-&gt;getSymmetryFunction(i);</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;            <span class="keywordflow">if</span> (fabs(s.<a class="code" href="a00868.html#a445aece4ff74bbed5bf4598408787dfa">getGmax</a>() - s.<a class="code" href="a00868.html#ac562fb974ba5834d40b6b1a6b0191fd9">getGmin</a>()) &lt; threshold)</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                prune.push_back(it-&gt;getSymmetryFunction(i).getLineNumber());</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        }</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    }</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <span class="keywordflow">return</span> prune;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;}</div><div class="ttc" id="a00868_html"><div class="ttname"><a href="a00868.html">nnp::SymmetryFunction</a></div><div class="ttdoc">Symmetry function base class. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00040">SymmetryFunction.h:40</a></div></div>
<div class="ttc" id="a00868_html_a445aece4ff74bbed5bf4598408787dfa"><div class="ttname"><a href="a00868.html#a445aece4ff74bbed5bf4598408787dfa">nnp::SymmetryFunction::getGmax</a></div><div class="ttdeci">double getGmax() const</div><div class="ttdoc">Get private Gmax member variable. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00367">SymmetryFunction.h:367</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
<div class="ttc" id="a00868_html_ac562fb974ba5834d40b6b1a6b0191fd9"><div class="ttname"><a href="a00868.html#ac562fb974ba5834d40b6b1a6b0191fd9">nnp::SymmetryFunction::getGmin</a></div><div class="ttdeci">double getGmin() const</div><div class="ttdoc">Get private Gmin member variable. </div><div class="ttdef"><b>Definition:</b> <a href="a00125_source.html#l00362">SymmetryFunction.h:362</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_cgraph.png" border="0" usemap="#a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_cgraph" alt=""/></div>
<map name="a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_cgraph" id="a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_cgraph">
<area shape="rect" id="node2" href="a00868.html#a445aece4ff74bbed5bf4598408787dfa" title="Get private Gmax member variable. " alt="" coords="256,5,432,47"/>
<area shape="rect" id="node3" href="a00868.html#ac562fb974ba5834d40b6b1a6b0191fd9" title="Get private Gmin member variable. " alt="" coords="256,71,432,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_icgraph.png" border="0" usemap="#a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_icgraph" alt=""/></div>
<map name="a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_icgraph" id="a00832_a5b8ceb8be242844ec8b72987e0bf0c3e_icgraph">
<area shape="rect" id="node2" href="a00032.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="256,13,311,39"/>
</map>
</div>

</div>
</div>
<a id="ae922768942eef6c6e9000700595bc00d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae922768942eef6c6e9000700595bc00d">&#9670;&nbsp;</a></span>pruneSymmetryFunctionsSensitivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; size_t &gt; Mode::pruneSymmetryFunctionsSensitivity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt;&#160;</td>
          <td class="paramname"><em>sensitivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prune symmetry functions with sensitivity analysis data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold</td><td>Symmetry functions with sensitivity lower than this threshold will be pruned. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sensitivity</td><td>Sensitivity data for each element and symmetry function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>List of line numbers with symmetry function to be removed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01363">1363</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>, and <a class="el" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00032.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;{</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    vector&lt;size_t&gt; prune;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="a00832.html#a76d3694d566d2052c298325a18ee865c">numElements</a>; ++i)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    {</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).numSymmetryFunctions(); ++j)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        {</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <span class="keywordflow">if</span> (sensitivity.at(i).at(j) &lt; threshold)</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            {</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                prune.push_back(</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                        <a class="code" href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">elements</a>.at(i).getSymmetryFunction(j).getLineNumber());</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            }</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    }</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">return</span> prune;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;}</div><div class="ttc" id="a00832_html_a76d3694d566d2052c298325a18ee865c"><div class="ttname"><a href="a00832.html#a76d3694d566d2052c298325a18ee865c">nnp::Mode::numElements</a></div><div class="ttdeci">std::size_t numElements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00469">Mode.h:469</a></div></div>
<div class="ttc" id="a00832_html_a6f777011d3e3fbe644616e7763f9dd11"><div class="ttname"><a href="a00832.html#a6f777011d3e3fbe644616e7763f9dd11">nnp::Mode::elements</a></div><div class="ttdeci">std::vector&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00480">Mode.h:480</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_ae922768942eef6c6e9000700595bc00d_icgraph.png" border="0" usemap="#a00832_ae922768942eef6c6e9000700595bc00d_icgraph" alt=""/></div>
<map name="a00832_ae922768942eef6c6e9000700595bc00d_icgraph" id="a00832_ae922768942eef6c6e9000700595bc00d_icgraph">
<area shape="rect" id="node2" href="a00032.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="256,13,311,39"/>
</map>
</div>

</div>
</div>
<a id="a6ac0b02c0a91917b17cd6e2fb96afb18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ac0b02c0a91917b17cd6e2fb96afb18">&#9670;&nbsp;</a></span>writePrunedSettingsFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::writePrunedSettingsFile </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::size_t &gt;&#160;</td>
          <td class="paramname"><em>prune</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>fileName</em> = <code>&quot;output.nn&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy settings file but comment out lines provided. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">prune</td><td>List of line numbers to comment out. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileName</td><td>Output file name. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01318">1318</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00852.html#abe55e2b7294788622da5e888799732ff">nnp::Settings::getSettingsLines()</a>, and <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00032.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;{</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    ofstream file(fileName.c_str());</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    vector&lt;string&gt; settingsLines = <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#abe55e2b7294788622da5e888799732ff">getSettingsLines</a>();</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; settingsLines.size(); ++i)</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">if</span> (find(prune.begin(), prune.end(), i) != prune.end())</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        {</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            file &lt;&lt; <span class="stringliteral">&quot;# &quot;</span>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        }</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        file &lt;&lt; settingsLines.at(i) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    }</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    file.close();</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;}</div><div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
<div class="ttc" id="a00852_html_abe55e2b7294788622da5e888799732ff"><div class="ttname"><a href="a00852.html#abe55e2b7294788622da5e888799732ff">nnp::Settings::getSettingsLines</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getSettingsLines() const</div><div class="ttdoc">Get complete settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00147">Settings.cpp:147</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_cgraph.png" border="0" usemap="#a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_cgraph" alt=""/></div>
<map name="a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_cgraph" id="a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_cgraph">
<area shape="rect" id="node2" href="a00852.html#abe55e2b7294788622da5e888799732ff" title="Get complete settings file. " alt="" coords="304,5,493,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_icgraph.png" border="0" usemap="#a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_icgraph" alt=""/></div>
<map name="a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_icgraph" id="a00832_a6ac0b02c0a91917b17cd6e2fb96afb18_icgraph">
<area shape="rect" id="node2" href="a00032.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="304,5,359,32"/>
</map>
</div>

</div>
</div>
<a id="af2d61853475185baae3fa3a7d358557a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2d61853475185baae3fa3a7d358557a">&#9670;&nbsp;</a></span>writeSettingsFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Mode::writeSettingsFile </td>
          <td>(</td>
          <td class="paramtype">std::ofstream *const &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write complete settings file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">file</td><td><a class="el" href="a00852.html" title="Reads and analyzes settings file and stores parameters. ">Settings</a> file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00080_source.html#l01335">1335</a> of file <a class="el" href="a00080_source.html">Mode.cpp</a>.</p>

<p class="reference">References <a class="el" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>, and <a class="el" href="a00852.html#ade34327a049d86489676aaa55d32b854">nnp::Settings::writeSettingsFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00026.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;{</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <a class="code" href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">settings</a>.<a class="code" href="a00852.html#ade34327a049d86489676aaa55d32b854">writeSettingsFile</a>(file);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;}</div><div class="ttc" id="a00852_html_ade34327a049d86489676aaa55d32b854"><div class="ttname"><a href="a00852.html#ade34327a049d86489676aaa55d32b854">nnp::Settings::writeSettingsFile</a></div><div class="ttdeci">void writeSettingsFile(std::ofstream *const &amp;file) const</div><div class="ttdoc">Write complete settings file. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00177">Settings.cpp:177</a></div></div>
<div class="ttc" id="a00832_html_acaf7de3d7a75f960af6a66c3e9ab6acb"><div class="ttname"><a href="a00832.html#acaf7de3d7a75f960af6a66c3e9ab6acb">nnp::Mode::settings</a></div><div class="ttdeci">Settings settings</div><div class="ttdef"><b>Definition:</b> <a href="a00083_source.html#l00477">Mode.h:477</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_af2d61853475185baae3fa3a7d358557a_cgraph.png" border="0" usemap="#a00832_af2d61853475185baae3fa3a7d358557a_cgraph" alt=""/></div>
<map name="a00832_af2d61853475185baae3fa3a7d358557a_cgraph" id="a00832_af2d61853475185baae3fa3a7d358557a_cgraph">
<area shape="rect" id="node2" href="a00852.html#ade34327a049d86489676aaa55d32b854" title="Write complete settings file. " alt="" coords="259,5,481,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="a00832_af2d61853475185baae3fa3a7d358557a_icgraph.png" border="0" usemap="#a00832_af2d61853475185baae3fa3a7d358557a_icgraph" alt=""/></div>
<map name="a00832_af2d61853475185baae3fa3a7d358557a_icgraph" id="a00832_af2d61853475185baae3fa3a7d358557a_icgraph">
<area shape="rect" id="node2" href="a00026.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="259,5,313,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a12a8249ac3aab222922c42781c344779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12a8249ac3aab222922c42781c344779">&#9670;&nbsp;</a></span>elementMap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00824.html">ElementMap</a> nnp::Mode::elementMap</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global element map, populated by <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5" title="Set up the element map. ">setupElementMap()</a>. </p>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00462">462</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00932.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00020.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00848.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, <a class="el" href="a00944.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap()</a>, <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements()</a>, <a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork()</a>, <a class="el" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00932.html#a7f59129925f9a0fa7fe2db87dd60e1df">nnp::Dataset::writeAtomicEnvironmentFile()</a>, <a class="el" href="a00932.html#a7fdf6f361d7e65d31fe1002d6a9aacfd">nnp::Dataset::writeNeighborLists()</a>, <a class="el" href="a00932.html#aa12823183030d6cff2e059e860d15671">nnp::Dataset::writeSymmetryFunctionFile()</a>, <a class="el" href="a00932.html#abb4a2760ca7eb9c03e2ea37474a431c0">nnp::Dataset::writeSymmetryFunctionHistograms()</a>, and <a class="el" href="a00944.html#ad50f7e1c48f3f558653f831aae83a38c">nnp::Training::writeUpdaterStatus()</a>.</p>

</div>
</div>
<a id="aae5d8b1186dde3ffbf2545fca1d08923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae5d8b1186dde3ffbf2545fca1d08923">&#9670;&nbsp;</a></span>log</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00828.html">Log</a> nnp::Mode::log</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global log file. </p>

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00464">464</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00944.html#ac0de14f9b249aa70a7648c7c3c1cc783">nnp::Training::calculateNeighborLists()</a>, <a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions()</a>, <a class="el" href="a00944.html#a3d0cecb1a3e0197fdb693186d39c8796">nnp::Training::checkSelectionMode()</a>, <a class="el" href="a00932.html#a1a204e7dc1bdf91a515b18a0ef06704c">nnp::Dataset::collectSymmetryFunctionStatistics()</a>, <a class="el" href="a00932.html#a1ecb649e652e2c6acb83102340f48afd">nnp::Dataset::distributeStructures()</a>, <a class="el" href="a00956.html#a89e848a7a2f8d236cd1fe84532d9af45">LAMMPS_NS::PairNNP::init_style()</a>, <a class="el" href="a00928.html#a321c263a6b62533fb3ec85d3c6af80ec">nnp::InterfaceLammps::initialize()</a>, <a class="el" href="a00832.html#a19a68b9d8750ddc0b440b1828ecf9f17">initialize()</a>, <a class="el" href="a00944.html#ab3025fc3780b67e91e063fd490640043">nnp::Training::initializeWeights()</a>, <a class="el" href="a00944.html#ab802ff670986203dab60c22f04b07f59">nnp::Training::initializeWeightsMemory()</a>, <a class="el" href="a00832.html#ae8ca16789e7794309cf9931e58eb882b">loadSettingsFile()</a>, <a class="el" href="a00944.html#a84e2af12e3007a2f9955630cd27a0167">nnp::Training::loop()</a>, <a class="el" href="a00011.html#a0ddf1224851353fc92bfbff6f499fa97">main()</a>, <a class="el" href="a00944.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff()</a>, <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap()</a>, <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements()</a>, <a class="el" href="a00932.html#afd2470ddbc354289e185a3bd119684a9">nnp::Dataset::setupMPI()</a>, <a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork()</a>, <a class="el" href="a00832.html#a091fea0011ed8260c93db7c38c3d1e82">setupNeuralNetworkWeights()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00932.html#abd84c06c5a83789ebe6a3ef8075af632">nnp::Dataset::setupRandomNumberGenerator()</a>, <a class="el" href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00832.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling()</a>, <a class="el" href="a00832.html#a9a672cac54995b226d8e69bb8be2669d">setupSymmetryFunctionScalingNone()</a>, <a class="el" href="a00832.html#ae4b348e9b5e2ef89cb30c760bdb55153">setupSymmetryFunctionStatistics()</a>, <a class="el" href="a00944.html#a2b2b016d87bcea95f460b8a2ae93b451">nnp::Training::setupTraining()</a>, <a class="el" href="a00932.html#a72dd2973c5732479df5d76389fd5466f">nnp::Dataset::sortNeighborLists()</a>, <a class="el" href="a00932.html#a7f59129925f9a0fa7fe2db87dd60e1df">nnp::Dataset::writeAtomicEnvironmentFile()</a>, <a class="el" href="a00928.html#a7f6455e00e75a9f50289fb46cedcf395">nnp::InterfaceLammps::writeExtrapolationWarnings()</a>, <a class="el" href="a00932.html#afbdec01079adc087d702d5e7fddf2494">nnp::Dataset::writeNeighborHistogram()</a>, <a class="el" href="a00932.html#a7fdf6f361d7e65d31fe1002d6a9aacfd">nnp::Dataset::writeNeighborLists()</a>, <a class="el" href="a00944.html#af4cbb8263eeb79634e06fc62dc4b359d">nnp::Training::writeSetsToFiles()</a>, <a class="el" href="a00932.html#aa12823183030d6cff2e059e860d15671">nnp::Dataset::writeSymmetryFunctionFile()</a>, <a class="el" href="a00932.html#abb4a2760ca7eb9c03e2ea37474a431c0">nnp::Dataset::writeSymmetryFunctionHistograms()</a>, and <a class="el" href="a00932.html#a1623c2ddd9e673d12586e067ae536cc8">nnp::Dataset::writeSymmetryFunctionScaling()</a>.</p>

</div>
</div>
<a id="a043ac1c36d5edc38a6c72f4366823c69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a043ac1c36d5edc38a6c72f4366823c69">&#9670;&nbsp;</a></span>normalize</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Mode::normalize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00467">467</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a61bd2c84ec25020a021a1f1038c7d9fe">nnp::InterfaceLammps::addNeighbor()</a>, <a class="el" href="a00944.html#aef9ff868c2fd3bffde04b110cb8181f8">nnp::Training::calculateError()</a>, <a class="el" href="a00944.html#ac0de14f9b249aa70a7648c7c3c1cc783">nnp::Training::calculateNeighborLists()</a>, <a class="el" href="a00928.html#a680dca82d8c1670ac2effe7ba7df60fc">nnp::InterfaceLammps::getAtomicEnergy()</a>, <a class="el" href="a00928.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="a00928.html#ae6baf0f4691b0eb4a57feaaa6f3f10bb">nnp::InterfaceLammps::getMaxCutoffRadius()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00928.html#a0837984fb5d6fe14d298bb2c0b7d01f2">nnp::InterfaceLammps::process()</a>, <a class="el" href="a00848.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00832.html#a7c500a49ebbd16752c9dbe988f56f451">useNormalization()</a>, <a class="el" href="a00944.html#ae4ccff5ae694d46c03cae84aa7ae696d">nnp::Training::writeLearningCurve()</a>, and <a class="el" href="a00932.html#aa12823183030d6cff2e059e860d15671">nnp::Dataset::writeSymmetryFunctionFile()</a>.</p>

</div>
</div>
<a id="a03ee0e33408435b18a79a253e967856a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03ee0e33408435b18a79a253e967856a">&#9670;&nbsp;</a></span>checkExtrapolationWarnings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool nnp::Mode::checkExtrapolationWarnings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00468">468</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions()</a>, and <a class="el" href="a00832.html#ae4b348e9b5e2ef89cb30c760bdb55153">setupSymmetryFunctionStatistics()</a>.</p>

</div>
</div>
<a id="a76d3694d566d2052c298325a18ee865c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76d3694d566d2052c298325a18ee865c">&#9670;&nbsp;</a></span>numElements</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t nnp::Mode::numElements</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00469">469</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a17ba3ecbce972ff28d7a17bdade38674">addEnergyOffset()</a>, <a class="el" href="a00944.html#ae22bf5b246022c4f52f45bcc98d7c4be">nnp::Training::calculateWeightDerivatives()</a>, <a class="el" href="a00832.html#af05a24414c9b595a8ccb95b05b5030de">getEnergyOffset()</a>, <a class="el" href="a00832.html#ab86800b032be86f1321d3f6683c75b01">getEnergyWithOffset()</a>, <a class="el" href="a00832.html#a2dbf87eaa9cc33fa740e03608acdf156">getNumElements()</a>, <a class="el" href="a00944.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">nnp::Training::getWeights()</a>, <a class="el" href="a00944.html#ab3025fc3780b67e91e063fd490640043">nnp::Training::initializeWeights()</a>, <a class="el" href="a00944.html#ab802ff670986203dab60c22f04b07f59">nnp::Training::initializeWeightsMemory()</a>, <a class="el" href="a00832.html#ae922768942eef6c6e9000700595bc00d">pruneSymmetryFunctionsSensitivity()</a>, <a class="el" href="a00832.html#aa8ddf0701dbcd60868955ca556892bc5">removeEnergyOffset()</a>, <a class="el" href="a00944.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="a00928.html#a28d41810dc652d5cdf1db90035e8d495">nnp::InterfaceLammps::setLocalAtoms()</a>, <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements()</a>, <a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork()</a>, <a class="el" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00944.html#a82549ec0800f63ffaf830b46f865cdbb">nnp::Training::setWeights()</a>, <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>, <a class="el" href="a00932.html#a7f59129925f9a0fa7fe2db87dd60e1df">nnp::Dataset::writeAtomicEnvironmentFile()</a>, <a class="el" href="a00932.html#a7fdf6f361d7e65d31fe1002d6a9aacfd">nnp::Dataset::writeNeighborLists()</a>, <a class="el" href="a00944.html#acb8219474263990f1f8a28e45cdf2302">nnp::Training::writeNeuronStatistics()</a>, and <a class="el" href="a00944.html#a866ceb6e9c34386758cf651148c2bd9e">nnp::Training::writeWeights()</a>.</p>

</div>
</div>
<a id="abbb183f90ace9311391b9847580009ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbb183f90ace9311391b9847580009ba">&#9670;&nbsp;</a></span>minNeighbors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::size_t&gt; nnp::Mode::minNeighbors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00470">470</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, and <a class="el" href="a00932.html#afbdec01079adc087d702d5e7fddf2494">nnp::Dataset::writeNeighborHistogram()</a>.</p>

</div>
</div>
<a id="a16cf1320e7b8e3ff52802dff5b114fae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16cf1320e7b8e3ff52802dff5b114fae">&#9670;&nbsp;</a></span>minCutoffRadius</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; nnp::Mode::minCutoffRadius</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00471">471</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions()</a>, and <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>.</p>

</div>
</div>
<a id="a38f8bc8db576ad1762dd306b4d225383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38f8bc8db576ad1762dd306b4d225383">&#9670;&nbsp;</a></span>maxCutoffRadius</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::maxCutoffRadius</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00472">472</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#ac0de14f9b249aa70a7648c7c3c1cc783">nnp::Training::calculateNeighborLists()</a>, <a class="el" href="a00928.html#ae6baf0f4691b0eb4a57feaaa6f3f10bb">nnp::InterfaceLammps::getMaxCutoffRadius()</a>, <a class="el" href="a00832.html#a73f1fcdcbb76828f6aca2d322bfeb2a9">getMaxCutoffRadius()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, and <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>.</p>

</div>
</div>
<a id="aded25017ec58efa0cc8d55bb9fb7dd25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aded25017ec58efa0cc8d55bb9fb7dd25">&#9670;&nbsp;</a></span>cutoffAlpha</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::cutoffAlpha</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00473">473</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff()</a>, and <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>.</p>

</div>
</div>
<a id="a5c6554727f0af7501fe82dfe136b3865"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c6554727f0af7501fe82dfe136b3865">&#9670;&nbsp;</a></span>meanEnergy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::meanEnergy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00474">474</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a8353f189a07813687e6cda9dff5ef55a">convertToNormalizedUnits()</a>, <a class="el" href="a00832.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">convertToPhysicalUnits()</a>, <a class="el" href="a00832.html#ab6e30b5a1e840dc2a98516a0f276a3c4">getMeanEnergy()</a>, <a class="el" href="a00832.html#af5d51e9328414aea8106d85bde5a1729">normalizedEnergy()</a>, <a class="el" href="a00832.html#a02d558483ab82d340ee587febcfddd8f">physicalEnergy()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00848.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00932.html#affe9632070e632592b6f3d78e4529d3a">nnp::Dataset::toNormalizedUnits()</a>, and <a class="el" href="a00932.html#aa99d82945d6250000d26f53173d855c3">nnp::Dataset::toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="a09461989d84484833b10c96e6871f87e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09461989d84484833b10c96e6871f87e">&#9670;&nbsp;</a></span>convEnergy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::convEnergy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00475">475</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a8353f189a07813687e6cda9dff5ef55a">convertToNormalizedUnits()</a>, <a class="el" href="a00832.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">convertToPhysicalUnits()</a>, <a class="el" href="a00832.html#a8da7486dc693fafe772c12a440a623d8">getConvEnergy()</a>, <a class="el" href="a00928.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="a00832.html#ad914604c902d947d44c32b4f760e1da3">normalizedEnergy()</a>, <a class="el" href="a00832.html#a42377e19341fd2666856b9177b6588dd">normalizedForce()</a>, <a class="el" href="a00832.html#a9fcf4fe91e191c78e4bc2a999225b8b1">physicalEnergy()</a>, <a class="el" href="a00832.html#a9cfdc02d7860f91735b789ee11532982">physicalForce()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00848.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00932.html#affe9632070e632592b6f3d78e4529d3a">nnp::Dataset::toNormalizedUnits()</a>, and <a class="el" href="a00932.html#aa99d82945d6250000d26f53173d855c3">nnp::Dataset::toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="a1d6eccfa0f21d64823f74cc75c89473f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d6eccfa0f21d64823f74cc75c89473f">&#9670;&nbsp;</a></span>convLength</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double nnp::Mode::convLength</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00476">476</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00928.html#a61bd2c84ec25020a021a1f1038c7d9fe">nnp::InterfaceLammps::addNeighbor()</a>, <a class="el" href="a00944.html#ac0de14f9b249aa70a7648c7c3c1cc783">nnp::Training::calculateNeighborLists()</a>, <a class="el" href="a00832.html#a8353f189a07813687e6cda9dff5ef55a">convertToNormalizedUnits()</a>, <a class="el" href="a00832.html#abbe07bd6a67b5df0b6dd5f5ce00fb1f6">convertToPhysicalUnits()</a>, <a class="el" href="a00832.html#a373073bd1acb1c9ac293369bb892bdc4">getConvLength()</a>, <a class="el" href="a00928.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="a00928.html#ae6baf0f4691b0eb4a57feaaa6f3f10bb">nnp::InterfaceLammps::getMaxCutoffRadius()</a>, <a class="el" href="a00832.html#a42377e19341fd2666856b9177b6588dd">normalizedForce()</a>, <a class="el" href="a00832.html#a9cfdc02d7860f91735b789ee11532982">physicalForce()</a>, <a class="el" href="a00848.html#af86efaec86e8002a84368c7282704858">nnp::Prediction::predict()</a>, <a class="el" href="a00848.html#a217f052c181f847506b5d2382c02246c">nnp::Prediction::readStructureFromFile()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00932.html#affe9632070e632592b6f3d78e4529d3a">nnp::Dataset::toNormalizedUnits()</a>, and <a class="el" href="a00932.html#aa99d82945d6250000d26f53173d855c3">nnp::Dataset::toPhysicalUnits()</a>.</p>

</div>
</div>
<a id="acaf7de3d7a75f960af6a66c3e9ab6acb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf7de3d7a75f960af6a66c3e9ab6acb">&#9670;&nbsp;</a></span>settings</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00852.html">Settings</a> nnp::Mode::settings</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00477">477</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00944.html#ab3025fc3780b67e91e063fd490640043">nnp::Training::initializeWeights()</a>, <a class="el" href="a00832.html#ae8ca16789e7794309cf9931e58eb882b">loadSettingsFile()</a>, <a class="el" href="a00944.html#a451092eefd3f1021b2edd7729b74505c">nnp::Training::selectSets()</a>, <a class="el" href="a00832.html#a9b7eeb5daa541cc8e3ab36a9bcf69ab8">settingsGetValue()</a>, <a class="el" href="a00832.html#aa9606884fa146912a6b4ab6d26df9275">settingsKeywordExists()</a>, <a class="el" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff()</a>, <a class="el" href="a00832.html#a259303c95ae2f64f2b192de1b2df51f5">setupElementMap()</a>, <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements()</a>, <a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork()</a>, <a class="el" href="a00832.html#aa837413e8d998f165f0b8527de636cb5">setupNormalization()</a>, <a class="el" href="a00932.html#abd84c06c5a83789ebe6a3ef8075af632">nnp::Dataset::setupRandomNumberGenerator()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00832.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling()</a>, <a class="el" href="a00944.html#a2b2b016d87bcea95f460b8a2ae93b451">nnp::Training::setupTraining()</a>, <a class="el" href="a00832.html#a6ac0b02c0a91917b17cd6e2fb96afb18">writePrunedSettingsFile()</a>, and <a class="el" href="a00832.html#af2d61853475185baae3fa3a7d358557a">writeSettingsFile()</a>.</p>

</div>
</div>
<a id="ab7ff5331297adab87a18dd7b0fac4e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7ff5331297adab87a18dd7b0fac4e0b">&#9670;&nbsp;</a></span>scalingType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00868.html#aeccad03c72e37304d5aa86a3f2fbb410">SymmetryFunction::ScalingType</a> nnp::Mode::scalingType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00478">478</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling()</a>.</p>

</div>
</div>
<a id="af7e76062a64f8acdcf384bc487f8a4fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7e76062a64f8acdcf384bc487f8a4fb">&#9670;&nbsp;</a></span>cutoffType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00816.html#a0a5fd8220ae66e1442b6692885316fa8">CutoffFunction::CutoffType</a> nnp::Mode::cutoffType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00479">479</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#ae72c03926dc7ea9b8f43770fb5861ccf">setupCutoff()</a>, and <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>.</p>

</div>
</div>
<a id="a6f777011d3e3fbe644616e7763f9dd11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f777011d3e3fbe644616e7763f9dd11">&#9670;&nbsp;</a></span>elements</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="a00820.html">Element</a>&gt; nnp::Mode::elements</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00083_source.html#l00480">480</a> of file <a class="el" href="a00083_source.html">Mode.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00832.html#a17ba3ecbce972ff28d7a17bdade38674">addEnergyOffset()</a>, <a class="el" href="a00944.html#a74b44b3fdc51d3a16c6d0f8b13ec2f1f">nnp::Training::addTrainingLogEntry()</a>, <a class="el" href="a00832.html#a93dc4a306a3caf233268dad71efd565f">calculateAtomicNeuralNetworks()</a>, <a class="el" href="a00832.html#ae2fddd6f29bb63ef67b9619544d81ab1">calculateForces()</a>, <a class="el" href="a00832.html#a8aec6fb4708b93b93a9cfa0e8045f955">calculateSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#add11e3c30eb86aba38d8239d1e5d8736">calculateSymmetryFunctions()</a>, <a class="el" href="a00944.html#ae22bf5b246022c4f52f45bcc98d7c4be">nnp::Training::calculateWeightDerivatives()</a>, <a class="el" href="a00928.html#ad88b019d3d4f89dd1a8c118dcaf4f887">nnp::InterfaceLammps::clearExtrapolationWarnings()</a>, <a class="el" href="a00932.html#a1a204e7dc1bdf91a515b18a0ef06704c">nnp::Dataset::collectSymmetryFunctionStatistics()</a>, <a class="el" href="a00928.html#a0ef9d95aeeb71882068bda355ebbd8cf">nnp::InterfaceLammps::extractEWBuffer()</a>, <a class="el" href="a00928.html#a655e577553b61b9bbe3bbe2bb9d9f785">nnp::InterfaceLammps::fillEWBuffer()</a>, <a class="el" href="a00832.html#af05a24414c9b595a8ccb95b05b5030de">getEnergyOffset()</a>, <a class="el" href="a00832.html#ab86800b032be86f1321d3f6683c75b01">getEnergyWithOffset()</a>, <a class="el" href="a00928.html#a05076e9e514d0d0f002e27b235f2f01f">nnp::InterfaceLammps::getEWBufferSize()</a>, <a class="el" href="a00928.html#a69139b2e95478a30532b1171c284ce4c">nnp::InterfaceLammps::getForces()</a>, <a class="el" href="a00832.html#aa73bc18bc5e85e53303fea2132c4e78c">getNumExtrapolationWarnings()</a>, <a class="el" href="a00832.html#aa4fc3399c130a3778a20a625fa2ee34c">getNumSymmetryFunctions()</a>, <a class="el" href="a00944.html#a9e7a7553f60ebf30dbdfb8efc64b32c0">nnp::Training::getWeights()</a>, <a class="el" href="a00944.html#ab3025fc3780b67e91e063fd490640043">nnp::Training::initializeWeights()</a>, <a class="el" href="a00944.html#ab802ff670986203dab60c22f04b07f59">nnp::Training::initializeWeightsMemory()</a>, <a class="el" href="a00832.html#a5b8ceb8be242844ec8b72987e0bf0c3e">pruneSymmetryFunctionsRange()</a>, <a class="el" href="a00832.html#ae922768942eef6c6e9000700595bc00d">pruneSymmetryFunctionsSensitivity()</a>, <a class="el" href="a00832.html#aa8ddf0701dbcd60868955ca556892bc5">removeEnergyOffset()</a>, <a class="el" href="a00832.html#ab71571b8b4742c474c645fa50ffa667e">resetExtrapolationWarnings()</a>, <a class="el" href="a00944.html#a6eb04b2ac7e9dbea0fd4e21d36d0ce38">nnp::Training::resetNeuronStatistics()</a>, <a class="el" href="a00832.html#afc4e43a8f905900eb4ea153d529053ec">setupElements()</a>, <a class="el" href="a00832.html#a3488a7fb2b0ccf17a9b2af514590f57c">setupNeuralNetwork()</a>, <a class="el" href="a00832.html#a091fea0011ed8260c93db7c38c3d1e82">setupNeuralNetworkWeights()</a>, <a class="el" href="a00832.html#a6f0184f87845a572cf4c3db0958a97d9">setupSymmetryFunctionGroups()</a>, <a class="el" href="a00832.html#af1d1548ef2d6a9bbfdc519b76b904700">setupSymmetryFunctionMemory()</a>, <a class="el" href="a00832.html#ad0080b25ea49cdd6ce085162751a379b">setupSymmetryFunctions()</a>, <a class="el" href="a00832.html#aa26222b7b9dc3fd141f6e775690b5d2b">setupSymmetryFunctionScaling()</a>, <a class="el" href="a00832.html#a9a672cac54995b226d8e69bb8be2669d">setupSymmetryFunctionScalingNone()</a>, <a class="el" href="a00832.html#ae4b348e9b5e2ef89cb30c760bdb55153">setupSymmetryFunctionStatistics()</a>, <a class="el" href="a00944.html#a2b2b016d87bcea95f460b8a2ae93b451">nnp::Training::setupTraining()</a>, <a class="el" href="a00944.html#a82549ec0800f63ffaf830b46f865cdbb">nnp::Training::setWeights()</a>, <a class="el" href="a00944.html#a146b6a09592858950a3cbb666c4a59fa">nnp::Training::update()</a>, <a class="el" href="a00928.html#a7f6455e00e75a9f50289fb46cedcf395">nnp::InterfaceLammps::writeExtrapolationWarnings()</a>, <a class="el" href="a00944.html#acb8219474263990f1f8a28e45cdf2302">nnp::Training::writeNeuronStatistics()</a>, <a class="el" href="a00932.html#abb4a2760ca7eb9c03e2ea37474a431c0">nnp::Dataset::writeSymmetryFunctionHistograms()</a>, <a class="el" href="a00932.html#a1623c2ddd9e673d12586e067ae536cc8">nnp::Dataset::writeSymmetryFunctionScaling()</a>, and <a class="el" href="a00944.html#a866ceb6e9c34386758cf651148c2bd9e">nnp::Training::writeWeights()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/travis/build/CompPhysVienna/n2p2/src/libnnp/<a class="el" href="a00083_source.html">Mode.h</a></li>
<li>/home/travis/build/CompPhysVienna/n2p2/src/libnnp/<a class="el" href="a00080_source.html">Mode.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="a00258.html">nnp</a></li><li class="navelem"><a class="el" href="a00832.html">Mode</a></li>
    <li class="footer">Generated on Mon Sep 7 2020 14:21:41 for n2p2 - A neural network potential package by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
