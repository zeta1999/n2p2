

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>nnp-prune &mdash; n2p2 - A neural network potential package 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="nnp-select" href="nnp-select.html" />
    <link rel="prev" title="nnp-predict" href="nnp-predict.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> n2p2 - A neural network potential package
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Topics/build.html">Build instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/descriptors.html">Atomic environment descriptors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/keywords.html">NNP configuration: keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/cfg_file.html">Configuration file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/if_lammps.html">LAMMPS NNP interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/pair_nnp.html">LAMMPS NNP pair style</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/training.html">NNP training procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Topics/units.html">Units</a></li>
</ul>
<p class="caption"><span class="caption-text">Tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="libnnp.html">The libnnp core library</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp-convert.html">nnp-convert</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp-norm.html">nnp-norm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp-predict.html">nnp-predict</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">nnp-prune</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prune-before-training">Prune before training</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prune-after-training">Prune after training</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nnp-select.html">nnp-select</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp-scaling.html">nnp-scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp-train.html">nnp-train</a></li>
</ul>
<p class="caption"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../About/authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../About/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../About/changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">n2p2 - A neural network potential package</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>nnp-prune</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Tools/nnp-prune.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nnp-prune">
<span id="id1"></span><h1>nnp-prune<a class="headerlink" href="#nnp-prune" title="Permalink to this headline">¶</a></h1>
<p>The tool <code class="docutils literal notranslate"><span class="pre">nnp-prune</span></code> is used to identify and remove symmetry functions that have
little effect on the training performance. There are two modes of operation:</p>
<div class="section" id="prune-before-training">
<h2>Prune before training<a class="headerlink" href="#prune-before-training" title="Permalink to this headline">¶</a></h2>
<p>Here, symmetry functions are discarded if their range (i.e. maximum - minimum
value over the entire data set) is below a provided threshold. The first step
is to calculate all symmetry functions with <a class="reference internal" href="nnp-scaling.html#nnp-scaling"><span class="std std-ref">nnp-scaling</span></a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun -np <span class="m">4</span> nnp-scaling <span class="m">500</span>
</pre></div>
</div>
<p>This will produce the file <code class="docutils literal notranslate"><span class="pre">scaling.data</span></code> where minimum, maximum, mean and sigma
values are stored. Then, in the same directory call for example</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nnp-prune range <span class="m">1</span>.0E-4
</pre></div>
</div>
<p>to eliminate all symmetry functions with range below <span class="math notranslate nohighlight">\(10^{-4}\)</span>. The resulting
settings file is called <code class="docutils literal notranslate"><span class="pre">output-prune-range.nn</span></code>. It is an exact copy of
<code class="docutils literal notranslate"><span class="pre">input.nn</span></code> but all lines with pruned symmetry functions are commented out. If
the result is reasonable, rename the file to <code class="docutils literal notranslate"><span class="pre">input.nn</span></code> and start over with the
training process (note: do not forget to calculate <code class="docutils literal notranslate"><span class="pre">scaling.data</span></code> again with
<a class="reference internal" href="nnp-scaling.html#nnp-scaling"><span class="std std-ref">nnp-scaling</span></a>).</p>
</div>
<div class="section" id="prune-after-training">
<h2>Prune after training<a class="headerlink" href="#prune-after-training" title="Permalink to this headline">¶</a></h2>
<p>After a neural network potential has been fitted with <code class="docutils literal notranslate"><span class="pre">nnp-train</span></code> it is possible
to identify unnecessary symmetry functions with a so-called sensitivity
analysis. Here, the derivatives of the output neuron with respect to the input
layer neurons, i.e. the symmetry functions, are averaged over the whole data.
This analysis is automatically performed by <code class="docutils literal notranslate"><span class="pre">nnp-dataset</span></code> and the results are
stored in files like <code class="docutils literal notranslate"><span class="pre">sensitivity.008.out</span></code> (for the oxygen neural network):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun -np <span class="m">4</span> nnp-dataset <span class="m">1</span>
</pre></div>
</div>
<p>With the sensitivity data ready, use the pruning tool to automatically remove
symmetry functions with a sensitivity below the threshold:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nnp-prune sensitivity <span class="m">0</span>.5 max
</pre></div>
</div>
<p>Here, the threshold is set to 0.5% where 100% is equal to the total sum of all
sensitivities. The resulting settings file is called
<code class="docutils literal notranslate"><span class="pre">output-prune-sensitivity.nn</span></code> and is again an exact copy of <code class="docutils literal notranslate"><span class="pre">input.nn</span></code>,
only with commented pruned symmetry function lines.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nnp-select.html" class="btn btn-neutral float-right" title="nnp-select" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="nnp-predict.html" class="btn btn-neutral float-left" title="nnp-predict" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019, Andreas Singraber

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>